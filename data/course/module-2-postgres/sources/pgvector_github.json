{
  "name": "pgvector GitHub",
  "url": "https://github.com/pgvector/pgvector",
  "pages": [
    {
      "url": "https://github.com/pgvector/pgvector",
      "title": "pgvector GitHub",
      "content_html": "<article class=\"markdown-body entry-content container-lg\" itemprop=\"text\"><div class=\"markdown-heading\" dir=\"auto\"><h1 class=\"heading-element\" dir=\"auto\" tabindex=\"-1\">pgvector</h1><a aria-label=\"Permalink: pgvector\" class=\"anchor\" href=\"https://github.com/pgvector/pgvector#pgvector\" id=\"user-content-pgvector\" target=\"_blank\"><svg aria-hidden=\"true\" class=\"octicon octicon-link\" height=\"16\" version=\"1.1\" viewbox=\"0 0 16 16\" width=\"16\"><path d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"></path></svg></a></div>\n<p dir=\"auto\">Open-source vector similarity search for Postgres</p>\n<p dir=\"auto\">Store your vectors with the rest of your data. Supports:</p>\n<ul dir=\"auto\">\n<li>exact and approximate nearest neighbor search</li>\n<li>single-precision, half-precision, binary, and sparse vectors</li>\n<li>L2 distance, inner product, cosine distance, L1 distance, Hamming distance, and Jaccard distance</li>\n<li>any <a href=\"https://github.com/pgvector/pgvector#languages\" target=\"_blank\">language</a> with a Postgres client</li>\n</ul>\n<p dir=\"auto\">Plus <a href=\"https://en.wikipedia.org/wiki/ACID\" rel=\"nofollow\" target=\"_blank\">ACID</a> compliance, point-in-time recovery, JOINs, and all of the other <a href=\"https://www.postgresql.org/about/\" rel=\"nofollow\" target=\"_blank\">great features</a> of Postgres</p>\n<p dir=\"auto\"><a href=\"https://github.com/pgvector/pgvector/actions\" target=\"_blank\"><img alt=\"Build Status\" src=\"https://github.com/pgvector/pgvector/actions/workflows/build.yml/badge.svg\" style=\"max-width: 100%;\"/></a></p>\n<div class=\"markdown-heading\" dir=\"auto\"><h2 class=\"heading-element\" dir=\"auto\" tabindex=\"-1\">Installation</h2><a aria-label=\"Permalink: Installation\" class=\"anchor\" href=\"https://github.com/pgvector/pgvector#installation\" id=\"user-content-installation\" target=\"_blank\"><svg aria-hidden=\"true\" class=\"octicon octicon-link\" height=\"16\" version=\"1.1\" viewbox=\"0 0 16 16\" width=\"16\"><path d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"></path></svg></a></div>\n<div class=\"markdown-heading\" dir=\"auto\"><h3 class=\"heading-element\" dir=\"auto\" tabindex=\"-1\">Linux and Mac</h3><a aria-label=\"Permalink: Linux and Mac\" class=\"anchor\" href=\"https://github.com/pgvector/pgvector#linux-and-mac\" id=\"user-content-linux-and-mac\" target=\"_blank\"><svg aria-hidden=\"true\" class=\"octicon octicon-link\" height=\"16\" version=\"1.1\" viewbox=\"0 0 16 16\" width=\"16\"><path d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"></path></svg></a></div>\n<p dir=\"auto\">Compile and install the extension (supports Postgres 13+)</p>\n<div class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"cd /tmp\ngit clone --branch v0.8.1 https://github.com/pgvector/pgvector.git\ncd pgvector\nmake\nmake install # may need sudo\" dir=\"auto\"><pre><span class=\"pl-c1\">cd</span> /tmp\ngit clone --branch v0.8.1 https://github.com/pgvector/pgvector.git\n<span class=\"pl-c1\">cd</span> pgvector\nmake\nmake install <span class=\"pl-c\"><span class=\"pl-c\">#</span> may need sudo</span></pre></div>\n<p dir=\"auto\">See the <a href=\"https://github.com/pgvector/pgvector#installation-notes---linux-and-mac\" target=\"_blank\">installation notes</a> if you run into issues</p>\n<p dir=\"auto\">You can also install it with <a href=\"https://github.com/pgvector/pgvector#docker\" target=\"_blank\">Docker</a>, <a href=\"https://github.com/pgvector/pgvector#homebrew\" target=\"_blank\">Homebrew</a>, <a href=\"https://github.com/pgvector/pgvector#pgxn\" target=\"_blank\">PGXN</a>, <a href=\"https://github.com/pgvector/pgvector#apt\" target=\"_blank\">APT</a>, <a href=\"https://github.com/pgvector/pgvector#yum\" target=\"_blank\">Yum</a>, <a href=\"https://github.com/pgvector/pgvector#pkg\" target=\"_blank\">pkg</a>, <a href=\"https://github.com/pgvector/pgvector#apk\" target=\"_blank\">APK</a>, or <a href=\"https://github.com/pgvector/pgvector#conda-forge\" target=\"_blank\">conda-forge</a>, and it comes preinstalled with <a href=\"https://github.com/pgvector/pgvector#postgresapp\" target=\"_blank\">Postgres.app</a> and many <a href=\"https://github.com/pgvector/pgvector#hosted-postgres\" target=\"_blank\">hosted providers</a>. There are also instructions for <a href=\"https://github.com/pgvector/setup-pgvector\" target=\"_blank\">GitHub Actions</a>.</p>\n<div class=\"markdown-heading\" dir=\"auto\"><h3 class=\"heading-element\" dir=\"auto\" tabindex=\"-1\">Windows</h3><a aria-label=\"Permalink: Windows\" class=\"anchor\" href=\"https://github.com/pgvector/pgvector#windows\" id=\"user-content-windows\" target=\"_blank\"><svg aria-hidden=\"true\" class=\"octicon octicon-link\" height=\"16\" version=\"1.1\" viewbox=\"0 0 16 16\" width=\"16\"><path d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"></path></svg></a></div>\n<p dir=\"auto\">Ensure <a href=\"https://learn.microsoft.com/en-us/cpp/build/building-on-the-command-line?view=msvc-170#download-and-install-the-tools\" rel=\"nofollow\" target=\"_blank\">C++ support in Visual Studio</a> is installed and run <code>x64 Native Tools Command Prompt for VS [version]</code> as administrator. Then use <code>nmake</code> to build:</p>\n<div class=\"highlight highlight-source-batchfile notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content='set \"PGROOT=C:\\Program Files\\PostgreSQL\\18\"\ncd %TEMP%\ngit clone --branch v0.8.1 https://github.com/pgvector/pgvector.git\ncd pgvector\nnmake /F Makefile.win\nnmake /F Makefile.win install' dir=\"auto\"><pre><span class=\"pl-k\">set</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span><span class=\"pl-smi\">PGROOT</span><span class=\"pl-k\">=</span>C:\\Program Files\\PostgreSQL\\18<span class=\"pl-pds\">\"</span></span>\n<span class=\"pl-k\">cd</span> <span class=\"pl-smi\">%TEMP%</span>\ngit clone --branch v0.8.1 https://github.com/pgvector/pgvector.git\n<span class=\"pl-k\">cd</span> pgvector\nnmake /F Makefile.win\nnmake /F Makefile.win install</pre></div>\n<p dir=\"auto\">See the <a href=\"https://github.com/pgvector/pgvector#installation-notes---windows\" target=\"_blank\">installation notes</a> if you run into issues</p>\n<p dir=\"auto\">You can also install it with <a href=\"https://github.com/pgvector/pgvector#docker\" target=\"_blank\">Docker</a> or <a href=\"https://github.com/pgvector/pgvector#conda-forge\" target=\"_blank\">conda-forge</a>.</p>\n<div class=\"markdown-heading\" dir=\"auto\"><h2 class=\"heading-element\" dir=\"auto\" tabindex=\"-1\">Getting Started</h2><a aria-label=\"Permalink: Getting Started\" class=\"anchor\" href=\"https://github.com/pgvector/pgvector#getting-started\" id=\"user-content-getting-started\" target=\"_blank\"><svg aria-hidden=\"true\" class=\"octicon octicon-link\" height=\"16\" version=\"1.1\" viewbox=\"0 0 16 16\" width=\"16\"><path d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"></path></svg></a></div>\n<p dir=\"auto\">Enable the extension (do this once in each database where you want to use it)</p>\n<div class=\"highlight highlight-source-tsql notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"CREATE EXTENSION vector;\" dir=\"auto\"><pre><span class=\"pl-k\">CREATE</span> EXTENSION vector;</pre></div>\n<p dir=\"auto\">Create a vector column with 3 dimensions</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"CREATE TABLE items (id bigserial PRIMARY KEY, embedding vector(3));\" dir=\"auto\"><pre><span class=\"pl-k\">CREATE</span> <span class=\"pl-k\">TABLE</span> <span class=\"pl-en\">items</span> (id <span class=\"pl-k\">bigserial</span> <span class=\"pl-k\">PRIMARY KEY</span>, embedding vector(<span class=\"pl-c1\">3</span>));</pre></div>\n<p dir=\"auto\">Insert vectors</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"INSERT INTO items (embedding) VALUES ('[1,2,3]'), ('[4,5,6]');\" dir=\"auto\"><pre><span class=\"pl-k\">INSERT INTO</span> items (embedding) <span class=\"pl-k\">VALUES</span> (<span class=\"pl-s\"><span class=\"pl-pds\">'</span>[1,2,3]<span class=\"pl-pds\">'</span></span>), (<span class=\"pl-s\"><span class=\"pl-pds\">'</span>[4,5,6]<span class=\"pl-pds\">'</span></span>);</pre></div>\n<p dir=\"auto\">Get the nearest neighbors by L2 distance</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"SELECT * FROM items ORDER BY embedding &lt;-&gt; '[3,1,2]' LIMIT 5;\" dir=\"auto\"><pre><span class=\"pl-k\">SELECT</span> <span class=\"pl-k\">*</span> <span class=\"pl-k\">FROM</span> items <span class=\"pl-k\">ORDER BY</span> embedding <span class=\"pl-k\">&lt;</span><span class=\"pl-k\">-</span><span class=\"pl-k\">&gt;</span> <span class=\"pl-s\"><span class=\"pl-pds\">'</span>[3,1,2]<span class=\"pl-pds\">'</span></span> <span class=\"pl-k\">LIMIT</span> <span class=\"pl-c1\">5</span>;</pre></div>\n<p dir=\"auto\">Also supports inner product (<code>&lt;#&gt;</code>), cosine distance (<code>&lt;=&gt;</code>), and L1 distance (<code>&lt;+&gt;</code>)</p>\n<p dir=\"auto\">Note: <code>&lt;#&gt;</code> returns the negative inner product since Postgres only supports <code>ASC</code> order index scans on operators</p>\n<div class=\"markdown-heading\" dir=\"auto\"><h2 class=\"heading-element\" dir=\"auto\" tabindex=\"-1\">Storing</h2><a aria-label=\"Permalink: Storing\" class=\"anchor\" href=\"https://github.com/pgvector/pgvector#storing\" id=\"user-content-storing\" target=\"_blank\"><svg aria-hidden=\"true\" class=\"octicon octicon-link\" height=\"16\" version=\"1.1\" viewbox=\"0 0 16 16\" width=\"16\"><path d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"></path></svg></a></div>\n<p dir=\"auto\">Create a new table with a vector column</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"CREATE TABLE items (id bigserial PRIMARY KEY, embedding vector(3));\" dir=\"auto\"><pre><span class=\"pl-k\">CREATE</span> <span class=\"pl-k\">TABLE</span> <span class=\"pl-en\">items</span> (id <span class=\"pl-k\">bigserial</span> <span class=\"pl-k\">PRIMARY KEY</span>, embedding vector(<span class=\"pl-c1\">3</span>));</pre></div>\n<p dir=\"auto\">Or add a vector column to an existing table</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"ALTER TABLE items ADD COLUMN embedding vector(3);\" dir=\"auto\"><pre><span class=\"pl-k\">ALTER</span> <span class=\"pl-k\">TABLE</span> items ADD COLUMN embedding vector(<span class=\"pl-c1\">3</span>);</pre></div>\n<p dir=\"auto\">Also supports <a href=\"https://github.com/pgvector/pgvector#half-precision-vectors\" target=\"_blank\">half-precision</a>, <a href=\"https://github.com/pgvector/pgvector#binary-vectors\" target=\"_blank\">binary</a>, and <a href=\"https://github.com/pgvector/pgvector#sparse-vectors\" target=\"_blank\">sparse</a> vectors</p>\n<p dir=\"auto\">Insert vectors</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"INSERT INTO items (embedding) VALUES ('[1,2,3]'), ('[4,5,6]');\" dir=\"auto\"><pre><span class=\"pl-k\">INSERT INTO</span> items (embedding) <span class=\"pl-k\">VALUES</span> (<span class=\"pl-s\"><span class=\"pl-pds\">'</span>[1,2,3]<span class=\"pl-pds\">'</span></span>), (<span class=\"pl-s\"><span class=\"pl-pds\">'</span>[4,5,6]<span class=\"pl-pds\">'</span></span>);</pre></div>\n<p dir=\"auto\">Or load vectors in bulk using <code>COPY</code> (<a href=\"https://github.com/pgvector/pgvector-python/blob/master/examples/loading/example.py\" target=\"_blank\">example</a>)</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"COPY items (embedding) FROM STDIN WITH (FORMAT BINARY);\" dir=\"auto\"><pre>COPY items (embedding) <span class=\"pl-k\">FROM</span> STDIN WITH (FORMAT BINARY);</pre></div>\n<p dir=\"auto\">Upsert vectors</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"INSERT INTO items (id, embedding) VALUES (1, '[1,2,3]'), (2, '[4,5,6]')\n    ON CONFLICT (id) DO UPDATE SET embedding = EXCLUDED.embedding;\" dir=\"auto\"><pre><span class=\"pl-k\">INSERT INTO</span> items (id, embedding) <span class=\"pl-k\">VALUES</span> (<span class=\"pl-c1\">1</span>, <span class=\"pl-s\"><span class=\"pl-pds\">'</span>[1,2,3]<span class=\"pl-pds\">'</span></span>), (<span class=\"pl-c1\">2</span>, <span class=\"pl-s\"><span class=\"pl-pds\">'</span>[4,5,6]<span class=\"pl-pds\">'</span></span>)\n    <span class=\"pl-k\">ON</span> CONFLICT (id) DO <span class=\"pl-k\">UPDATE</span> <span class=\"pl-k\">SET</span> embedding <span class=\"pl-k\">=</span> <span class=\"pl-c1\">EXCLUDED</span>.<span class=\"pl-c1\">embedding</span>;</pre></div>\n<p dir=\"auto\">Update vectors</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"UPDATE items SET embedding = '[1,2,3]' WHERE id = 1;\" dir=\"auto\"><pre><span class=\"pl-k\">UPDATE</span> items <span class=\"pl-k\">SET</span> embedding <span class=\"pl-k\">=</span> <span class=\"pl-s\"><span class=\"pl-pds\">'</span>[1,2,3]<span class=\"pl-pds\">'</span></span> <span class=\"pl-k\">WHERE</span> id <span class=\"pl-k\">=</span> <span class=\"pl-c1\">1</span>;</pre></div>\n<p dir=\"auto\">Delete vectors</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"DELETE FROM items WHERE id = 1;\" dir=\"auto\"><pre><span class=\"pl-k\">DELETE</span> <span class=\"pl-k\">FROM</span> items <span class=\"pl-k\">WHERE</span> id <span class=\"pl-k\">=</span> <span class=\"pl-c1\">1</span>;</pre></div>\n<div class=\"markdown-heading\" dir=\"auto\"><h2 class=\"heading-element\" dir=\"auto\" tabindex=\"-1\">Querying</h2><a aria-label=\"Permalink: Querying\" class=\"anchor\" href=\"https://github.com/pgvector/pgvector#querying\" id=\"user-content-querying\" target=\"_blank\"><svg aria-hidden=\"true\" class=\"octicon octicon-link\" height=\"16\" version=\"1.1\" viewbox=\"0 0 16 16\" width=\"16\"><path d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"></path></svg></a></div>\n<p dir=\"auto\">Get the nearest neighbors to a vector</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"SELECT * FROM items ORDER BY embedding &lt;-&gt; '[3,1,2]' LIMIT 5;\" dir=\"auto\"><pre><span class=\"pl-k\">SELECT</span> <span class=\"pl-k\">*</span> <span class=\"pl-k\">FROM</span> items <span class=\"pl-k\">ORDER BY</span> embedding <span class=\"pl-k\">&lt;</span><span class=\"pl-k\">-</span><span class=\"pl-k\">&gt;</span> <span class=\"pl-s\"><span class=\"pl-pds\">'</span>[3,1,2]<span class=\"pl-pds\">'</span></span> <span class=\"pl-k\">LIMIT</span> <span class=\"pl-c1\">5</span>;</pre></div>\n<p dir=\"auto\">Supported distance functions are:</p>\n<ul dir=\"auto\">\n<li><code>&lt;-&gt;</code> - L2 distance</li>\n<li><code>&lt;#&gt;</code> - (negative) inner product</li>\n<li><code>&lt;=&gt;</code> - cosine distance</li>\n<li><code>&lt;+&gt;</code> - L1 distance</li>\n<li><code>&lt;~&gt;</code> - Hamming distance (binary vectors)</li>\n<li><code>&lt;%&gt;</code> - Jaccard distance (binary vectors)</li>\n</ul>\n<p dir=\"auto\">Get the nearest neighbors to a row</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"SELECT * FROM items WHERE id != 1 ORDER BY embedding &lt;-&gt; (SELECT embedding FROM items WHERE id = 1) LIMIT 5;\" dir=\"auto\"><pre><span class=\"pl-k\">SELECT</span> <span class=\"pl-k\">*</span> <span class=\"pl-k\">FROM</span> items <span class=\"pl-k\">WHERE</span> id <span class=\"pl-k\">!=</span> <span class=\"pl-c1\">1</span> <span class=\"pl-k\">ORDER BY</span> embedding <span class=\"pl-k\">&lt;</span><span class=\"pl-k\">-</span><span class=\"pl-k\">&gt;</span> (<span class=\"pl-k\">SELECT</span> embedding <span class=\"pl-k\">FROM</span> items <span class=\"pl-k\">WHERE</span> id <span class=\"pl-k\">=</span> <span class=\"pl-c1\">1</span>) <span class=\"pl-k\">LIMIT</span> <span class=\"pl-c1\">5</span>;</pre></div>\n<p dir=\"auto\">Get rows within a certain distance</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"SELECT * FROM items WHERE embedding &lt;-&gt; '[3,1,2]' &lt; 5;\" dir=\"auto\"><pre><span class=\"pl-k\">SELECT</span> <span class=\"pl-k\">*</span> <span class=\"pl-k\">FROM</span> items <span class=\"pl-k\">WHERE</span> embedding <span class=\"pl-k\">&lt;</span><span class=\"pl-k\">-</span><span class=\"pl-k\">&gt;</span> <span class=\"pl-s\"><span class=\"pl-pds\">'</span>[3,1,2]<span class=\"pl-pds\">'</span></span> <span class=\"pl-k\">&lt;</span> <span class=\"pl-c1\">5</span>;</pre></div>\n<p dir=\"auto\">Note: Combine with <code>ORDER BY</code> and <code>LIMIT</code> to use an index</p>\n<div class=\"markdown-heading\" dir=\"auto\"><h4 class=\"heading-element\" dir=\"auto\" tabindex=\"-1\">Distances</h4><a aria-label=\"Permalink: Distances\" class=\"anchor\" href=\"https://github.com/pgvector/pgvector#distances\" id=\"user-content-distances\" target=\"_blank\"><svg aria-hidden=\"true\" class=\"octicon octicon-link\" height=\"16\" version=\"1.1\" viewbox=\"0 0 16 16\" width=\"16\"><path d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"></path></svg></a></div>\n<p dir=\"auto\">Get the distance</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"SELECT embedding &lt;-&gt; '[3,1,2]' AS distance FROM items;\" dir=\"auto\"><pre><span class=\"pl-k\">SELECT</span> embedding <span class=\"pl-k\">&lt;</span><span class=\"pl-k\">-</span><span class=\"pl-k\">&gt;</span> <span class=\"pl-s\"><span class=\"pl-pds\">'</span>[3,1,2]<span class=\"pl-pds\">'</span></span> <span class=\"pl-k\">AS</span> distance <span class=\"pl-k\">FROM</span> items;</pre></div>\n<p dir=\"auto\">For inner product, multiply by -1 (since <code>&lt;#&gt;</code> returns the negative inner product)</p>\n<div class=\"highlight highlight-source-tsql notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"SELECT (embedding &lt;#&gt; '[3,1,2]') * -1 AS inner_product FROM items;\" dir=\"auto\"><pre><span class=\"pl-k\">SELECT</span> (embedding <span class=\"pl-k\">&lt;</span>#<span class=\"pl-k\">&gt;</span> <span class=\"pl-s\"><span class=\"pl-pds\">'</span>[3,1,2]'</span>) <span class=\"pl-k\">*</span> <span class=\"pl-k\">-</span><span class=\"pl-c1\">1</span> <span class=\"pl-k\">AS</span> inner_product <span class=\"pl-k\">FROM</span> items;</pre></div>\n<p dir=\"auto\">For cosine similarity, use 1 - cosine distance</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"SELECT 1 - (embedding &lt;=&gt; '[3,1,2]') AS cosine_similarity FROM items;\" dir=\"auto\"><pre><span class=\"pl-k\">SELECT</span> <span class=\"pl-c1\">1</span> <span class=\"pl-k\">-</span> (embedding <span class=\"pl-k\">&lt;=&gt;</span> <span class=\"pl-s\"><span class=\"pl-pds\">'</span>[3,1,2]<span class=\"pl-pds\">'</span></span>) <span class=\"pl-k\">AS</span> cosine_similarity <span class=\"pl-k\">FROM</span> items;</pre></div>\n<div class=\"markdown-heading\" dir=\"auto\"><h4 class=\"heading-element\" dir=\"auto\" tabindex=\"-1\">Aggregates</h4><a aria-label=\"Permalink: Aggregates\" class=\"anchor\" href=\"https://github.com/pgvector/pgvector#aggregates\" id=\"user-content-aggregates\" target=\"_blank\"><svg aria-hidden=\"true\" class=\"octicon octicon-link\" height=\"16\" version=\"1.1\" viewbox=\"0 0 16 16\" width=\"16\"><path d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"></path></svg></a></div>\n<p dir=\"auto\">Average vectors</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"SELECT AVG(embedding) FROM items;\" dir=\"auto\"><pre><span class=\"pl-k\">SELECT</span> <span class=\"pl-c1\">AVG</span>(embedding) <span class=\"pl-k\">FROM</span> items;</pre></div>\n<p dir=\"auto\">Average groups of vectors</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"SELECT category_id, AVG(embedding) FROM items GROUP BY category_id;\" dir=\"auto\"><pre><span class=\"pl-k\">SELECT</span> category_id, <span class=\"pl-c1\">AVG</span>(embedding) <span class=\"pl-k\">FROM</span> items <span class=\"pl-k\">GROUP BY</span> category_id;</pre></div>\n<div class=\"markdown-heading\" dir=\"auto\"><h2 class=\"heading-element\" dir=\"auto\" tabindex=\"-1\">Indexing</h2><a aria-label=\"Permalink: Indexing\" class=\"anchor\" href=\"https://github.com/pgvector/pgvector#indexing\" id=\"user-content-indexing\" target=\"_blank\"><svg aria-hidden=\"true\" class=\"octicon octicon-link\" height=\"16\" version=\"1.1\" viewbox=\"0 0 16 16\" width=\"16\"><path d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"></path></svg></a></div>\n<p dir=\"auto\">By default, pgvector performs exact nearest neighbor search, which provides perfect recall.</p>\n<p dir=\"auto\">You can add an index to use approximate nearest neighbor search, which trades some recall for speed. Unlike typical indexes, you will see different results for queries after adding an approximate index.</p>\n<p dir=\"auto\">Supported index types are:</p>\n<ul dir=\"auto\">\n<li><a href=\"https://github.com/pgvector/pgvector#hnsw\" target=\"_blank\">HNSW</a></li>\n<li><a href=\"https://github.com/pgvector/pgvector#ivfflat\" target=\"_blank\">IVFFlat</a></li>\n</ul>\n<div class=\"markdown-heading\" dir=\"auto\"><h2 class=\"heading-element\" dir=\"auto\" tabindex=\"-1\">HNSW</h2><a aria-label=\"Permalink: HNSW\" class=\"anchor\" href=\"https://github.com/pgvector/pgvector#hnsw\" id=\"user-content-hnsw\" target=\"_blank\"><svg aria-hidden=\"true\" class=\"octicon octicon-link\" height=\"16\" version=\"1.1\" viewbox=\"0 0 16 16\" width=\"16\"><path d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"></path></svg></a></div>\n<p dir=\"auto\">An HNSW index creates a multilayer graph. It has better query performance than IVFFlat (in terms of speed-recall tradeoff), but has slower build times and uses more memory. Also, an index can be created without any data in the table since there isn’t a training step like IVFFlat.</p>\n<p dir=\"auto\">Add an index for each distance function you want to use.</p>\n<p dir=\"auto\">L2 distance</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"CREATE INDEX ON items USING hnsw (embedding vector_l2_ops);\" dir=\"auto\"><pre><span class=\"pl-k\">CREATE</span> <span class=\"pl-k\">INDEX</span> <span class=\"pl-en\">ON</span> items USING hnsw (embedding vector_l2_ops);</pre></div>\n<p dir=\"auto\">Note: Use <code>halfvec_l2_ops</code> for <code>halfvec</code> and <code>sparsevec_l2_ops</code> for <code>sparsevec</code> (and similar with the other distance functions)</p>\n<p dir=\"auto\">Inner product</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"CREATE INDEX ON items USING hnsw (embedding vector_ip_ops);\" dir=\"auto\"><pre><span class=\"pl-k\">CREATE</span> <span class=\"pl-k\">INDEX</span> <span class=\"pl-en\">ON</span> items USING hnsw (embedding vector_ip_ops);</pre></div>\n<p dir=\"auto\">Cosine distance</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"CREATE INDEX ON items USING hnsw (embedding vector_cosine_ops);\" dir=\"auto\"><pre><span class=\"pl-k\">CREATE</span> <span class=\"pl-k\">INDEX</span> <span class=\"pl-en\">ON</span> items USING hnsw (embedding vector_cosine_ops);</pre></div>\n<p dir=\"auto\">L1 distance</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"CREATE INDEX ON items USING hnsw (embedding vector_l1_ops);\" dir=\"auto\"><pre><span class=\"pl-k\">CREATE</span> <span class=\"pl-k\">INDEX</span> <span class=\"pl-en\">ON</span> items USING hnsw (embedding vector_l1_ops);</pre></div>\n<p dir=\"auto\">Hamming distance</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"CREATE INDEX ON items USING hnsw (embedding bit_hamming_ops);\" dir=\"auto\"><pre><span class=\"pl-k\">CREATE</span> <span class=\"pl-k\">INDEX</span> <span class=\"pl-en\">ON</span> items USING hnsw (embedding bit_hamming_ops);</pre></div>\n<p dir=\"auto\">Jaccard distance</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"CREATE INDEX ON items USING hnsw (embedding bit_jaccard_ops);\" dir=\"auto\"><pre><span class=\"pl-k\">CREATE</span> <span class=\"pl-k\">INDEX</span> <span class=\"pl-en\">ON</span> items USING hnsw (embedding bit_jaccard_ops);</pre></div>\n<p dir=\"auto\">Supported types are:</p>\n<ul dir=\"auto\">\n<li><code>vector</code> - up to 2,000 dimensions</li>\n<li><code>halfvec</code> - up to 4,000 dimensions</li>\n<li><code>bit</code> - up to 64,000 dimensions</li>\n<li><code>sparsevec</code> - up to 1,000 non-zero elements</li>\n</ul>\n<div class=\"markdown-heading\" dir=\"auto\"><h3 class=\"heading-element\" dir=\"auto\" tabindex=\"-1\">Index Options</h3><a aria-label=\"Permalink: Index Options\" class=\"anchor\" href=\"https://github.com/pgvector/pgvector#index-options\" id=\"user-content-index-options\" target=\"_blank\"><svg aria-hidden=\"true\" class=\"octicon octicon-link\" height=\"16\" version=\"1.1\" viewbox=\"0 0 16 16\" width=\"16\"><path d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"></path></svg></a></div>\n<p dir=\"auto\">Specify HNSW parameters</p>\n<ul dir=\"auto\">\n<li><code>m</code> - the max number of connections per layer (16 by default)</li>\n<li><code>ef_construction</code> - the size of the dynamic candidate list for constructing the graph (64 by default)</li>\n</ul>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"CREATE INDEX ON items USING hnsw (embedding vector_l2_ops) WITH (m = 16, ef_construction = 64);\" dir=\"auto\"><pre><span class=\"pl-k\">CREATE</span> <span class=\"pl-k\">INDEX</span> <span class=\"pl-en\">ON</span> items USING hnsw (embedding vector_l2_ops) WITH (m <span class=\"pl-k\">=</span> <span class=\"pl-c1\">16</span>, ef_construction <span class=\"pl-k\">=</span> <span class=\"pl-c1\">64</span>);</pre></div>\n<p dir=\"auto\">A higher value of <code>ef_construction</code> provides better recall at the cost of index build time / insert speed.</p>\n<div class=\"markdown-heading\" dir=\"auto\"><h3 class=\"heading-element\" dir=\"auto\" tabindex=\"-1\">Query Options</h3><a aria-label=\"Permalink: Query Options\" class=\"anchor\" href=\"https://github.com/pgvector/pgvector#query-options\" id=\"user-content-query-options\" target=\"_blank\"><svg aria-hidden=\"true\" class=\"octicon octicon-link\" height=\"16\" version=\"1.1\" viewbox=\"0 0 16 16\" width=\"16\"><path d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"></path></svg></a></div>\n<p dir=\"auto\">Specify the size of the dynamic candidate list for search (40 by default)</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"SET hnsw.ef_search = 100;\" dir=\"auto\"><pre><span class=\"pl-k\">SET</span> <span class=\"pl-c1\">hnsw</span>.<span class=\"pl-c1\">ef_search</span> <span class=\"pl-k\">=</span> <span class=\"pl-c1\">100</span>;</pre></div>\n<p dir=\"auto\">A higher value provides better recall at the cost of speed.</p>\n<p dir=\"auto\">Use <code>SET LOCAL</code> inside a transaction to set it for a single query</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"BEGIN;\nSET LOCAL hnsw.ef_search = 100;\nSELECT ...\nCOMMIT;\" dir=\"auto\"><pre><span class=\"pl-k\">BEGIN</span>;\n<span class=\"pl-k\">SET</span> LOCAL <span class=\"pl-c1\">hnsw</span>.<span class=\"pl-c1\">ef_search</span> <span class=\"pl-k\">=</span> <span class=\"pl-c1\">100</span>;\n<span class=\"pl-k\">SELECT</span> ...\n<span class=\"pl-k\">COMMIT</span>;</pre></div>\n<div class=\"markdown-heading\" dir=\"auto\"><h3 class=\"heading-element\" dir=\"auto\" tabindex=\"-1\">Index Build Time</h3><a aria-label=\"Permalink: Index Build Time\" class=\"anchor\" href=\"https://github.com/pgvector/pgvector#index-build-time\" id=\"user-content-index-build-time\" target=\"_blank\"><svg aria-hidden=\"true\" class=\"octicon octicon-link\" height=\"16\" version=\"1.1\" viewbox=\"0 0 16 16\" width=\"16\"><path d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"></path></svg></a></div>\n<p dir=\"auto\">Indexes build significantly faster when the graph fits into <code>maintenance_work_mem</code></p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"SET maintenance_work_mem = '8GB';\" dir=\"auto\"><pre><span class=\"pl-k\">SET</span> maintenance_work_mem <span class=\"pl-k\">=</span> <span class=\"pl-s\"><span class=\"pl-pds\">'</span>8GB<span class=\"pl-pds\">'</span></span>;</pre></div>\n<p dir=\"auto\">A notice is shown when the graph no longer fits</p>\n<div class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"NOTICE:  hnsw graph no longer fits into maintenance_work_mem after 100000 tuples\nDETAIL:  Building will take significantly more time.\nHINT:  Increase maintenance_work_mem to speed up builds.\"><pre class=\"notranslate\" lang=\"text\"><code>NOTICE:  hnsw graph no longer fits into maintenance_work_mem after 100000 tuples\nDETAIL:  Building will take significantly more time.\nHINT:  Increase maintenance_work_mem to speed up builds.\n</code></pre></div>\n<p dir=\"auto\">Note: Do not set <code>maintenance_work_mem</code> so high that it exhausts the memory on the server</p>\n<p dir=\"auto\">Like other index types, it’s faster to create an index after loading your initial data</p>\n<p dir=\"auto\">You can also speed up index creation by increasing the number of parallel workers (2 by default)</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"SET max_parallel_maintenance_workers = 7; -- plus leader\" dir=\"auto\"><pre><span class=\"pl-k\">SET</span> max_parallel_maintenance_workers <span class=\"pl-k\">=</span> <span class=\"pl-c1\">7</span>; <span class=\"pl-c\"><span class=\"pl-c\">--</span> plus leader</span></pre></div>\n<p dir=\"auto\">For a large number of workers, you may need to increase <code>max_parallel_workers</code> (8 by default)</p>\n<p dir=\"auto\">The <a href=\"https://github.com/pgvector/pgvector#index-options\" target=\"_blank\">index options</a> also have a significant impact on build time (use the defaults unless seeing low recall)</p>\n<div class=\"markdown-heading\" dir=\"auto\"><h3 class=\"heading-element\" dir=\"auto\" tabindex=\"-1\">Indexing Progress</h3><a aria-label=\"Permalink: Indexing Progress\" class=\"anchor\" href=\"https://github.com/pgvector/pgvector#indexing-progress\" id=\"user-content-indexing-progress\" target=\"_blank\"><svg aria-hidden=\"true\" class=\"octicon octicon-link\" height=\"16\" version=\"1.1\" viewbox=\"0 0 16 16\" width=\"16\"><path d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"></path></svg></a></div>\n<p dir=\"auto\">Check <a href=\"https://www.postgresql.org/docs/current/progress-reporting.html#CREATE-INDEX-PROGRESS-REPORTING\" rel=\"nofollow\" target=\"_blank\">indexing progress</a></p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content='SELECT phase, round(100.0 * blocks_done / nullif(blocks_total, 0), 1) AS \"%\" FROM pg_stat_progress_create_index;' dir=\"auto\"><pre><span class=\"pl-k\">SELECT</span> phase, round(<span class=\"pl-c1\">100</span>.<span class=\"pl-c1\">0</span> <span class=\"pl-k\">*</span> blocks_done <span class=\"pl-k\">/</span> nullif(blocks_total, <span class=\"pl-c1\">0</span>), <span class=\"pl-c1\">1</span>) <span class=\"pl-k\">AS</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>%<span class=\"pl-pds\">\"</span></span> <span class=\"pl-k\">FROM</span> pg_stat_progress_create_index;</pre></div>\n<p dir=\"auto\">The phases for HNSW are:</p>\n<ol dir=\"auto\">\n<li><code>initializing</code></li>\n<li><code>loading tuples</code></li>\n</ol>\n<div class=\"markdown-heading\" dir=\"auto\"><h2 class=\"heading-element\" dir=\"auto\" tabindex=\"-1\">IVFFlat</h2><a aria-label=\"Permalink: IVFFlat\" class=\"anchor\" href=\"https://github.com/pgvector/pgvector#ivfflat\" id=\"user-content-ivfflat\" target=\"_blank\"><svg aria-hidden=\"true\" class=\"octicon octicon-link\" height=\"16\" version=\"1.1\" viewbox=\"0 0 16 16\" width=\"16\"><path d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"></path></svg></a></div>\n<p dir=\"auto\">An IVFFlat index divides vectors into lists, and then searches a subset of those lists that are closest to the query vector. It has faster build times and uses less memory than HNSW, but has lower query performance (in terms of speed-recall tradeoff).</p>\n<p dir=\"auto\">Three keys to achieving good recall are:</p>\n<ol dir=\"auto\">\n<li>Create the index <em>after</em> the table has some data</li>\n<li>Choose an appropriate number of lists - a good place to start is <code>rows / 1000</code> for up to 1M rows and <code>sqrt(rows)</code> for over 1M rows</li>\n<li>When querying, specify an appropriate number of <a href=\"https://github.com/pgvector/pgvector#query-options\" target=\"_blank\">probes</a> (higher is better for recall, lower is better for speed) - a good place to start is <code>sqrt(lists)</code></li>\n</ol>\n<p dir=\"auto\">Add an index for each distance function you want to use.</p>\n<p dir=\"auto\">L2 distance</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"CREATE INDEX ON items USING ivfflat (embedding vector_l2_ops) WITH (lists = 100);\" dir=\"auto\"><pre><span class=\"pl-k\">CREATE</span> <span class=\"pl-k\">INDEX</span> <span class=\"pl-en\">ON</span> items USING ivfflat (embedding vector_l2_ops) WITH (lists <span class=\"pl-k\">=</span> <span class=\"pl-c1\">100</span>);</pre></div>\n<p dir=\"auto\">Note: Use <code>halfvec_l2_ops</code> for <code>halfvec</code> (and similar with the other distance functions)</p>\n<p dir=\"auto\">Inner product</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"CREATE INDEX ON items USING ivfflat (embedding vector_ip_ops) WITH (lists = 100);\" dir=\"auto\"><pre><span class=\"pl-k\">CREATE</span> <span class=\"pl-k\">INDEX</span> <span class=\"pl-en\">ON</span> items USING ivfflat (embedding vector_ip_ops) WITH (lists <span class=\"pl-k\">=</span> <span class=\"pl-c1\">100</span>);</pre></div>\n<p dir=\"auto\">Cosine distance</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"CREATE INDEX ON items USING ivfflat (embedding vector_cosine_ops) WITH (lists = 100);\" dir=\"auto\"><pre><span class=\"pl-k\">CREATE</span> <span class=\"pl-k\">INDEX</span> <span class=\"pl-en\">ON</span> items USING ivfflat (embedding vector_cosine_ops) WITH (lists <span class=\"pl-k\">=</span> <span class=\"pl-c1\">100</span>);</pre></div>\n<p dir=\"auto\">Hamming distance</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"CREATE INDEX ON items USING ivfflat (embedding bit_hamming_ops) WITH (lists = 100);\" dir=\"auto\"><pre><span class=\"pl-k\">CREATE</span> <span class=\"pl-k\">INDEX</span> <span class=\"pl-en\">ON</span> items USING ivfflat (embedding bit_hamming_ops) WITH (lists <span class=\"pl-k\">=</span> <span class=\"pl-c1\">100</span>);</pre></div>\n<p dir=\"auto\">Supported types are:</p>\n<ul dir=\"auto\">\n<li><code>vector</code> - up to 2,000 dimensions</li>\n<li><code>halfvec</code> - up to 4,000 dimensions</li>\n<li><code>bit</code> - up to 64,000 dimensions</li>\n</ul>\n<div class=\"markdown-heading\" dir=\"auto\"><h3 class=\"heading-element\" dir=\"auto\" tabindex=\"-1\">Query Options</h3><a aria-label=\"Permalink: Query Options\" class=\"anchor\" href=\"https://github.com/pgvector/pgvector#query-options-1\" id=\"user-content-query-options-1\" target=\"_blank\"><svg aria-hidden=\"true\" class=\"octicon octicon-link\" height=\"16\" version=\"1.1\" viewbox=\"0 0 16 16\" width=\"16\"><path d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"></path></svg></a></div>\n<p dir=\"auto\">Specify the number of probes (1 by default)</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"SET ivfflat.probes = 10;\" dir=\"auto\"><pre><span class=\"pl-k\">SET</span> <span class=\"pl-c1\">ivfflat</span>.<span class=\"pl-c1\">probes</span> <span class=\"pl-k\">=</span> <span class=\"pl-c1\">10</span>;</pre></div>\n<p dir=\"auto\">A higher value provides better recall at the cost of speed, and it can be set to the number of lists for exact nearest neighbor search (at which point the planner won’t use the index)</p>\n<p dir=\"auto\">Use <code>SET LOCAL</code> inside a transaction to set it for a single query</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"BEGIN;\nSET LOCAL ivfflat.probes = 10;\nSELECT ...\nCOMMIT;\" dir=\"auto\"><pre><span class=\"pl-k\">BEGIN</span>;\n<span class=\"pl-k\">SET</span> LOCAL <span class=\"pl-c1\">ivfflat</span>.<span class=\"pl-c1\">probes</span> <span class=\"pl-k\">=</span> <span class=\"pl-c1\">10</span>;\n<span class=\"pl-k\">SELECT</span> ...\n<span class=\"pl-k\">COMMIT</span>;</pre></div>\n<div class=\"markdown-heading\" dir=\"auto\"><h3 class=\"heading-element\" dir=\"auto\" tabindex=\"-1\">Index Build Time</h3><a aria-label=\"Permalink: Index Build Time\" class=\"anchor\" href=\"https://github.com/pgvector/pgvector#index-build-time-1\" id=\"user-content-index-build-time-1\" target=\"_blank\"><svg aria-hidden=\"true\" class=\"octicon octicon-link\" height=\"16\" version=\"1.1\" viewbox=\"0 0 16 16\" width=\"16\"><path d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"></path></svg></a></div>\n<p dir=\"auto\">Speed up index creation on large tables by increasing the number of parallel workers (2 by default)</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"SET max_parallel_maintenance_workers = 7; -- plus leader\" dir=\"auto\"><pre><span class=\"pl-k\">SET</span> max_parallel_maintenance_workers <span class=\"pl-k\">=</span> <span class=\"pl-c1\">7</span>; <span class=\"pl-c\"><span class=\"pl-c\">--</span> plus leader</span></pre></div>\n<p dir=\"auto\">For a large number of workers, you may also need to increase <code>max_parallel_workers</code> (8 by default)</p>\n<div class=\"markdown-heading\" dir=\"auto\"><h3 class=\"heading-element\" dir=\"auto\" tabindex=\"-1\">Indexing Progress</h3><a aria-label=\"Permalink: Indexing Progress\" class=\"anchor\" href=\"https://github.com/pgvector/pgvector#indexing-progress-1\" id=\"user-content-indexing-progress-1\" target=\"_blank\"><svg aria-hidden=\"true\" class=\"octicon octicon-link\" height=\"16\" version=\"1.1\" viewbox=\"0 0 16 16\" width=\"16\"><path d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"></path></svg></a></div>\n<p dir=\"auto\">Check <a href=\"https://www.postgresql.org/docs/current/progress-reporting.html#CREATE-INDEX-PROGRESS-REPORTING\" rel=\"nofollow\" target=\"_blank\">indexing progress</a></p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content='SELECT phase, round(100.0 * tuples_done / nullif(tuples_total, 0), 1) AS \"%\" FROM pg_stat_progress_create_index;' dir=\"auto\"><pre><span class=\"pl-k\">SELECT</span> phase, round(<span class=\"pl-c1\">100</span>.<span class=\"pl-c1\">0</span> <span class=\"pl-k\">*</span> tuples_done <span class=\"pl-k\">/</span> nullif(tuples_total, <span class=\"pl-c1\">0</span>), <span class=\"pl-c1\">1</span>) <span class=\"pl-k\">AS</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>%<span class=\"pl-pds\">\"</span></span> <span class=\"pl-k\">FROM</span> pg_stat_progress_create_index;</pre></div>\n<p dir=\"auto\">The phases for IVFFlat are:</p>\n<ol dir=\"auto\">\n<li><code>initializing</code></li>\n<li><code>performing k-means</code></li>\n<li><code>assigning tuples</code></li>\n<li><code>loading tuples</code></li>\n</ol>\n<p dir=\"auto\">Note: <code>%</code> is only populated during the <code>loading tuples</code> phase</p>\n<div class=\"markdown-heading\" dir=\"auto\"><h2 class=\"heading-element\" dir=\"auto\" tabindex=\"-1\">Filtering</h2><a aria-label=\"Permalink: Filtering\" class=\"anchor\" href=\"https://github.com/pgvector/pgvector#filtering\" id=\"user-content-filtering\" target=\"_blank\"><svg aria-hidden=\"true\" class=\"octicon octicon-link\" height=\"16\" version=\"1.1\" viewbox=\"0 0 16 16\" width=\"16\"><path d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"></path></svg></a></div>\n<p dir=\"auto\">There are a few ways to index nearest neighbor queries with a <code>WHERE</code> clause.</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"SELECT * FROM items WHERE category_id = 123 ORDER BY embedding &lt;-&gt; '[3,1,2]' LIMIT 5;\" dir=\"auto\"><pre><span class=\"pl-k\">SELECT</span> <span class=\"pl-k\">*</span> <span class=\"pl-k\">FROM</span> items <span class=\"pl-k\">WHERE</span> category_id <span class=\"pl-k\">=</span> <span class=\"pl-c1\">123</span> <span class=\"pl-k\">ORDER BY</span> embedding <span class=\"pl-k\">&lt;</span><span class=\"pl-k\">-</span><span class=\"pl-k\">&gt;</span> <span class=\"pl-s\"><span class=\"pl-pds\">'</span>[3,1,2]<span class=\"pl-pds\">'</span></span> <span class=\"pl-k\">LIMIT</span> <span class=\"pl-c1\">5</span>;</pre></div>\n<p dir=\"auto\">A good place to start is creating an index on the filter column. This can provide fast, exact nearest neighbor search in many cases. Postgres has a number of <a href=\"https://www.postgresql.org/docs/current/indexes-types.html\" rel=\"nofollow\" target=\"_blank\">index types</a> for this: B-tree (default), hash, GiST, SP-GiST, GIN, and BRIN.</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"CREATE INDEX ON items (category_id);\" dir=\"auto\"><pre><span class=\"pl-k\">CREATE</span> <span class=\"pl-k\">INDEX</span> <span class=\"pl-en\">ON</span> items (category_id);</pre></div>\n<p dir=\"auto\">For multiple columns, consider a <a href=\"https://www.postgresql.org/docs/current/indexes-multicolumn.html\" rel=\"nofollow\" target=\"_blank\">multicolumn index</a>.</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"CREATE INDEX ON items (location_id, category_id);\" dir=\"auto\"><pre><span class=\"pl-k\">CREATE</span> <span class=\"pl-k\">INDEX</span> <span class=\"pl-en\">ON</span> items (location_id, category_id);</pre></div>\n<p dir=\"auto\">Exact indexes work well for conditions that match a low percentage of rows. Otherwise, <a href=\"https://github.com/pgvector/pgvector#indexing\" target=\"_blank\">approximate indexes</a> can work better.</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"CREATE INDEX ON items USING hnsw (embedding vector_l2_ops);\" dir=\"auto\"><pre><span class=\"pl-k\">CREATE</span> <span class=\"pl-k\">INDEX</span> <span class=\"pl-en\">ON</span> items USING hnsw (embedding vector_l2_ops);</pre></div>\n<p dir=\"auto\">With approximate indexes, filtering is applied <em>after</em> the index is scanned. If a condition matches 10% of rows, with HNSW and the default <code>hnsw.ef_search</code> of 40, only 4 rows will match on average. For more rows, increase <code>hnsw.ef_search</code>.</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"SET hnsw.ef_search = 200;\" dir=\"auto\"><pre><span class=\"pl-k\">SET</span> <span class=\"pl-c1\">hnsw</span>.<span class=\"pl-c1\">ef_search</span> <span class=\"pl-k\">=</span> <span class=\"pl-c1\">200</span>;</pre></div>\n<p dir=\"auto\">Starting with 0.8.0, you can enable <a href=\"https://github.com/pgvector/pgvector#iterative-index-scans\" target=\"_blank\">iterative index scans</a>, which will automatically scan more of the index when needed.</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"SET hnsw.iterative_scan = strict_order;\" dir=\"auto\"><pre><span class=\"pl-k\">SET</span> <span class=\"pl-c1\">hnsw</span>.<span class=\"pl-c1\">iterative_scan</span> <span class=\"pl-k\">=</span> strict_order;</pre></div>\n<p dir=\"auto\">If filtering by only a few distinct values, consider <a href=\"https://www.postgresql.org/docs/current/indexes-partial.html\" rel=\"nofollow\" target=\"_blank\">partial indexing</a>.</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"CREATE INDEX ON items USING hnsw (embedding vector_l2_ops) WHERE (category_id = 123);\" dir=\"auto\"><pre><span class=\"pl-k\">CREATE</span> <span class=\"pl-k\">INDEX</span> <span class=\"pl-en\">ON</span> items USING hnsw (embedding vector_l2_ops) <span class=\"pl-k\">WHERE</span> (category_id <span class=\"pl-k\">=</span> <span class=\"pl-c1\">123</span>);</pre></div>\n<p dir=\"auto\">If filtering by many different values, consider <a href=\"https://www.postgresql.org/docs/current/ddl-partitioning.html\" rel=\"nofollow\" target=\"_blank\">partitioning</a>.</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"CREATE TABLE items (embedding vector(3), category_id int) PARTITION BY LIST(category_id);\" dir=\"auto\"><pre><span class=\"pl-k\">CREATE</span> <span class=\"pl-k\">TABLE</span> <span class=\"pl-en\">items</span> (embedding vector(<span class=\"pl-c1\">3</span>), category_id <span class=\"pl-k\">int</span>) PARTITION BY LIST(category_id);</pre></div>\n<div class=\"markdown-heading\" dir=\"auto\"><h2 class=\"heading-element\" dir=\"auto\" tabindex=\"-1\">Iterative Index Scans</h2><a aria-label=\"Permalink: Iterative Index Scans\" class=\"anchor\" href=\"https://github.com/pgvector/pgvector#iterative-index-scans\" id=\"user-content-iterative-index-scans\" target=\"_blank\"><svg aria-hidden=\"true\" class=\"octicon octicon-link\" height=\"16\" version=\"1.1\" viewbox=\"0 0 16 16\" width=\"16\"><path d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"></path></svg></a></div>\n<p dir=\"auto\">With approximate indexes, queries with filtering can return less results since filtering is applied <em>after</em> the index is scanned. Starting with 0.8.0, you can enable iterative index scans, which will automatically scan more of the index until enough results are found (or it reaches <code>hnsw.max_scan_tuples</code> or <code>ivfflat.max_probes</code>).</p>\n<p dir=\"auto\">Iterative scans can use strict or relaxed ordering.</p>\n<p dir=\"auto\">Strict ensures results are in the exact order by distance</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"SET hnsw.iterative_scan = strict_order;\" dir=\"auto\"><pre><span class=\"pl-k\">SET</span> <span class=\"pl-c1\">hnsw</span>.<span class=\"pl-c1\">iterative_scan</span> <span class=\"pl-k\">=</span> strict_order;</pre></div>\n<p dir=\"auto\">Relaxed allows results to be slightly out of order by distance, but provides better recall</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"SET hnsw.iterative_scan = relaxed_order;\n# or\nSET ivfflat.iterative_scan = relaxed_order;\" dir=\"auto\"><pre><span class=\"pl-k\">SET</span> <span class=\"pl-c1\">hnsw</span>.<span class=\"pl-c1\">iterative_scan</span> <span class=\"pl-k\">=</span> relaxed_order;\n<span class=\"pl-c\"><span class=\"pl-c\">#</span> or</span>\n<span class=\"pl-k\">SET</span> <span class=\"pl-c1\">ivfflat</span>.<span class=\"pl-c1\">iterative_scan</span> <span class=\"pl-k\">=</span> relaxed_order;</pre></div>\n<p dir=\"auto\">With relaxed ordering, you can use a <a href=\"https://www.postgresql.org/docs/current/queries-with.html#QUERIES-WITH-CTE-MATERIALIZATION\" rel=\"nofollow\" target=\"_blank\">materialized CTE</a> to get strict ordering</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"WITH relaxed_results AS MATERIALIZED (\n    SELECT id, embedding &lt;-&gt; '[1,2,3]' AS distance FROM items WHERE category_id = 123 ORDER BY distance LIMIT 5\n) SELECT * FROM relaxed_results ORDER BY distance + 0;\" dir=\"auto\"><pre>WITH relaxed_results <span class=\"pl-k\">AS</span> MATERIALIZED (\n    <span class=\"pl-k\">SELECT</span> id, embedding <span class=\"pl-k\">&lt;</span><span class=\"pl-k\">-</span><span class=\"pl-k\">&gt;</span> <span class=\"pl-s\"><span class=\"pl-pds\">'</span>[1,2,3]<span class=\"pl-pds\">'</span></span> <span class=\"pl-k\">AS</span> distance <span class=\"pl-k\">FROM</span> items <span class=\"pl-k\">WHERE</span> category_id <span class=\"pl-k\">=</span> <span class=\"pl-c1\">123</span> <span class=\"pl-k\">ORDER BY</span> distance <span class=\"pl-k\">LIMIT</span> <span class=\"pl-c1\">5</span>\n) <span class=\"pl-k\">SELECT</span> <span class=\"pl-k\">*</span> <span class=\"pl-k\">FROM</span> relaxed_results <span class=\"pl-k\">ORDER BY</span> distance <span class=\"pl-k\">+</span> <span class=\"pl-c1\">0</span>;</pre></div>\n<p dir=\"auto\">Note: <code>+ 0</code> is needed for Postgres 17+</p>\n<p dir=\"auto\">For queries that filter by distance, use a materialized CTE and place the distance filter outside of it for best performance (due to the <a href=\"https://www.postgresql.org/message-id/flat/CAOdR5yGUoMQ6j7M5hNUXrySzaqZVGf_Ne%2B8fwZMRKTFxU1nbJg%40mail.gmail.com\" rel=\"nofollow\" target=\"_blank\">current behavior</a> of the Postgres executor)</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"WITH nearest_results AS MATERIALIZED (\n    SELECT id, embedding &lt;-&gt; '[1,2,3]' AS distance FROM items ORDER BY distance LIMIT 5\n) SELECT * FROM nearest_results WHERE distance &lt; 5 ORDER BY distance;\" dir=\"auto\"><pre>WITH nearest_results <span class=\"pl-k\">AS</span> MATERIALIZED (\n    <span class=\"pl-k\">SELECT</span> id, embedding <span class=\"pl-k\">&lt;</span><span class=\"pl-k\">-</span><span class=\"pl-k\">&gt;</span> <span class=\"pl-s\"><span class=\"pl-pds\">'</span>[1,2,3]<span class=\"pl-pds\">'</span></span> <span class=\"pl-k\">AS</span> distance <span class=\"pl-k\">FROM</span> items <span class=\"pl-k\">ORDER BY</span> distance <span class=\"pl-k\">LIMIT</span> <span class=\"pl-c1\">5</span>\n) <span class=\"pl-k\">SELECT</span> <span class=\"pl-k\">*</span> <span class=\"pl-k\">FROM</span> nearest_results <span class=\"pl-k\">WHERE</span> distance <span class=\"pl-k\">&lt;</span> <span class=\"pl-c1\">5</span> <span class=\"pl-k\">ORDER BY</span> distance;</pre></div>\n<p dir=\"auto\">Note: Place any other filters inside the CTE</p>\n<div class=\"markdown-heading\" dir=\"auto\"><h3 class=\"heading-element\" dir=\"auto\" tabindex=\"-1\">Iterative Scan Options</h3><a aria-label=\"Permalink: Iterative Scan Options\" class=\"anchor\" href=\"https://github.com/pgvector/pgvector#iterative-scan-options\" id=\"user-content-iterative-scan-options\" target=\"_blank\"><svg aria-hidden=\"true\" class=\"octicon octicon-link\" height=\"16\" version=\"1.1\" viewbox=\"0 0 16 16\" width=\"16\"><path d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"></path></svg></a></div>\n<p dir=\"auto\">Since scanning a large portion of an approximate index is expensive, there are options to control when a scan ends.</p>\n<div class=\"markdown-heading\" dir=\"auto\"><h4 class=\"heading-element\" dir=\"auto\" tabindex=\"-1\">HNSW</h4><a aria-label=\"Permalink: HNSW\" class=\"anchor\" href=\"https://github.com/pgvector/pgvector#hnsw-1\" id=\"user-content-hnsw-1\" target=\"_blank\"><svg aria-hidden=\"true\" class=\"octicon octicon-link\" height=\"16\" version=\"1.1\" viewbox=\"0 0 16 16\" width=\"16\"><path d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"></path></svg></a></div>\n<p dir=\"auto\">Specify the max number of tuples to visit (20,000 by default)</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"SET hnsw.max_scan_tuples = 20000;\" dir=\"auto\"><pre><span class=\"pl-k\">SET</span> <span class=\"pl-c1\">hnsw</span>.<span class=\"pl-c1\">max_scan_tuples</span> <span class=\"pl-k\">=</span> <span class=\"pl-c1\">20000</span>;</pre></div>\n<p dir=\"auto\">Note: This is approximate and does not affect the initial scan</p>\n<p dir=\"auto\">Specify the max amount of memory to use, as a multiple of <code>work_mem</code> (1 by default)</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"SET hnsw.scan_mem_multiplier = 2;\" dir=\"auto\"><pre><span class=\"pl-k\">SET</span> <span class=\"pl-c1\">hnsw</span>.<span class=\"pl-c1\">scan_mem_multiplier</span> <span class=\"pl-k\">=</span> <span class=\"pl-c1\">2</span>;</pre></div>\n<p dir=\"auto\">Note: Try increasing this if increasing <code>hnsw.max_scan_tuples</code> does not improve recall</p>\n<div class=\"markdown-heading\" dir=\"auto\"><h4 class=\"heading-element\" dir=\"auto\" tabindex=\"-1\">IVFFlat</h4><a aria-label=\"Permalink: IVFFlat\" class=\"anchor\" href=\"https://github.com/pgvector/pgvector#ivfflat-1\" id=\"user-content-ivfflat-1\" target=\"_blank\"><svg aria-hidden=\"true\" class=\"octicon octicon-link\" height=\"16\" version=\"1.1\" viewbox=\"0 0 16 16\" width=\"16\"><path d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"></path></svg></a></div>\n<p dir=\"auto\">Specify the max number of probes</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"SET ivfflat.max_probes = 100;\" dir=\"auto\"><pre><span class=\"pl-k\">SET</span> <span class=\"pl-c1\">ivfflat</span>.<span class=\"pl-c1\">max_probes</span> <span class=\"pl-k\">=</span> <span class=\"pl-c1\">100</span>;</pre></div>\n<p dir=\"auto\">Note: If this is lower than <code>ivfflat.probes</code>, <code>ivfflat.probes</code> will be used</p>\n<div class=\"markdown-heading\" dir=\"auto\"><h2 class=\"heading-element\" dir=\"auto\" tabindex=\"-1\">Half-Precision Vectors</h2><a aria-label=\"Permalink: Half-Precision Vectors\" class=\"anchor\" href=\"https://github.com/pgvector/pgvector#half-precision-vectors\" id=\"user-content-half-precision-vectors\" target=\"_blank\"><svg aria-hidden=\"true\" class=\"octicon octicon-link\" height=\"16\" version=\"1.1\" viewbox=\"0 0 16 16\" width=\"16\"><path d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"></path></svg></a></div>\n<p dir=\"auto\">Use the <code>halfvec</code> type to store half-precision vectors</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"CREATE TABLE items (id bigserial PRIMARY KEY, embedding halfvec(3));\" dir=\"auto\"><pre><span class=\"pl-k\">CREATE</span> <span class=\"pl-k\">TABLE</span> <span class=\"pl-en\">items</span> (id <span class=\"pl-k\">bigserial</span> <span class=\"pl-k\">PRIMARY KEY</span>, embedding halfvec(<span class=\"pl-c1\">3</span>));</pre></div>\n<div class=\"markdown-heading\" dir=\"auto\"><h2 class=\"heading-element\" dir=\"auto\" tabindex=\"-1\">Half-Precision Indexing</h2><a aria-label=\"Permalink: Half-Precision Indexing\" class=\"anchor\" href=\"https://github.com/pgvector/pgvector#half-precision-indexing\" id=\"user-content-half-precision-indexing\" target=\"_blank\"><svg aria-hidden=\"true\" class=\"octicon octicon-link\" height=\"16\" version=\"1.1\" viewbox=\"0 0 16 16\" width=\"16\"><path d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"></path></svg></a></div>\n<p dir=\"auto\">Index vectors at half precision for smaller indexes</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"CREATE INDEX ON items USING hnsw ((embedding::halfvec(3)) halfvec_l2_ops);\" dir=\"auto\"><pre><span class=\"pl-k\">CREATE</span> <span class=\"pl-k\">INDEX</span> <span class=\"pl-en\">ON</span> items USING hnsw ((embedding::halfvec(<span class=\"pl-c1\">3</span>)) halfvec_l2_ops);</pre></div>\n<p dir=\"auto\">Get the nearest neighbors</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"SELECT * FROM items ORDER BY embedding::halfvec(3) &lt;-&gt; '[1,2,3]' LIMIT 5;\" dir=\"auto\"><pre><span class=\"pl-k\">SELECT</span> <span class=\"pl-k\">*</span> <span class=\"pl-k\">FROM</span> items <span class=\"pl-k\">ORDER BY</span> embedding::halfvec(<span class=\"pl-c1\">3</span>) <span class=\"pl-k\">&lt;</span><span class=\"pl-k\">-</span><span class=\"pl-k\">&gt;</span> <span class=\"pl-s\"><span class=\"pl-pds\">'</span>[1,2,3]<span class=\"pl-pds\">'</span></span> <span class=\"pl-k\">LIMIT</span> <span class=\"pl-c1\">5</span>;</pre></div>\n<div class=\"markdown-heading\" dir=\"auto\"><h2 class=\"heading-element\" dir=\"auto\" tabindex=\"-1\">Binary Vectors</h2><a aria-label=\"Permalink: Binary Vectors\" class=\"anchor\" href=\"https://github.com/pgvector/pgvector#binary-vectors\" id=\"user-content-binary-vectors\" target=\"_blank\"><svg aria-hidden=\"true\" class=\"octicon octicon-link\" height=\"16\" version=\"1.1\" viewbox=\"0 0 16 16\" width=\"16\"><path d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"></path></svg></a></div>\n<p dir=\"auto\">Use the <code>bit</code> type to store binary vectors (<a href=\"https://github.com/pgvector/pgvector-python/blob/master/examples/imagehash/example.py\" target=\"_blank\">example</a>)</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"CREATE TABLE items (id bigserial PRIMARY KEY, embedding bit(3));\nINSERT INTO items (embedding) VALUES ('000'), ('111');\" dir=\"auto\"><pre><span class=\"pl-k\">CREATE</span> <span class=\"pl-k\">TABLE</span> <span class=\"pl-en\">items</span> (id <span class=\"pl-k\">bigserial</span> <span class=\"pl-k\">PRIMARY KEY</span>, embedding <span class=\"pl-k\">bit</span>(<span class=\"pl-c1\">3</span>));\n<span class=\"pl-k\">INSERT INTO</span> items (embedding) <span class=\"pl-k\">VALUES</span> (<span class=\"pl-s\"><span class=\"pl-pds\">'</span>000<span class=\"pl-pds\">'</span></span>), (<span class=\"pl-s\"><span class=\"pl-pds\">'</span>111<span class=\"pl-pds\">'</span></span>);</pre></div>\n<p dir=\"auto\">Get the nearest neighbors by Hamming distance</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"SELECT * FROM items ORDER BY embedding &lt;~&gt; '101' LIMIT 5;\" dir=\"auto\"><pre><span class=\"pl-k\">SELECT</span> <span class=\"pl-k\">*</span> <span class=\"pl-k\">FROM</span> items <span class=\"pl-k\">ORDER BY</span> embedding <span class=\"pl-k\">&lt;</span>~<span class=\"pl-k\">&gt;</span> <span class=\"pl-s\"><span class=\"pl-pds\">'</span>101<span class=\"pl-pds\">'</span></span> <span class=\"pl-k\">LIMIT</span> <span class=\"pl-c1\">5</span>;</pre></div>\n<p dir=\"auto\">Also supports Jaccard distance (<code>&lt;%&gt;</code>)</p>\n<div class=\"markdown-heading\" dir=\"auto\"><h2 class=\"heading-element\" dir=\"auto\" tabindex=\"-1\">Binary Quantization</h2><a aria-label=\"Permalink: Binary Quantization\" class=\"anchor\" href=\"https://github.com/pgvector/pgvector#binary-quantization\" id=\"user-content-binary-quantization\" target=\"_blank\"><svg aria-hidden=\"true\" class=\"octicon octicon-link\" height=\"16\" version=\"1.1\" viewbox=\"0 0 16 16\" width=\"16\"><path d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"></path></svg></a></div>\n<p dir=\"auto\">Use expression indexing for binary quantization</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"CREATE INDEX ON items USING hnsw ((binary_quantize(embedding)::bit(3)) bit_hamming_ops);\" dir=\"auto\"><pre><span class=\"pl-k\">CREATE</span> <span class=\"pl-k\">INDEX</span> <span class=\"pl-en\">ON</span> items USING hnsw ((binary_quantize(embedding)::<span class=\"pl-k\">bit</span>(<span class=\"pl-c1\">3</span>)) bit_hamming_ops);</pre></div>\n<p dir=\"auto\">Get the nearest neighbors by Hamming distance</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"SELECT * FROM items ORDER BY binary_quantize(embedding)::bit(3) &lt;~&gt; binary_quantize('[1,-2,3]') LIMIT 5;\" dir=\"auto\"><pre><span class=\"pl-k\">SELECT</span> <span class=\"pl-k\">*</span> <span class=\"pl-k\">FROM</span> items <span class=\"pl-k\">ORDER BY</span> binary_quantize(embedding)::<span class=\"pl-k\">bit</span>(<span class=\"pl-c1\">3</span>) <span class=\"pl-k\">&lt;</span>~<span class=\"pl-k\">&gt;</span> binary_quantize(<span class=\"pl-s\"><span class=\"pl-pds\">'</span>[1,-2,3]<span class=\"pl-pds\">'</span></span>) <span class=\"pl-k\">LIMIT</span> <span class=\"pl-c1\">5</span>;</pre></div>\n<p dir=\"auto\">Re-rank by the original vectors for better recall</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"SELECT * FROM (\n    SELECT * FROM items ORDER BY binary_quantize(embedding)::bit(3) &lt;~&gt; binary_quantize('[1,-2,3]') LIMIT 20\n) ORDER BY embedding &lt;=&gt; '[1,-2,3]' LIMIT 5;\" dir=\"auto\"><pre><span class=\"pl-k\">SELECT</span> <span class=\"pl-k\">*</span> <span class=\"pl-k\">FROM</span> (\n    <span class=\"pl-k\">SELECT</span> <span class=\"pl-k\">*</span> <span class=\"pl-k\">FROM</span> items <span class=\"pl-k\">ORDER BY</span> binary_quantize(embedding)::<span class=\"pl-k\">bit</span>(<span class=\"pl-c1\">3</span>) <span class=\"pl-k\">&lt;</span>~<span class=\"pl-k\">&gt;</span> binary_quantize(<span class=\"pl-s\"><span class=\"pl-pds\">'</span>[1,-2,3]<span class=\"pl-pds\">'</span></span>) <span class=\"pl-k\">LIMIT</span> <span class=\"pl-c1\">20</span>\n) <span class=\"pl-k\">ORDER BY</span> embedding <span class=\"pl-k\">&lt;=&gt;</span> <span class=\"pl-s\"><span class=\"pl-pds\">'</span>[1,-2,3]<span class=\"pl-pds\">'</span></span> <span class=\"pl-k\">LIMIT</span> <span class=\"pl-c1\">5</span>;</pre></div>\n<div class=\"markdown-heading\" dir=\"auto\"><h2 class=\"heading-element\" dir=\"auto\" tabindex=\"-1\">Sparse Vectors</h2><a aria-label=\"Permalink: Sparse Vectors\" class=\"anchor\" href=\"https://github.com/pgvector/pgvector#sparse-vectors\" id=\"user-content-sparse-vectors\" target=\"_blank\"><svg aria-hidden=\"true\" class=\"octicon octicon-link\" height=\"16\" version=\"1.1\" viewbox=\"0 0 16 16\" width=\"16\"><path d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"></path></svg></a></div>\n<p dir=\"auto\">Use the <code>sparsevec</code> type to store sparse vectors</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"CREATE TABLE items (id bigserial PRIMARY KEY, embedding sparsevec(5));\" dir=\"auto\"><pre><span class=\"pl-k\">CREATE</span> <span class=\"pl-k\">TABLE</span> <span class=\"pl-en\">items</span> (id <span class=\"pl-k\">bigserial</span> <span class=\"pl-k\">PRIMARY KEY</span>, embedding sparsevec(<span class=\"pl-c1\">5</span>));</pre></div>\n<p dir=\"auto\">Insert vectors</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"INSERT INTO items (embedding) VALUES ('{1:1,3:2,5:3}/5'), ('{1:4,3:5,5:6}/5');\" dir=\"auto\"><pre><span class=\"pl-k\">INSERT INTO</span> items (embedding) <span class=\"pl-k\">VALUES</span> (<span class=\"pl-s\"><span class=\"pl-pds\">'</span>{1:1,3:2,5:3}/5<span class=\"pl-pds\">'</span></span>), (<span class=\"pl-s\"><span class=\"pl-pds\">'</span>{1:4,3:5,5:6}/5<span class=\"pl-pds\">'</span></span>);</pre></div>\n<p dir=\"auto\">The format is <code>{index1:value1,index2:value2}/dimensions</code> and indices start at 1 like SQL arrays</p>\n<p dir=\"auto\">Get the nearest neighbors by L2 distance</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"SELECT * FROM items ORDER BY embedding &lt;-&gt; '{1:3,3:1,5:2}/5' LIMIT 5;\" dir=\"auto\"><pre><span class=\"pl-k\">SELECT</span> <span class=\"pl-k\">*</span> <span class=\"pl-k\">FROM</span> items <span class=\"pl-k\">ORDER BY</span> embedding <span class=\"pl-k\">&lt;</span><span class=\"pl-k\">-</span><span class=\"pl-k\">&gt;</span> <span class=\"pl-s\"><span class=\"pl-pds\">'</span>{1:3,3:1,5:2}/5<span class=\"pl-pds\">'</span></span> <span class=\"pl-k\">LIMIT</span> <span class=\"pl-c1\">5</span>;</pre></div>\n<div class=\"markdown-heading\" dir=\"auto\"><h2 class=\"heading-element\" dir=\"auto\" tabindex=\"-1\">Hybrid Search</h2><a aria-label=\"Permalink: Hybrid Search\" class=\"anchor\" href=\"https://github.com/pgvector/pgvector#hybrid-search\" id=\"user-content-hybrid-search\" target=\"_blank\"><svg aria-hidden=\"true\" class=\"octicon octicon-link\" height=\"16\" version=\"1.1\" viewbox=\"0 0 16 16\" width=\"16\"><path d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"></path></svg></a></div>\n<p dir=\"auto\">Use together with Postgres <a href=\"https://www.postgresql.org/docs/current/textsearch-intro.html\" rel=\"nofollow\" target=\"_blank\">full-text search</a> for hybrid search.</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"SELECT id, content FROM items, plainto_tsquery('hello search') query\n    WHERE textsearch @@ query ORDER BY ts_rank_cd(textsearch, query) DESC LIMIT 5;\" dir=\"auto\"><pre><span class=\"pl-k\">SELECT</span> id, content <span class=\"pl-k\">FROM</span> items, plainto_tsquery(<span class=\"pl-s\"><span class=\"pl-pds\">'</span>hello search<span class=\"pl-pds\">'</span></span>) query\n    <span class=\"pl-k\">WHERE</span> textsearch @@ query <span class=\"pl-k\">ORDER BY</span> ts_rank_cd(textsearch, query) <span class=\"pl-k\">DESC</span> <span class=\"pl-k\">LIMIT</span> <span class=\"pl-c1\">5</span>;</pre></div>\n<p dir=\"auto\">You can use <a href=\"https://github.com/pgvector/pgvector-python/blob/master/examples/hybrid_search/rrf.py\" target=\"_blank\">Reciprocal Rank Fusion</a> or a <a href=\"https://github.com/pgvector/pgvector-python/blob/master/examples/hybrid_search/cross_encoder.py\" target=\"_blank\">cross-encoder</a> to combine results.</p>\n<div class=\"markdown-heading\" dir=\"auto\"><h2 class=\"heading-element\" dir=\"auto\" tabindex=\"-1\">Indexing Subvectors</h2><a aria-label=\"Permalink: Indexing Subvectors\" class=\"anchor\" href=\"https://github.com/pgvector/pgvector#indexing-subvectors\" id=\"user-content-indexing-subvectors\" target=\"_blank\"><svg aria-hidden=\"true\" class=\"octicon octicon-link\" height=\"16\" version=\"1.1\" viewbox=\"0 0 16 16\" width=\"16\"><path d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"></path></svg></a></div>\n<p dir=\"auto\">Use expression indexing to index subvectors</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"CREATE INDEX ON items USING hnsw ((subvector(embedding, 1, 3)::vector(3)) vector_cosine_ops);\" dir=\"auto\"><pre><span class=\"pl-k\">CREATE</span> <span class=\"pl-k\">INDEX</span> <span class=\"pl-en\">ON</span> items USING hnsw ((subvector(embedding, <span class=\"pl-c1\">1</span>, <span class=\"pl-c1\">3</span>)::vector(<span class=\"pl-c1\">3</span>)) vector_cosine_ops);</pre></div>\n<p dir=\"auto\">Get the nearest neighbors by cosine distance</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"SELECT * FROM items ORDER BY subvector(embedding, 1, 3)::vector(3) &lt;=&gt; subvector('[1,2,3,4,5]'::vector, 1, 3) LIMIT 5;\" dir=\"auto\"><pre><span class=\"pl-k\">SELECT</span> <span class=\"pl-k\">*</span> <span class=\"pl-k\">FROM</span> items <span class=\"pl-k\">ORDER BY</span> subvector(embedding, <span class=\"pl-c1\">1</span>, <span class=\"pl-c1\">3</span>)::vector(<span class=\"pl-c1\">3</span>) <span class=\"pl-k\">&lt;=&gt;</span> subvector(<span class=\"pl-s\"><span class=\"pl-pds\">'</span>[1,2,3,4,5]<span class=\"pl-pds\">'</span></span>::vector, <span class=\"pl-c1\">1</span>, <span class=\"pl-c1\">3</span>) <span class=\"pl-k\">LIMIT</span> <span class=\"pl-c1\">5</span>;</pre></div>\n<p dir=\"auto\">Re-rank by the full vectors for better recall</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"SELECT * FROM (\n    SELECT * FROM items ORDER BY subvector(embedding, 1, 3)::vector(3) &lt;=&gt; subvector('[1,2,3,4,5]'::vector, 1, 3) LIMIT 20\n) ORDER BY embedding &lt;=&gt; '[1,2,3,4,5]' LIMIT 5;\" dir=\"auto\"><pre><span class=\"pl-k\">SELECT</span> <span class=\"pl-k\">*</span> <span class=\"pl-k\">FROM</span> (\n    <span class=\"pl-k\">SELECT</span> <span class=\"pl-k\">*</span> <span class=\"pl-k\">FROM</span> items <span class=\"pl-k\">ORDER BY</span> subvector(embedding, <span class=\"pl-c1\">1</span>, <span class=\"pl-c1\">3</span>)::vector(<span class=\"pl-c1\">3</span>) <span class=\"pl-k\">&lt;=&gt;</span> subvector(<span class=\"pl-s\"><span class=\"pl-pds\">'</span>[1,2,3,4,5]<span class=\"pl-pds\">'</span></span>::vector, <span class=\"pl-c1\">1</span>, <span class=\"pl-c1\">3</span>) <span class=\"pl-k\">LIMIT</span> <span class=\"pl-c1\">20</span>\n) <span class=\"pl-k\">ORDER BY</span> embedding <span class=\"pl-k\">&lt;=&gt;</span> <span class=\"pl-s\"><span class=\"pl-pds\">'</span>[1,2,3,4,5]<span class=\"pl-pds\">'</span></span> <span class=\"pl-k\">LIMIT</span> <span class=\"pl-c1\">5</span>;</pre></div>\n<div class=\"markdown-heading\" dir=\"auto\"><h2 class=\"heading-element\" dir=\"auto\" tabindex=\"-1\">Performance</h2><a aria-label=\"Permalink: Performance\" class=\"anchor\" href=\"https://github.com/pgvector/pgvector#performance\" id=\"user-content-performance\" target=\"_blank\"><svg aria-hidden=\"true\" class=\"octicon octicon-link\" height=\"16\" version=\"1.1\" viewbox=\"0 0 16 16\" width=\"16\"><path d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"></path></svg></a></div>\n<div class=\"markdown-heading\" dir=\"auto\"><h3 class=\"heading-element\" dir=\"auto\" tabindex=\"-1\">Tuning</h3><a aria-label=\"Permalink: Tuning\" class=\"anchor\" href=\"https://github.com/pgvector/pgvector#tuning\" id=\"user-content-tuning\" target=\"_blank\"><svg aria-hidden=\"true\" class=\"octicon octicon-link\" height=\"16\" version=\"1.1\" viewbox=\"0 0 16 16\" width=\"16\"><path d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"></path></svg></a></div>\n<p dir=\"auto\">Use a tool like <a href=\"https://pgtune.leopard.in.ua/\" rel=\"nofollow\" target=\"_blank\">PgTune</a> to set initial values for Postgres server parameters. For instance, <code>shared_buffers</code> should typically be 25% of the server’s memory. You can find the config file with:</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"SHOW config_file;\" dir=\"auto\"><pre>SHOW config_file;</pre></div>\n<p dir=\"auto\">And check individual settings with:</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"SHOW shared_buffers;\" dir=\"auto\"><pre>SHOW shared_buffers;</pre></div>\n<p dir=\"auto\">Be sure to restart Postgres for changes to take effect.</p>\n<div class=\"markdown-heading\" dir=\"auto\"><h3 class=\"heading-element\" dir=\"auto\" tabindex=\"-1\">Loading</h3><a aria-label=\"Permalink: Loading\" class=\"anchor\" href=\"https://github.com/pgvector/pgvector#loading\" id=\"user-content-loading\" target=\"_blank\"><svg aria-hidden=\"true\" class=\"octicon octicon-link\" height=\"16\" version=\"1.1\" viewbox=\"0 0 16 16\" width=\"16\"><path d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"></path></svg></a></div>\n<p dir=\"auto\">Use <code>COPY</code> for bulk loading data (<a href=\"https://github.com/pgvector/pgvector-python/blob/master/examples/loading/example.py\" target=\"_blank\">example</a>).</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"COPY items (embedding) FROM STDIN WITH (FORMAT BINARY);\" dir=\"auto\"><pre>COPY items (embedding) <span class=\"pl-k\">FROM</span> STDIN WITH (FORMAT BINARY);</pre></div>\n<p dir=\"auto\">Add any indexes <em>after</em> loading the initial data for best performance.</p>\n<div class=\"markdown-heading\" dir=\"auto\"><h3 class=\"heading-element\" dir=\"auto\" tabindex=\"-1\">Indexing</h3><a aria-label=\"Permalink: Indexing\" class=\"anchor\" href=\"https://github.com/pgvector/pgvector#indexing-1\" id=\"user-content-indexing-1\" target=\"_blank\"><svg aria-hidden=\"true\" class=\"octicon octicon-link\" height=\"16\" version=\"1.1\" viewbox=\"0 0 16 16\" width=\"16\"><path d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"></path></svg></a></div>\n<p dir=\"auto\">See index build time for <a href=\"https://github.com/pgvector/pgvector#index-build-time\" target=\"_blank\">HNSW</a> and <a href=\"https://github.com/pgvector/pgvector#index-build-time-1\" target=\"_blank\">IVFFlat</a>.</p>\n<p dir=\"auto\">In production environments, create indexes concurrently to avoid blocking writes.</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"CREATE INDEX CONCURRENTLY ...\" dir=\"auto\"><pre><span class=\"pl-k\">CREATE</span> <span class=\"pl-k\">INDEX</span> <span class=\"pl-en\">CONCURRENTLY</span> ...</pre></div>\n<div class=\"markdown-heading\" dir=\"auto\"><h3 class=\"heading-element\" dir=\"auto\" tabindex=\"-1\">Querying</h3><a aria-label=\"Permalink: Querying\" class=\"anchor\" href=\"https://github.com/pgvector/pgvector#querying-1\" id=\"user-content-querying-1\" target=\"_blank\"><svg aria-hidden=\"true\" class=\"octicon octicon-link\" height=\"16\" version=\"1.1\" viewbox=\"0 0 16 16\" width=\"16\"><path d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"></path></svg></a></div>\n<p dir=\"auto\">Use <code>EXPLAIN (ANALYZE, BUFFERS)</code> to debug performance.</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"EXPLAIN (ANALYZE, BUFFERS) SELECT * FROM items ORDER BY embedding &lt;-&gt; '[3,1,2]' LIMIT 5;\" dir=\"auto\"><pre>EXPLAIN (ANALYZE, BUFFERS) <span class=\"pl-k\">SELECT</span> <span class=\"pl-k\">*</span> <span class=\"pl-k\">FROM</span> items <span class=\"pl-k\">ORDER BY</span> embedding <span class=\"pl-k\">&lt;</span><span class=\"pl-k\">-</span><span class=\"pl-k\">&gt;</span> <span class=\"pl-s\"><span class=\"pl-pds\">'</span>[3,1,2]<span class=\"pl-pds\">'</span></span> <span class=\"pl-k\">LIMIT</span> <span class=\"pl-c1\">5</span>;</pre></div>\n<div class=\"markdown-heading\" dir=\"auto\"><h4 class=\"heading-element\" dir=\"auto\" tabindex=\"-1\">Exact Search</h4><a aria-label=\"Permalink: Exact Search\" class=\"anchor\" href=\"https://github.com/pgvector/pgvector#exact-search\" id=\"user-content-exact-search\" target=\"_blank\"><svg aria-hidden=\"true\" class=\"octicon octicon-link\" height=\"16\" version=\"1.1\" viewbox=\"0 0 16 16\" width=\"16\"><path d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"></path></svg></a></div>\n<p dir=\"auto\">To speed up queries without an index, increase <code>max_parallel_workers_per_gather</code>.</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"SET max_parallel_workers_per_gather = 4;\" dir=\"auto\"><pre><span class=\"pl-k\">SET</span> max_parallel_workers_per_gather <span class=\"pl-k\">=</span> <span class=\"pl-c1\">4</span>;</pre></div>\n<p dir=\"auto\">If vectors are normalized to length 1 (like <a href=\"https://platform.openai.com/docs/guides/embeddings/which-distance-function-should-i-use\" rel=\"nofollow\" target=\"_blank\">OpenAI embeddings</a>), use inner product for best performance.</p>\n<div class=\"highlight highlight-source-tsql notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"SELECT * FROM items ORDER BY embedding &lt;#&gt; '[3,1,2]' LIMIT 5;\" dir=\"auto\"><pre><span class=\"pl-k\">SELECT</span> <span class=\"pl-k\">*</span> <span class=\"pl-k\">FROM</span> items <span class=\"pl-k\">ORDER BY</span> embedding <span class=\"pl-k\">&lt;</span>#<span class=\"pl-k\">&gt;</span> <span class=\"pl-s\"><span class=\"pl-pds\">'</span>[3,1,2]'</span> <span class=\"pl-k\">LIMIT</span> <span class=\"pl-c1\">5</span>;</pre></div>\n<div class=\"markdown-heading\" dir=\"auto\"><h4 class=\"heading-element\" dir=\"auto\" tabindex=\"-1\">Approximate Search</h4><a aria-label=\"Permalink: Approximate Search\" class=\"anchor\" href=\"https://github.com/pgvector/pgvector#approximate-search\" id=\"user-content-approximate-search\" target=\"_blank\"><svg aria-hidden=\"true\" class=\"octicon octicon-link\" height=\"16\" version=\"1.1\" viewbox=\"0 0 16 16\" width=\"16\"><path d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"></path></svg></a></div>\n<p dir=\"auto\">To speed up queries with an IVFFlat index, increase the number of inverted lists (at the expense of recall).</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"CREATE INDEX ON items USING ivfflat (embedding vector_l2_ops) WITH (lists = 1000);\" dir=\"auto\"><pre><span class=\"pl-k\">CREATE</span> <span class=\"pl-k\">INDEX</span> <span class=\"pl-en\">ON</span> items USING ivfflat (embedding vector_l2_ops) WITH (lists <span class=\"pl-k\">=</span> <span class=\"pl-c1\">1000</span>);</pre></div>\n<div class=\"markdown-heading\" dir=\"auto\"><h3 class=\"heading-element\" dir=\"auto\" tabindex=\"-1\">Vacuuming</h3><a aria-label=\"Permalink: Vacuuming\" class=\"anchor\" href=\"https://github.com/pgvector/pgvector#vacuuming\" id=\"user-content-vacuuming\" target=\"_blank\"><svg aria-hidden=\"true\" class=\"octicon octicon-link\" height=\"16\" version=\"1.1\" viewbox=\"0 0 16 16\" width=\"16\"><path d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"></path></svg></a></div>\n<p dir=\"auto\">Vacuuming can take a while for HNSW indexes. Speed it up by reindexing first.</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"REINDEX INDEX CONCURRENTLY index_name;\nVACUUM table_name;\" dir=\"auto\"><pre>REINDEX INDEX CONCURRENTLY index_name;\nVACUUM table_name;</pre></div>\n<div class=\"markdown-heading\" dir=\"auto\"><h2 class=\"heading-element\" dir=\"auto\" tabindex=\"-1\">Monitoring</h2><a aria-label=\"Permalink: Monitoring\" class=\"anchor\" href=\"https://github.com/pgvector/pgvector#monitoring\" id=\"user-content-monitoring\" target=\"_blank\"><svg aria-hidden=\"true\" class=\"octicon octicon-link\" height=\"16\" version=\"1.1\" viewbox=\"0 0 16 16\" width=\"16\"><path d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"></path></svg></a></div>\n<p dir=\"auto\">Monitor performance with <a href=\"https://www.postgresql.org/docs/current/pgstatstatements.html\" rel=\"nofollow\" target=\"_blank\">pg_stat_statements</a> (be sure to add it to <code>shared_preload_libraries</code>).</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"CREATE EXTENSION pg_stat_statements;\" dir=\"auto\"><pre>CREATE EXTENSION pg_stat_statements;</pre></div>\n<p dir=\"auto\">Get the most time-consuming queries with:</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"SELECT query, calls, ROUND((total_plan_time + total_exec_time) / calls) AS avg_time_ms,\n    ROUND((total_plan_time + total_exec_time) / 60000) AS total_time_min\n    FROM pg_stat_statements ORDER BY total_plan_time + total_exec_time DESC LIMIT 20;\" dir=\"auto\"><pre><span class=\"pl-k\">SELECT</span> query, calls, ROUND((total_plan_time <span class=\"pl-k\">+</span> total_exec_time) <span class=\"pl-k\">/</span> calls) <span class=\"pl-k\">AS</span> avg_time_ms,\n    ROUND((total_plan_time <span class=\"pl-k\">+</span> total_exec_time) <span class=\"pl-k\">/</span> <span class=\"pl-c1\">60000</span>) <span class=\"pl-k\">AS</span> total_time_min\n    <span class=\"pl-k\">FROM</span> pg_stat_statements <span class=\"pl-k\">ORDER BY</span> total_plan_time <span class=\"pl-k\">+</span> total_exec_time <span class=\"pl-k\">DESC</span> <span class=\"pl-k\">LIMIT</span> <span class=\"pl-c1\">20</span>;</pre></div>\n<p dir=\"auto\">Monitor recall by comparing results from approximate search with exact search.</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"BEGIN;\nSET LOCAL enable_indexscan = off; -- use exact search\nSELECT ...\nCOMMIT;\" dir=\"auto\"><pre><span class=\"pl-k\">BEGIN</span>;\n<span class=\"pl-k\">SET</span> LOCAL enable_indexscan <span class=\"pl-k\">=</span> off; <span class=\"pl-c\"><span class=\"pl-c\">--</span> use exact search</span>\n<span class=\"pl-k\">SELECT</span> ...\n<span class=\"pl-k\">COMMIT</span>;</pre></div>\n<div class=\"markdown-heading\" dir=\"auto\"><h2 class=\"heading-element\" dir=\"auto\" tabindex=\"-1\">Scaling</h2><a aria-label=\"Permalink: Scaling\" class=\"anchor\" href=\"https://github.com/pgvector/pgvector#scaling\" id=\"user-content-scaling\" target=\"_blank\"><svg aria-hidden=\"true\" class=\"octicon octicon-link\" height=\"16\" version=\"1.1\" viewbox=\"0 0 16 16\" width=\"16\"><path d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"></path></svg></a></div>\n<p dir=\"auto\">Scale pgvector the same way you scale Postgres.</p>\n<p dir=\"auto\">Scale vertically by increasing memory, CPU, and storage on a single instance. Use existing tools to <a href=\"https://github.com/pgvector/pgvector#tuning\" target=\"_blank\">tune parameters</a> and <a href=\"https://github.com/pgvector/pgvector#monitoring\" target=\"_blank\">monitor performance</a>.</p>\n<p dir=\"auto\">Scale horizontally with <a href=\"https://www.postgresql.org/docs/current/hot-standby.html\" rel=\"nofollow\" target=\"_blank\">replicas</a>, or use <a href=\"https://github.com/citusdata/citus\" target=\"_blank\">Citus</a> or another approach for sharding (<a href=\"https://github.com/pgvector/pgvector-python/blob/master/examples/citus/example.py\" target=\"_blank\">example</a>).</p>\n<div class=\"markdown-heading\" dir=\"auto\"><h2 class=\"heading-element\" dir=\"auto\" tabindex=\"-1\">Languages</h2><a aria-label=\"Permalink: Languages\" class=\"anchor\" href=\"https://github.com/pgvector/pgvector#languages\" id=\"user-content-languages\" target=\"_blank\"><svg aria-hidden=\"true\" class=\"octicon octicon-link\" height=\"16\" version=\"1.1\" viewbox=\"0 0 16 16\" width=\"16\"><path d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"></path></svg></a></div>\n<p dir=\"auto\">Use pgvector from any language with a Postgres client. You can even generate and store vectors in one language and query them in another.</p>\n<markdown-accessiblity-table><table>\n<thead>\n<tr>\n<th>Language</th>\n<th>Libraries / Examples</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>Ada</td>\n<td><a href=\"https://github.com/pgvector/pgvector-ada\" target=\"_blank\">pgvector-ada</a></td>\n</tr>\n<tr>\n<td>Algol</td>\n<td><a href=\"https://github.com/pgvector/pgvector-algol\" target=\"_blank\">pgvector-algol</a></td>\n</tr>\n<tr>\n<td>C</td>\n<td><a href=\"https://github.com/pgvector/pgvector-c\" target=\"_blank\">pgvector-c</a></td>\n</tr>\n<tr>\n<td>C++</td>\n<td><a href=\"https://github.com/pgvector/pgvector-cpp\" target=\"_blank\">pgvector-cpp</a></td>\n</tr>\n<tr>\n<td>C#, F#, Visual Basic</td>\n<td><a href=\"https://github.com/pgvector/pgvector-dotnet\" target=\"_blank\">pgvector-dotnet</a></td>\n</tr>\n<tr>\n<td>COBOL</td>\n<td><a href=\"https://github.com/pgvector/pgvector-cobol\" target=\"_blank\">pgvector-cobol</a></td>\n</tr>\n<tr>\n<td>Crystal</td>\n<td><a href=\"https://github.com/pgvector/pgvector-crystal\" target=\"_blank\">pgvector-crystal</a></td>\n</tr>\n<tr>\n<td>D</td>\n<td><a href=\"https://github.com/pgvector/pgvector-d\" target=\"_blank\">pgvector-d</a></td>\n</tr>\n<tr>\n<td>Dart</td>\n<td><a href=\"https://github.com/pgvector/pgvector-dart\" target=\"_blank\">pgvector-dart</a></td>\n</tr>\n<tr>\n<td>Elixir</td>\n<td><a href=\"https://github.com/pgvector/pgvector-elixir\" target=\"_blank\">pgvector-elixir</a></td>\n</tr>\n<tr>\n<td>Erlang</td>\n<td><a href=\"https://github.com/pgvector/pgvector-erlang\" target=\"_blank\">pgvector-erlang</a></td>\n</tr>\n<tr>\n<td>Fortran</td>\n<td><a href=\"https://github.com/pgvector/pgvector-fortran\" target=\"_blank\">pgvector-fortran</a></td>\n</tr>\n<tr>\n<td>Gleam</td>\n<td><a href=\"https://github.com/pgvector/pgvector-gleam\" target=\"_blank\">pgvector-gleam</a></td>\n</tr>\n<tr>\n<td>Go</td>\n<td><a href=\"https://github.com/pgvector/pgvector-go\" target=\"_blank\">pgvector-go</a></td>\n</tr>\n<tr>\n<td>Haskell</td>\n<td><a href=\"https://github.com/pgvector/pgvector-haskell\" target=\"_blank\">pgvector-haskell</a></td>\n</tr>\n<tr>\n<td>Java, Kotlin, Groovy, Scala</td>\n<td><a href=\"https://github.com/pgvector/pgvector-java\" target=\"_blank\">pgvector-java</a></td>\n</tr>\n<tr>\n<td>JavaScript, TypeScript</td>\n<td><a href=\"https://github.com/pgvector/pgvector-node\" target=\"_blank\">pgvector-node</a></td>\n</tr>\n<tr>\n<td>Julia</td>\n<td><a href=\"https://github.com/pgvector/Pgvector.jl\" target=\"_blank\">Pgvector.jl</a></td>\n</tr>\n<tr>\n<td>Lisp</td>\n<td><a href=\"https://github.com/pgvector/pgvector-lisp\" target=\"_blank\">pgvector-lisp</a></td>\n</tr>\n<tr>\n<td>Lua</td>\n<td><a href=\"https://github.com/pgvector/pgvector-lua\" target=\"_blank\">pgvector-lua</a></td>\n</tr>\n<tr>\n<td>Nim</td>\n<td><a href=\"https://github.com/pgvector/pgvector-nim\" target=\"_blank\">pgvector-nim</a></td>\n</tr>\n<tr>\n<td>OCaml</td>\n<td><a href=\"https://github.com/pgvector/pgvector-ocaml\" target=\"_blank\">pgvector-ocaml</a></td>\n</tr>\n<tr>\n<td>Pascal</td>\n<td><a href=\"https://github.com/pgvector/pgvector-pascal\" target=\"_blank\">pgvector-pascal</a></td>\n</tr>\n<tr>\n<td>Perl</td>\n<td><a href=\"https://github.com/pgvector/pgvector-perl\" target=\"_blank\">pgvector-perl</a></td>\n</tr>\n<tr>\n<td>PHP</td>\n<td><a href=\"https://github.com/pgvector/pgvector-php\" target=\"_blank\">pgvector-php</a></td>\n</tr>\n<tr>\n<td>Prolog</td>\n<td><a href=\"https://github.com/pgvector/pgvector-prolog\" target=\"_blank\">pgvector-prolog</a></td>\n</tr>\n<tr>\n<td>Python</td>\n<td><a href=\"https://github.com/pgvector/pgvector-python\" target=\"_blank\">pgvector-python</a></td>\n</tr>\n<tr>\n<td>R</td>\n<td><a href=\"https://github.com/pgvector/pgvector-r\" target=\"_blank\">pgvector-r</a></td>\n</tr>\n<tr>\n<td>Racket</td>\n<td><a href=\"https://github.com/pgvector/pgvector-racket\" target=\"_blank\">pgvector-racket</a></td>\n</tr>\n<tr>\n<td>Raku</td>\n<td><a href=\"https://github.com/pgvector/pgvector-raku\" target=\"_blank\">pgvector-raku</a></td>\n</tr>\n<tr>\n<td>Ruby</td>\n<td><a href=\"https://github.com/pgvector/pgvector-ruby\" target=\"_blank\">pgvector-ruby</a>, <a href=\"https://github.com/ankane/neighbor\" target=\"_blank\">Neighbor</a></td>\n</tr>\n<tr>\n<td>Rust</td>\n<td><a href=\"https://github.com/pgvector/pgvector-rust\" target=\"_blank\">pgvector-rust</a></td>\n</tr>\n<tr>\n<td>Swift</td>\n<td><a href=\"https://github.com/pgvector/pgvector-swift\" target=\"_blank\">pgvector-swift</a></td>\n</tr>\n<tr>\n<td>Tcl</td>\n<td><a href=\"https://github.com/pgvector/pgvector-tcl\" target=\"_blank\">pgvector-tcl</a></td>\n</tr>\n<tr>\n<td>Zig</td>\n<td><a href=\"https://github.com/pgvector/pgvector-zig\" target=\"_blank\">pgvector-zig</a></td>\n</tr>\n</tbody>\n</table></markdown-accessiblity-table>\n<div class=\"markdown-heading\" dir=\"auto\"><h2 class=\"heading-element\" dir=\"auto\" tabindex=\"-1\">Frequently Asked Questions</h2><a aria-label=\"Permalink: Frequently Asked Questions\" class=\"anchor\" href=\"https://github.com/pgvector/pgvector#frequently-asked-questions\" id=\"user-content-frequently-asked-questions\" target=\"_blank\"><svg aria-hidden=\"true\" class=\"octicon octicon-link\" height=\"16\" version=\"1.1\" viewbox=\"0 0 16 16\" width=\"16\"><path d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"></path></svg></a></div>\n<div class=\"markdown-heading\" dir=\"auto\"><h4 class=\"heading-element\" dir=\"auto\" tabindex=\"-1\">How many vectors can be stored in a single table?</h4><a aria-label=\"Permalink: How many vectors can be stored in a single table?\" class=\"anchor\" href=\"https://github.com/pgvector/pgvector#how-many-vectors-can-be-stored-in-a-single-table\" id=\"user-content-how-many-vectors-can-be-stored-in-a-single-table\" target=\"_blank\"><svg aria-hidden=\"true\" class=\"octicon octicon-link\" height=\"16\" version=\"1.1\" viewbox=\"0 0 16 16\" width=\"16\"><path d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"></path></svg></a></div>\n<p dir=\"auto\">A non-partitioned table has a limit of 32 TB by default in Postgres. A partitioned table can have thousands of partitions of that size.</p>\n<div class=\"markdown-heading\" dir=\"auto\"><h4 class=\"heading-element\" dir=\"auto\" tabindex=\"-1\">Is replication supported?</h4><a aria-label=\"Permalink: Is replication supported?\" class=\"anchor\" href=\"https://github.com/pgvector/pgvector#is-replication-supported\" id=\"user-content-is-replication-supported\" target=\"_blank\"><svg aria-hidden=\"true\" class=\"octicon octicon-link\" height=\"16\" version=\"1.1\" viewbox=\"0 0 16 16\" width=\"16\"><path d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"></path></svg></a></div>\n<p dir=\"auto\">Yes, pgvector uses the write-ahead log (WAL), which allows for replication and point-in-time recovery.</p>\n<div class=\"markdown-heading\" dir=\"auto\"><h4 class=\"heading-element\" dir=\"auto\" tabindex=\"-1\">What if I want to index vectors with more than 2,000 dimensions?</h4><a aria-label=\"Permalink: What if I want to index vectors with more than 2,000 dimensions?\" class=\"anchor\" href=\"https://github.com/pgvector/pgvector#what-if-i-want-to-index-vectors-with-more-than-2000-dimensions\" id=\"user-content-what-if-i-want-to-index-vectors-with-more-than-2000-dimensions\" target=\"_blank\"><svg aria-hidden=\"true\" class=\"octicon octicon-link\" height=\"16\" version=\"1.1\" viewbox=\"0 0 16 16\" width=\"16\"><path d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"></path></svg></a></div>\n<p dir=\"auto\">You can use <a href=\"https://github.com/pgvector/pgvector#half-precision-vectors\" target=\"_blank\">half-precision vectors</a> or <a href=\"https://github.com/pgvector/pgvector#half-precision-indexing\" target=\"_blank\">half-precision indexing</a> to index up to 4,000 dimensions or <a href=\"https://github.com/pgvector/pgvector#binary-quantization\" target=\"_blank\">binary quantization</a> to index up to 64,000 dimensions. Other options are <a href=\"https://github.com/pgvector/pgvector#indexing-subvectors\" target=\"_blank\">indexing subvectors</a> (for models that support it) or <a href=\"https://en.wikipedia.org/wiki/Dimensionality_reduction\" rel=\"nofollow\" target=\"_blank\">dimensionality reduction</a>.</p>\n<div class=\"markdown-heading\" dir=\"auto\"><h4 class=\"heading-element\" dir=\"auto\" tabindex=\"-1\">Can I store vectors with different dimensions in the same column?</h4><a aria-label=\"Permalink: Can I store vectors with different dimensions in the same column?\" class=\"anchor\" href=\"https://github.com/pgvector/pgvector#can-i-store-vectors-with-different-dimensions-in-the-same-column\" id=\"user-content-can-i-store-vectors-with-different-dimensions-in-the-same-column\" target=\"_blank\"><svg aria-hidden=\"true\" class=\"octicon octicon-link\" height=\"16\" version=\"1.1\" viewbox=\"0 0 16 16\" width=\"16\"><path d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"></path></svg></a></div>\n<p dir=\"auto\">You can use <code>vector</code> as the type (instead of <code>vector(n)</code>).</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"CREATE TABLE embeddings (model_id bigint, item_id bigint, embedding vector, PRIMARY KEY (model_id, item_id));\" dir=\"auto\"><pre><span class=\"pl-k\">CREATE</span> <span class=\"pl-k\">TABLE</span> <span class=\"pl-en\">embeddings</span> (model_id <span class=\"pl-k\">bigint</span>, item_id <span class=\"pl-k\">bigint</span>, embedding vector, <span class=\"pl-k\">PRIMARY KEY</span> (model_id, item_id));</pre></div>\n<p dir=\"auto\">However, you can only create indexes on rows with the same number of dimensions (using <a href=\"https://www.postgresql.org/docs/current/indexes-expressional.html\" rel=\"nofollow\" target=\"_blank\">expression</a> and <a href=\"https://www.postgresql.org/docs/current/indexes-partial.html\" rel=\"nofollow\" target=\"_blank\">partial</a> indexing):</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"CREATE INDEX ON embeddings USING hnsw ((embedding::vector(3)) vector_l2_ops) WHERE (model_id = 123);\" dir=\"auto\"><pre><span class=\"pl-k\">CREATE</span> <span class=\"pl-k\">INDEX</span> <span class=\"pl-en\">ON</span> embeddings USING hnsw ((embedding::vector(<span class=\"pl-c1\">3</span>)) vector_l2_ops) <span class=\"pl-k\">WHERE</span> (model_id <span class=\"pl-k\">=</span> <span class=\"pl-c1\">123</span>);</pre></div>\n<p dir=\"auto\">and query with:</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"SELECT * FROM embeddings WHERE model_id = 123 ORDER BY embedding::vector(3) &lt;-&gt; '[3,1,2]' LIMIT 5;\" dir=\"auto\"><pre><span class=\"pl-k\">SELECT</span> <span class=\"pl-k\">*</span> <span class=\"pl-k\">FROM</span> embeddings <span class=\"pl-k\">WHERE</span> model_id <span class=\"pl-k\">=</span> <span class=\"pl-c1\">123</span> <span class=\"pl-k\">ORDER BY</span> embedding::vector(<span class=\"pl-c1\">3</span>) <span class=\"pl-k\">&lt;</span><span class=\"pl-k\">-</span><span class=\"pl-k\">&gt;</span> <span class=\"pl-s\"><span class=\"pl-pds\">'</span>[3,1,2]<span class=\"pl-pds\">'</span></span> <span class=\"pl-k\">LIMIT</span> <span class=\"pl-c1\">5</span>;</pre></div>\n<div class=\"markdown-heading\" dir=\"auto\"><h4 class=\"heading-element\" dir=\"auto\" tabindex=\"-1\">Can I store vectors with more precision?</h4><a aria-label=\"Permalink: Can I store vectors with more precision?\" class=\"anchor\" href=\"https://github.com/pgvector/pgvector#can-i-store-vectors-with-more-precision\" id=\"user-content-can-i-store-vectors-with-more-precision\" target=\"_blank\"><svg aria-hidden=\"true\" class=\"octicon octicon-link\" height=\"16\" version=\"1.1\" viewbox=\"0 0 16 16\" width=\"16\"><path d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"></path></svg></a></div>\n<p dir=\"auto\">You can use the <code>double precision[]</code> or <code>numeric[]</code> type to store vectors with more precision.</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"CREATE TABLE items (id bigserial PRIMARY KEY, embedding double precision[]);\n\n-- use {} instead of [] for Postgres arrays\nINSERT INTO items (embedding) VALUES ('{1,2,3}'), ('{4,5,6}');\" dir=\"auto\"><pre><span class=\"pl-k\">CREATE</span> <span class=\"pl-k\">TABLE</span> <span class=\"pl-en\">items</span> (id <span class=\"pl-k\">bigserial</span> <span class=\"pl-k\">PRIMARY KEY</span>, embedding <span class=\"pl-k\">double precision</span>[]);\n\n<span class=\"pl-c\"><span class=\"pl-c\">--</span> use {} instead of [] for Postgres arrays</span>\n<span class=\"pl-k\">INSERT INTO</span> items (embedding) <span class=\"pl-k\">VALUES</span> (<span class=\"pl-s\"><span class=\"pl-pds\">'</span>{1,2,3}<span class=\"pl-pds\">'</span></span>), (<span class=\"pl-s\"><span class=\"pl-pds\">'</span>{4,5,6}<span class=\"pl-pds\">'</span></span>);</pre></div>\n<p dir=\"auto\">Optionally, add a <a href=\"https://www.postgresql.org/docs/current/ddl-constraints.html\" rel=\"nofollow\" target=\"_blank\">check constraint</a> to ensure data can be converted to the <code>vector</code> type and has the expected dimensions.</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"ALTER TABLE items ADD CHECK (vector_dims(embedding::vector) = 3);\" dir=\"auto\"><pre><span class=\"pl-k\">ALTER</span> <span class=\"pl-k\">TABLE</span> items ADD <span class=\"pl-k\">CHECK</span> (vector_dims(embedding::vector) <span class=\"pl-k\">=</span> <span class=\"pl-c1\">3</span>);</pre></div>\n<p dir=\"auto\">Use <a href=\"https://www.postgresql.org/docs/current/indexes-expressional.html\" rel=\"nofollow\" target=\"_blank\">expression indexing</a> to index (at a lower precision):</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"CREATE INDEX ON items USING hnsw ((embedding::vector(3)) vector_l2_ops);\" dir=\"auto\"><pre><span class=\"pl-k\">CREATE</span> <span class=\"pl-k\">INDEX</span> <span class=\"pl-en\">ON</span> items USING hnsw ((embedding::vector(<span class=\"pl-c1\">3</span>)) vector_l2_ops);</pre></div>\n<p dir=\"auto\">and query with:</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"SELECT * FROM items ORDER BY embedding::vector(3) &lt;-&gt; '[3,1,2]' LIMIT 5;\" dir=\"auto\"><pre><span class=\"pl-k\">SELECT</span> <span class=\"pl-k\">*</span> <span class=\"pl-k\">FROM</span> items <span class=\"pl-k\">ORDER BY</span> embedding::vector(<span class=\"pl-c1\">3</span>) <span class=\"pl-k\">&lt;</span><span class=\"pl-k\">-</span><span class=\"pl-k\">&gt;</span> <span class=\"pl-s\"><span class=\"pl-pds\">'</span>[3,1,2]<span class=\"pl-pds\">'</span></span> <span class=\"pl-k\">LIMIT</span> <span class=\"pl-c1\">5</span>;</pre></div>\n<div class=\"markdown-heading\" dir=\"auto\"><h4 class=\"heading-element\" dir=\"auto\" tabindex=\"-1\">Do indexes need to fit into memory?</h4><a aria-label=\"Permalink: Do indexes need to fit into memory?\" class=\"anchor\" href=\"https://github.com/pgvector/pgvector#do-indexes-need-to-fit-into-memory\" id=\"user-content-do-indexes-need-to-fit-into-memory\" target=\"_blank\"><svg aria-hidden=\"true\" class=\"octicon octicon-link\" height=\"16\" version=\"1.1\" viewbox=\"0 0 16 16\" width=\"16\"><path d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"></path></svg></a></div>\n<p dir=\"auto\">No, but like other index types, you’ll likely see better performance if they do. You can get the size of an index with:</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"SELECT pg_size_pretty(pg_relation_size('index_name'));\" dir=\"auto\"><pre><span class=\"pl-k\">SELECT</span> pg_size_pretty(pg_relation_size(<span class=\"pl-s\"><span class=\"pl-pds\">'</span>index_name<span class=\"pl-pds\">'</span></span>));</pre></div>\n<div class=\"markdown-heading\" dir=\"auto\"><h2 class=\"heading-element\" dir=\"auto\" tabindex=\"-1\">Troubleshooting</h2><a aria-label=\"Permalink: Troubleshooting\" class=\"anchor\" href=\"https://github.com/pgvector/pgvector#troubleshooting\" id=\"user-content-troubleshooting\" target=\"_blank\"><svg aria-hidden=\"true\" class=\"octicon octicon-link\" height=\"16\" version=\"1.1\" viewbox=\"0 0 16 16\" width=\"16\"><path d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"></path></svg></a></div>\n<div class=\"markdown-heading\" dir=\"auto\"><h4 class=\"heading-element\" dir=\"auto\" tabindex=\"-1\">Why isn’t a query using an index?</h4><a aria-label=\"Permalink: Why isn’t a query using an index?\" class=\"anchor\" href=\"https://github.com/pgvector/pgvector#why-isnt-a-query-using-an-index\" id=\"user-content-why-isnt-a-query-using-an-index\" target=\"_blank\"><svg aria-hidden=\"true\" class=\"octicon octicon-link\" height=\"16\" version=\"1.1\" viewbox=\"0 0 16 16\" width=\"16\"><path d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"></path></svg></a></div>\n<p dir=\"auto\">The query needs to have an <code>ORDER BY</code> and <code>LIMIT</code>, and the <code>ORDER BY</code> must be the result of a distance operator (not an expression) in ascending order.</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"-- index\nORDER BY embedding &lt;=&gt; '[3,1,2]' LIMIT 5;\n\n-- no index\nORDER BY 1 - (embedding &lt;=&gt; '[3,1,2]') DESC LIMIT 5;\" dir=\"auto\"><pre><span class=\"pl-c\"><span class=\"pl-c\">--</span> index</span>\n<span class=\"pl-k\">ORDER BY</span> embedding <span class=\"pl-k\">&lt;=&gt;</span> <span class=\"pl-s\"><span class=\"pl-pds\">'</span>[3,1,2]<span class=\"pl-pds\">'</span></span> <span class=\"pl-k\">LIMIT</span> <span class=\"pl-c1\">5</span>;\n\n<span class=\"pl-c\"><span class=\"pl-c\">--</span> no index</span>\n<span class=\"pl-k\">ORDER BY</span> <span class=\"pl-c1\">1</span> <span class=\"pl-k\">-</span> (embedding <span class=\"pl-k\">&lt;=&gt;</span> <span class=\"pl-s\"><span class=\"pl-pds\">'</span>[3,1,2]<span class=\"pl-pds\">'</span></span>) <span class=\"pl-k\">DESC</span> <span class=\"pl-k\">LIMIT</span> <span class=\"pl-c1\">5</span>;</pre></div>\n<p dir=\"auto\">You can encourage the planner to use an index for a query with:</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"BEGIN;\nSET LOCAL enable_seqscan = off;\nSELECT ...\nCOMMIT;\" dir=\"auto\"><pre><span class=\"pl-k\">BEGIN</span>;\n<span class=\"pl-k\">SET</span> LOCAL enable_seqscan <span class=\"pl-k\">=</span> off;\n<span class=\"pl-k\">SELECT</span> ...\n<span class=\"pl-k\">COMMIT</span>;</pre></div>\n<p dir=\"auto\">Also, if the table is small, a table scan may be faster.</p>\n<div class=\"markdown-heading\" dir=\"auto\"><h4 class=\"heading-element\" dir=\"auto\" tabindex=\"-1\">Why isn’t a query using a parallel table scan?</h4><a aria-label=\"Permalink: Why isn’t a query using a parallel table scan?\" class=\"anchor\" href=\"https://github.com/pgvector/pgvector#why-isnt-a-query-using-a-parallel-table-scan\" id=\"user-content-why-isnt-a-query-using-a-parallel-table-scan\" target=\"_blank\"><svg aria-hidden=\"true\" class=\"octicon octicon-link\" height=\"16\" version=\"1.1\" viewbox=\"0 0 16 16\" width=\"16\"><path d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"></path></svg></a></div>\n<p dir=\"auto\">The planner doesn’t consider <a href=\"https://www.postgresql.org/docs/current/storage-toast.html\" rel=\"nofollow\" target=\"_blank\">out-of-line storage</a> in cost estimates, which can make a serial scan look cheaper. You can reduce the cost of a parallel scan for a query with:</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"BEGIN;\nSET LOCAL min_parallel_table_scan_size = 1;\nSET LOCAL parallel_setup_cost = 1;\nSELECT ...\nCOMMIT;\" dir=\"auto\"><pre><span class=\"pl-k\">BEGIN</span>;\n<span class=\"pl-k\">SET</span> LOCAL min_parallel_table_scan_size <span class=\"pl-k\">=</span> <span class=\"pl-c1\">1</span>;\n<span class=\"pl-k\">SET</span> LOCAL parallel_setup_cost <span class=\"pl-k\">=</span> <span class=\"pl-c1\">1</span>;\n<span class=\"pl-k\">SELECT</span> ...\n<span class=\"pl-k\">COMMIT</span>;</pre></div>\n<p dir=\"auto\">or choose to store vectors inline:</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"ALTER TABLE items ALTER COLUMN embedding SET STORAGE PLAIN;\" dir=\"auto\"><pre><span class=\"pl-k\">ALTER</span> <span class=\"pl-k\">TABLE</span> items ALTER COLUMN embedding <span class=\"pl-k\">SET</span> STORAGE PLAIN;</pre></div>\n<div class=\"markdown-heading\" dir=\"auto\"><h4 class=\"heading-element\" dir=\"auto\" tabindex=\"-1\">Why are there less results for a query after adding an HNSW index?</h4><a aria-label=\"Permalink: Why are there less results for a query after adding an HNSW index?\" class=\"anchor\" href=\"https://github.com/pgvector/pgvector#why-are-there-less-results-for-a-query-after-adding-an-hnsw-index\" id=\"user-content-why-are-there-less-results-for-a-query-after-adding-an-hnsw-index\" target=\"_blank\"><svg aria-hidden=\"true\" class=\"octicon octicon-link\" height=\"16\" version=\"1.1\" viewbox=\"0 0 16 16\" width=\"16\"><path d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"></path></svg></a></div>\n<p dir=\"auto\">Results are limited by the size of the dynamic candidate list (<code>hnsw.ef_search</code>), which is 40 by default. There may be even less results due to dead tuples or filtering conditions in the query. Enabling <a href=\"https://github.com/pgvector/pgvector#iterative-index-scans\" target=\"_blank\">iterative index scans</a> can help address this.</p>\n<p dir=\"auto\">Also, note that <code>NULL</code> vectors are not indexed (as well as zero vectors for cosine distance).</p>\n<div class=\"markdown-heading\" dir=\"auto\"><h4 class=\"heading-element\" dir=\"auto\" tabindex=\"-1\">Why are there less results for a query after adding an IVFFlat index?</h4><a aria-label=\"Permalink: Why are there less results for a query after adding an IVFFlat index?\" class=\"anchor\" href=\"https://github.com/pgvector/pgvector#why-are-there-less-results-for-a-query-after-adding-an-ivfflat-index\" id=\"user-content-why-are-there-less-results-for-a-query-after-adding-an-ivfflat-index\" target=\"_blank\"><svg aria-hidden=\"true\" class=\"octicon octicon-link\" height=\"16\" version=\"1.1\" viewbox=\"0 0 16 16\" width=\"16\"><path d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"></path></svg></a></div>\n<p dir=\"auto\">The index was likely created with too little data for the number of lists. Drop the index until the table has more data.</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"DROP INDEX index_name;\" dir=\"auto\"><pre><span class=\"pl-k\">DROP</span> <span class=\"pl-k\">INDEX</span> index_name;</pre></div>\n<p dir=\"auto\">Results can also be limited by the number of probes (<code>ivfflat.probes</code>). Enabling <a href=\"https://github.com/pgvector/pgvector#iterative-index-scans\" target=\"_blank\">iterative index scans</a> can address this.</p>\n<p dir=\"auto\">Also, note that <code>NULL</code> vectors are not indexed (as well as zero vectors for cosine distance).</p>\n<div class=\"markdown-heading\" dir=\"auto\"><h2 class=\"heading-element\" dir=\"auto\" tabindex=\"-1\">Reference</h2><a aria-label=\"Permalink: Reference\" class=\"anchor\" href=\"https://github.com/pgvector/pgvector#reference\" id=\"user-content-reference\" target=\"_blank\"><svg aria-hidden=\"true\" class=\"octicon octicon-link\" height=\"16\" version=\"1.1\" viewbox=\"0 0 16 16\" width=\"16\"><path d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"></path></svg></a></div>\n<ul dir=\"auto\">\n<li><a href=\"https://github.com/pgvector/pgvector#vector-type\" target=\"_blank\">Vector</a></li>\n<li><a href=\"https://github.com/pgvector/pgvector#halfvec-type\" target=\"_blank\">Halfvec</a></li>\n<li><a href=\"https://github.com/pgvector/pgvector#bit-type\" target=\"_blank\">Bit</a></li>\n<li><a href=\"https://github.com/pgvector/pgvector#sparsevec-type\" target=\"_blank\">Sparsevec</a></li>\n</ul>\n<div class=\"markdown-heading\" dir=\"auto\"><h3 class=\"heading-element\" dir=\"auto\" tabindex=\"-1\">Vector Type</h3><a aria-label=\"Permalink: Vector Type\" class=\"anchor\" href=\"https://github.com/pgvector/pgvector#vector-type\" id=\"user-content-vector-type\" target=\"_blank\"><svg aria-hidden=\"true\" class=\"octicon octicon-link\" height=\"16\" version=\"1.1\" viewbox=\"0 0 16 16\" width=\"16\"><path d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"></path></svg></a></div>\n<p dir=\"auto\">Each vector takes <code>4 * dimensions + 8</code> bytes of storage. Each element is a single-precision floating-point number (like the <code>real</code> type in Postgres), and all elements must be finite (no <code>NaN</code>, <code>Infinity</code> or <code>-Infinity</code>). Vectors can have up to 16,000 dimensions.</p>\n<div class=\"markdown-heading\" dir=\"auto\"><h3 class=\"heading-element\" dir=\"auto\" tabindex=\"-1\">Vector Operators</h3><a aria-label=\"Permalink: Vector Operators\" class=\"anchor\" href=\"https://github.com/pgvector/pgvector#vector-operators\" id=\"user-content-vector-operators\" target=\"_blank\"><svg aria-hidden=\"true\" class=\"octicon octicon-link\" height=\"16\" version=\"1.1\" viewbox=\"0 0 16 16\" width=\"16\"><path d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"></path></svg></a></div>\n<markdown-accessiblity-table><table>\n<thead>\n<tr>\n<th>Operator</th>\n<th>Description</th>\n<th>Added</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>+</td>\n<td>element-wise addition</td>\n<td></td>\n</tr>\n<tr>\n<td>-</td>\n<td>element-wise subtraction</td>\n<td></td>\n</tr>\n<tr>\n<td>*</td>\n<td>element-wise multiplication</td>\n<td>0.5.0</td>\n</tr>\n<tr>\n<td>||</td>\n<td>concatenate</td>\n<td>0.7.0</td>\n</tr>\n<tr>\n<td>&lt;-&gt;</td>\n<td>Euclidean distance</td>\n<td></td>\n</tr>\n<tr>\n<td>&lt;#&gt;</td>\n<td>negative inner product</td>\n<td></td>\n</tr>\n<tr>\n<td>&lt;=&gt;</td>\n<td>cosine distance</td>\n<td></td>\n</tr>\n<tr>\n<td>&lt;+&gt;</td>\n<td>taxicab distance</td>\n<td>0.7.0</td>\n</tr>\n</tbody>\n</table></markdown-accessiblity-table>\n<div class=\"markdown-heading\" dir=\"auto\"><h3 class=\"heading-element\" dir=\"auto\" tabindex=\"-1\">Vector Functions</h3><a aria-label=\"Permalink: Vector Functions\" class=\"anchor\" href=\"https://github.com/pgvector/pgvector#vector-functions\" id=\"user-content-vector-functions\" target=\"_blank\"><svg aria-hidden=\"true\" class=\"octicon octicon-link\" height=\"16\" version=\"1.1\" viewbox=\"0 0 16 16\" width=\"16\"><path d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"></path></svg></a></div>\n<markdown-accessiblity-table><table>\n<thead>\n<tr>\n<th>Function</th>\n<th>Description</th>\n<th>Added</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>binary_quantize(vector) → bit</td>\n<td>binary quantize</td>\n<td>0.7.0</td>\n</tr>\n<tr>\n<td>cosine_distance(vector, vector) → double precision</td>\n<td>cosine distance</td>\n<td></td>\n</tr>\n<tr>\n<td>inner_product(vector, vector) → double precision</td>\n<td>inner product</td>\n<td></td>\n</tr>\n<tr>\n<td>l1_distance(vector, vector) → double precision</td>\n<td>taxicab distance</td>\n<td>0.5.0</td>\n</tr>\n<tr>\n<td>l2_distance(vector, vector) → double precision</td>\n<td>Euclidean distance</td>\n<td></td>\n</tr>\n<tr>\n<td>l2_normalize(vector) → vector</td>\n<td>Normalize with Euclidean norm</td>\n<td>0.7.0</td>\n</tr>\n<tr>\n<td>subvector(vector, integer, integer) → vector</td>\n<td>subvector</td>\n<td>0.7.0</td>\n</tr>\n<tr>\n<td>vector_dims(vector) → integer</td>\n<td>number of dimensions</td>\n<td></td>\n</tr>\n<tr>\n<td>vector_norm(vector) → double precision</td>\n<td>Euclidean norm</td>\n<td></td>\n</tr>\n</tbody>\n</table></markdown-accessiblity-table>\n<div class=\"markdown-heading\" dir=\"auto\"><h3 class=\"heading-element\" dir=\"auto\" tabindex=\"-1\">Vector Aggregate Functions</h3><a aria-label=\"Permalink: Vector Aggregate Functions\" class=\"anchor\" href=\"https://github.com/pgvector/pgvector#vector-aggregate-functions\" id=\"user-content-vector-aggregate-functions\" target=\"_blank\"><svg aria-hidden=\"true\" class=\"octicon octicon-link\" height=\"16\" version=\"1.1\" viewbox=\"0 0 16 16\" width=\"16\"><path d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"></path></svg></a></div>\n<markdown-accessiblity-table><table>\n<thead>\n<tr>\n<th>Function</th>\n<th>Description</th>\n<th>Added</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>avg(vector) → vector</td>\n<td>average</td>\n<td></td>\n</tr>\n<tr>\n<td>sum(vector) → vector</td>\n<td>sum</td>\n<td>0.5.0</td>\n</tr>\n</tbody>\n</table></markdown-accessiblity-table>\n<div class=\"markdown-heading\" dir=\"auto\"><h3 class=\"heading-element\" dir=\"auto\" tabindex=\"-1\">Halfvec Type</h3><a aria-label=\"Permalink: Halfvec Type\" class=\"anchor\" href=\"https://github.com/pgvector/pgvector#halfvec-type\" id=\"user-content-halfvec-type\" target=\"_blank\"><svg aria-hidden=\"true\" class=\"octicon octicon-link\" height=\"16\" version=\"1.1\" viewbox=\"0 0 16 16\" width=\"16\"><path d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"></path></svg></a></div>\n<p dir=\"auto\">Each half vector takes <code>2 * dimensions + 8</code> bytes of storage. Each element is a half-precision floating-point number, and all elements must be finite (no <code>NaN</code>, <code>Infinity</code> or <code>-Infinity</code>). Half vectors can have up to 16,000 dimensions.</p>\n<div class=\"markdown-heading\" dir=\"auto\"><h3 class=\"heading-element\" dir=\"auto\" tabindex=\"-1\">Halfvec Operators</h3><a aria-label=\"Permalink: Halfvec Operators\" class=\"anchor\" href=\"https://github.com/pgvector/pgvector#halfvec-operators\" id=\"user-content-halfvec-operators\" target=\"_blank\"><svg aria-hidden=\"true\" class=\"octicon octicon-link\" height=\"16\" version=\"1.1\" viewbox=\"0 0 16 16\" width=\"16\"><path d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"></path></svg></a></div>\n<markdown-accessiblity-table><table>\n<thead>\n<tr>\n<th>Operator</th>\n<th>Description</th>\n<th>Added</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>+</td>\n<td>element-wise addition</td>\n<td>0.7.0</td>\n</tr>\n<tr>\n<td>-</td>\n<td>element-wise subtraction</td>\n<td>0.7.0</td>\n</tr>\n<tr>\n<td>*</td>\n<td>element-wise multiplication</td>\n<td>0.7.0</td>\n</tr>\n<tr>\n<td>||</td>\n<td>concatenate</td>\n<td>0.7.0</td>\n</tr>\n<tr>\n<td>&lt;-&gt;</td>\n<td>Euclidean distance</td>\n<td>0.7.0</td>\n</tr>\n<tr>\n<td>&lt;#&gt;</td>\n<td>negative inner product</td>\n<td>0.7.0</td>\n</tr>\n<tr>\n<td>&lt;=&gt;</td>\n<td>cosine distance</td>\n<td>0.7.0</td>\n</tr>\n<tr>\n<td>&lt;+&gt;</td>\n<td>taxicab distance</td>\n<td>0.7.0</td>\n</tr>\n</tbody>\n</table></markdown-accessiblity-table>\n<div class=\"markdown-heading\" dir=\"auto\"><h3 class=\"heading-element\" dir=\"auto\" tabindex=\"-1\">Halfvec Functions</h3><a aria-label=\"Permalink: Halfvec Functions\" class=\"anchor\" href=\"https://github.com/pgvector/pgvector#halfvec-functions\" id=\"user-content-halfvec-functions\" target=\"_blank\"><svg aria-hidden=\"true\" class=\"octicon octicon-link\" height=\"16\" version=\"1.1\" viewbox=\"0 0 16 16\" width=\"16\"><path d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"></path></svg></a></div>\n<markdown-accessiblity-table><table>\n<thead>\n<tr>\n<th>Function</th>\n<th>Description</th>\n<th>Added</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>binary_quantize(halfvec) → bit</td>\n<td>binary quantize</td>\n<td>0.7.0</td>\n</tr>\n<tr>\n<td>cosine_distance(halfvec, halfvec) → double precision</td>\n<td>cosine distance</td>\n<td>0.7.0</td>\n</tr>\n<tr>\n<td>inner_product(halfvec, halfvec) → double precision</td>\n<td>inner product</td>\n<td>0.7.0</td>\n</tr>\n<tr>\n<td>l1_distance(halfvec, halfvec) → double precision</td>\n<td>taxicab distance</td>\n<td>0.7.0</td>\n</tr>\n<tr>\n<td>l2_distance(halfvec, halfvec) → double precision</td>\n<td>Euclidean distance</td>\n<td>0.7.0</td>\n</tr>\n<tr>\n<td>l2_norm(halfvec) → double precision</td>\n<td>Euclidean norm</td>\n<td>0.7.0</td>\n</tr>\n<tr>\n<td>l2_normalize(halfvec) → halfvec</td>\n<td>Normalize with Euclidean norm</td>\n<td>0.7.0</td>\n</tr>\n<tr>\n<td>subvector(halfvec, integer, integer) → halfvec</td>\n<td>subvector</td>\n<td>0.7.0</td>\n</tr>\n<tr>\n<td>vector_dims(halfvec) → integer</td>\n<td>number of dimensions</td>\n<td>0.7.0</td>\n</tr>\n</tbody>\n</table></markdown-accessiblity-table>\n<div class=\"markdown-heading\" dir=\"auto\"><h3 class=\"heading-element\" dir=\"auto\" tabindex=\"-1\">Halfvec Aggregate Functions</h3><a aria-label=\"Permalink: Halfvec Aggregate Functions\" class=\"anchor\" href=\"https://github.com/pgvector/pgvector#halfvec-aggregate-functions\" id=\"user-content-halfvec-aggregate-functions\" target=\"_blank\"><svg aria-hidden=\"true\" class=\"octicon octicon-link\" height=\"16\" version=\"1.1\" viewbox=\"0 0 16 16\" width=\"16\"><path d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"></path></svg></a></div>\n<markdown-accessiblity-table><table>\n<thead>\n<tr>\n<th>Function</th>\n<th>Description</th>\n<th>Added</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>avg(halfvec) → halfvec</td>\n<td>average</td>\n<td>0.7.0</td>\n</tr>\n<tr>\n<td>sum(halfvec) → halfvec</td>\n<td>sum</td>\n<td>0.7.0</td>\n</tr>\n</tbody>\n</table></markdown-accessiblity-table>\n<div class=\"markdown-heading\" dir=\"auto\"><h3 class=\"heading-element\" dir=\"auto\" tabindex=\"-1\">Bit Type</h3><a aria-label=\"Permalink: Bit Type\" class=\"anchor\" href=\"https://github.com/pgvector/pgvector#bit-type\" id=\"user-content-bit-type\" target=\"_blank\"><svg aria-hidden=\"true\" class=\"octicon octicon-link\" height=\"16\" version=\"1.1\" viewbox=\"0 0 16 16\" width=\"16\"><path d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"></path></svg></a></div>\n<p dir=\"auto\">Each bit vector takes <code>dimensions / 8 + 8</code> bytes of storage. See the <a href=\"https://www.postgresql.org/docs/current/datatype-bit.html\" rel=\"nofollow\" target=\"_blank\">Postgres docs</a> for more info.</p>\n<div class=\"markdown-heading\" dir=\"auto\"><h3 class=\"heading-element\" dir=\"auto\" tabindex=\"-1\">Bit Operators</h3><a aria-label=\"Permalink: Bit Operators\" class=\"anchor\" href=\"https://github.com/pgvector/pgvector#bit-operators\" id=\"user-content-bit-operators\" target=\"_blank\"><svg aria-hidden=\"true\" class=\"octicon octicon-link\" height=\"16\" version=\"1.1\" viewbox=\"0 0 16 16\" width=\"16\"><path d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"></path></svg></a></div>\n<markdown-accessiblity-table><table>\n<thead>\n<tr>\n<th>Operator</th>\n<th>Description</th>\n<th>Added</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>&lt;~&gt;</td>\n<td>Hamming distance</td>\n<td>0.7.0</td>\n</tr>\n<tr>\n<td>&lt;%&gt;</td>\n<td>Jaccard distance</td>\n<td>0.7.0</td>\n</tr>\n</tbody>\n</table></markdown-accessiblity-table>\n<div class=\"markdown-heading\" dir=\"auto\"><h3 class=\"heading-element\" dir=\"auto\" tabindex=\"-1\">Bit Functions</h3><a aria-label=\"Permalink: Bit Functions\" class=\"anchor\" href=\"https://github.com/pgvector/pgvector#bit-functions\" id=\"user-content-bit-functions\" target=\"_blank\"><svg aria-hidden=\"true\" class=\"octicon octicon-link\" height=\"16\" version=\"1.1\" viewbox=\"0 0 16 16\" width=\"16\"><path d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"></path></svg></a></div>\n<markdown-accessiblity-table><table>\n<thead>\n<tr>\n<th>Function</th>\n<th>Description</th>\n<th>Added</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>hamming_distance(bit, bit) → double precision</td>\n<td>Hamming distance</td>\n<td>0.7.0</td>\n</tr>\n<tr>\n<td>jaccard_distance(bit, bit) → double precision</td>\n<td>Jaccard distance</td>\n<td>0.7.0</td>\n</tr>\n</tbody>\n</table></markdown-accessiblity-table>\n<div class=\"markdown-heading\" dir=\"auto\"><h3 class=\"heading-element\" dir=\"auto\" tabindex=\"-1\">Sparsevec Type</h3><a aria-label=\"Permalink: Sparsevec Type\" class=\"anchor\" href=\"https://github.com/pgvector/pgvector#sparsevec-type\" id=\"user-content-sparsevec-type\" target=\"_blank\"><svg aria-hidden=\"true\" class=\"octicon octicon-link\" height=\"16\" version=\"1.1\" viewbox=\"0 0 16 16\" width=\"16\"><path d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"></path></svg></a></div>\n<p dir=\"auto\">Each sparse vector takes <code>8 * non-zero elements + 16</code> bytes of storage. Each element is a single-precision floating-point number, and all elements must be finite (no <code>NaN</code>, <code>Infinity</code> or <code>-Infinity</code>). Sparse vectors can have up to 16,000 non-zero elements.</p>\n<div class=\"markdown-heading\" dir=\"auto\"><h3 class=\"heading-element\" dir=\"auto\" tabindex=\"-1\">Sparsevec Operators</h3><a aria-label=\"Permalink: Sparsevec Operators\" class=\"anchor\" href=\"https://github.com/pgvector/pgvector#sparsevec-operators\" id=\"user-content-sparsevec-operators\" target=\"_blank\"><svg aria-hidden=\"true\" class=\"octicon octicon-link\" height=\"16\" version=\"1.1\" viewbox=\"0 0 16 16\" width=\"16\"><path d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"></path></svg></a></div>\n<markdown-accessiblity-table><table>\n<thead>\n<tr>\n<th>Operator</th>\n<th>Description</th>\n<th>Added</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>&lt;-&gt;</td>\n<td>Euclidean distance</td>\n<td>0.7.0</td>\n</tr>\n<tr>\n<td>&lt;#&gt;</td>\n<td>negative inner product</td>\n<td>0.7.0</td>\n</tr>\n<tr>\n<td>&lt;=&gt;</td>\n<td>cosine distance</td>\n<td>0.7.0</td>\n</tr>\n<tr>\n<td>&lt;+&gt;</td>\n<td>taxicab distance</td>\n<td>0.7.0</td>\n</tr>\n</tbody>\n</table></markdown-accessiblity-table>\n<div class=\"markdown-heading\" dir=\"auto\"><h3 class=\"heading-element\" dir=\"auto\" tabindex=\"-1\">Sparsevec Functions</h3><a aria-label=\"Permalink: Sparsevec Functions\" class=\"anchor\" href=\"https://github.com/pgvector/pgvector#sparsevec-functions\" id=\"user-content-sparsevec-functions\" target=\"_blank\"><svg aria-hidden=\"true\" class=\"octicon octicon-link\" height=\"16\" version=\"1.1\" viewbox=\"0 0 16 16\" width=\"16\"><path d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"></path></svg></a></div>\n<markdown-accessiblity-table><table>\n<thead>\n<tr>\n<th>Function</th>\n<th>Description</th>\n<th>Added</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>cosine_distance(sparsevec, sparsevec) → double precision</td>\n<td>cosine distance</td>\n<td>0.7.0</td>\n</tr>\n<tr>\n<td>inner_product(sparsevec, sparsevec) → double precision</td>\n<td>inner product</td>\n<td>0.7.0</td>\n</tr>\n<tr>\n<td>l1_distance(sparsevec, sparsevec) → double precision</td>\n<td>taxicab distance</td>\n<td>0.7.0</td>\n</tr>\n<tr>\n<td>l2_distance(sparsevec, sparsevec) → double precision</td>\n<td>Euclidean distance</td>\n<td>0.7.0</td>\n</tr>\n<tr>\n<td>l2_norm(sparsevec) → double precision</td>\n<td>Euclidean norm</td>\n<td>0.7.0</td>\n</tr>\n<tr>\n<td>l2_normalize(sparsevec) → sparsevec</td>\n<td>Normalize with Euclidean norm</td>\n<td>0.7.0</td>\n</tr>\n</tbody>\n</table></markdown-accessiblity-table>\n<div class=\"markdown-heading\" dir=\"auto\"><h2 class=\"heading-element\" dir=\"auto\" tabindex=\"-1\">Installation Notes - Linux and Mac</h2><a aria-label=\"Permalink: Installation Notes - Linux and Mac\" class=\"anchor\" href=\"https://github.com/pgvector/pgvector#installation-notes---linux-and-mac\" id=\"user-content-installation-notes---linux-and-mac\" target=\"_blank\"><svg aria-hidden=\"true\" class=\"octicon octicon-link\" height=\"16\" version=\"1.1\" viewbox=\"0 0 16 16\" width=\"16\"><path d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"></path></svg></a></div>\n<div class=\"markdown-heading\" dir=\"auto\"><h3 class=\"heading-element\" dir=\"auto\" tabindex=\"-1\">Postgres Location</h3><a aria-label=\"Permalink: Postgres Location\" class=\"anchor\" href=\"https://github.com/pgvector/pgvector#postgres-location\" id=\"user-content-postgres-location\" target=\"_blank\"><svg aria-hidden=\"true\" class=\"octicon octicon-link\" height=\"16\" version=\"1.1\" viewbox=\"0 0 16 16\" width=\"16\"><path d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"></path></svg></a></div>\n<p dir=\"auto\">If your machine has multiple Postgres installations, specify the path to <a href=\"https://www.postgresql.org/docs/current/app-pgconfig.html\" rel=\"nofollow\" target=\"_blank\">pg_config</a> with:</p>\n<div class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"export PG_CONFIG=/Library/PostgreSQL/18/bin/pg_config\" dir=\"auto\"><pre><span class=\"pl-k\">export</span> PG_CONFIG=/Library/PostgreSQL/18/bin/pg_config</pre></div>\n<p dir=\"auto\">Then re-run the installation instructions (run <code>make clean</code> before <code>make</code> if needed). If <code>sudo</code> is needed for <code>make install</code>, use:</p>\n<div class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"sudo --preserve-env=PG_CONFIG make install\" dir=\"auto\"><pre>sudo --preserve-env=PG_CONFIG make install</pre></div>\n<p dir=\"auto\">A few common paths on Mac are:</p>\n<ul dir=\"auto\">\n<li>EDB installer - <code>/Library/PostgreSQL/18/bin/pg_config</code></li>\n<li>Homebrew (arm64) - <code>/opt/homebrew/opt/postgresql@18/bin/pg_config</code></li>\n<li>Homebrew (x86-64) - <code>/usr/local/opt/postgresql@18/bin/pg_config</code></li>\n</ul>\n<p dir=\"auto\">Note: Replace <code>18</code> with your Postgres server version</p>\n<div class=\"markdown-heading\" dir=\"auto\"><h3 class=\"heading-element\" dir=\"auto\" tabindex=\"-1\">Missing Header</h3><a aria-label=\"Permalink: Missing Header\" class=\"anchor\" href=\"https://github.com/pgvector/pgvector#missing-header\" id=\"user-content-missing-header\" target=\"_blank\"><svg aria-hidden=\"true\" class=\"octicon octicon-link\" height=\"16\" version=\"1.1\" viewbox=\"0 0 16 16\" width=\"16\"><path d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"></path></svg></a></div>\n<p dir=\"auto\">If compilation fails with <code>fatal error: postgres.h: No such file or directory</code>, make sure Postgres development files are installed on the server.</p>\n<p dir=\"auto\">For Ubuntu and Debian, use:</p>\n<div class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"sudo apt install postgresql-server-dev-18\" dir=\"auto\"><pre>sudo apt install postgresql-server-dev-18</pre></div>\n<p dir=\"auto\">Note: Replace <code>18</code> with your Postgres server version</p>\n<div class=\"markdown-heading\" dir=\"auto\"><h3 class=\"heading-element\" dir=\"auto\" tabindex=\"-1\">Missing SDK</h3><a aria-label=\"Permalink: Missing SDK\" class=\"anchor\" href=\"https://github.com/pgvector/pgvector#missing-sdk\" id=\"user-content-missing-sdk\" target=\"_blank\"><svg aria-hidden=\"true\" class=\"octicon octicon-link\" height=\"16\" version=\"1.1\" viewbox=\"0 0 16 16\" width=\"16\"><path d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"></path></svg></a></div>\n<p dir=\"auto\">If compilation fails and the output includes <code>warning: no such sysroot directory</code> on Mac, your Postgres installation points to a path that no longer exists.</p>\n<div class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"pg_config --cppflags\" dir=\"auto\"><pre>pg_config --cppflags</pre></div>\n<p dir=\"auto\">Reinstall Postgres to fix this.</p>\n<div class=\"markdown-heading\" dir=\"auto\"><h3 class=\"heading-element\" dir=\"auto\" tabindex=\"-1\">Portability</h3><a aria-label=\"Permalink: Portability\" class=\"anchor\" href=\"https://github.com/pgvector/pgvector#portability\" id=\"user-content-portability\" target=\"_blank\"><svg aria-hidden=\"true\" class=\"octicon octicon-link\" height=\"16\" version=\"1.1\" viewbox=\"0 0 16 16\" width=\"16\"><path d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"></path></svg></a></div>\n<p dir=\"auto\">By default, pgvector compiles with <code>-march=native</code> on some platforms for best performance. However, this can lead to <code>Illegal instruction</code> errors if trying to run the compiled extension on a different machine.</p>\n<p dir=\"auto\">To compile for portability, use:</p>\n<div class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content='make OPTFLAGS=\"\"' dir=\"auto\"><pre>make OPTFLAGS=<span class=\"pl-s\"><span class=\"pl-pds\">\"</span><span class=\"pl-pds\">\"</span></span></pre></div>\n<div class=\"markdown-heading\" dir=\"auto\"><h2 class=\"heading-element\" dir=\"auto\" tabindex=\"-1\">Installation Notes - Windows</h2><a aria-label=\"Permalink: Installation Notes - Windows\" class=\"anchor\" href=\"https://github.com/pgvector/pgvector#installation-notes---windows\" id=\"user-content-installation-notes---windows\" target=\"_blank\"><svg aria-hidden=\"true\" class=\"octicon octicon-link\" height=\"16\" version=\"1.1\" viewbox=\"0 0 16 16\" width=\"16\"><path d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"></path></svg></a></div>\n<div class=\"markdown-heading\" dir=\"auto\"><h3 class=\"heading-element\" dir=\"auto\" tabindex=\"-1\">Missing Header</h3><a aria-label=\"Permalink: Missing Header\" class=\"anchor\" href=\"https://github.com/pgvector/pgvector#missing-header-1\" id=\"user-content-missing-header-1\" target=\"_blank\"><svg aria-hidden=\"true\" class=\"octicon octicon-link\" height=\"16\" version=\"1.1\" viewbox=\"0 0 16 16\" width=\"16\"><path d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"></path></svg></a></div>\n<p dir=\"auto\">If compilation fails with <code>Cannot open include file: 'postgres.h': No such file or directory</code>, make sure <code>PGROOT</code> is correct.</p>\n<div class=\"markdown-heading\" dir=\"auto\"><h3 class=\"heading-element\" dir=\"auto\" tabindex=\"-1\">Mismatched Architecture</h3><a aria-label=\"Permalink: Mismatched Architecture\" class=\"anchor\" href=\"https://github.com/pgvector/pgvector#mismatched-architecture\" id=\"user-content-mismatched-architecture\" target=\"_blank\"><svg aria-hidden=\"true\" class=\"octicon octicon-link\" height=\"16\" version=\"1.1\" viewbox=\"0 0 16 16\" width=\"16\"><path d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"></path></svg></a></div>\n<p dir=\"auto\">If compilation fails with <code>error C2196: case value '4' already used</code>, make sure you’re using the <code>x64 Native Tools Command Prompt</code>. Then run <code>nmake /F Makefile.win clean</code> and re-run the installation instructions.</p>\n<div class=\"markdown-heading\" dir=\"auto\"><h3 class=\"heading-element\" dir=\"auto\" tabindex=\"-1\">Missing Symbol</h3><a aria-label=\"Permalink: Missing Symbol\" class=\"anchor\" href=\"https://github.com/pgvector/pgvector#missing-symbol\" id=\"user-content-missing-symbol\" target=\"_blank\"><svg aria-hidden=\"true\" class=\"octicon octicon-link\" height=\"16\" version=\"1.1\" viewbox=\"0 0 16 16\" width=\"16\"><path d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"></path></svg></a></div>\n<p dir=\"auto\">If linking fails with <code>unresolved external symbol float_to_shortest_decimal_bufn</code> with Postgres 17.0-17.2, upgrade to Postgres 17.3+.</p>\n<div class=\"markdown-heading\" dir=\"auto\"><h3 class=\"heading-element\" dir=\"auto\" tabindex=\"-1\">Permissions</h3><a aria-label=\"Permalink: Permissions\" class=\"anchor\" href=\"https://github.com/pgvector/pgvector#permissions\" id=\"user-content-permissions\" target=\"_blank\"><svg aria-hidden=\"true\" class=\"octicon octicon-link\" height=\"16\" version=\"1.1\" viewbox=\"0 0 16 16\" width=\"16\"><path d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"></path></svg></a></div>\n<p dir=\"auto\">If installation fails with <code>Access is denied</code>, re-run the installation instructions as an administrator.</p>\n<div class=\"markdown-heading\" dir=\"auto\"><h2 class=\"heading-element\" dir=\"auto\" tabindex=\"-1\">Additional Installation Methods</h2><a aria-label=\"Permalink: Additional Installation Methods\" class=\"anchor\" href=\"https://github.com/pgvector/pgvector#additional-installation-methods\" id=\"user-content-additional-installation-methods\" target=\"_blank\"><svg aria-hidden=\"true\" class=\"octicon octicon-link\" height=\"16\" version=\"1.1\" viewbox=\"0 0 16 16\" width=\"16\"><path d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"></path></svg></a></div>\n<div class=\"markdown-heading\" dir=\"auto\"><h3 class=\"heading-element\" dir=\"auto\" tabindex=\"-1\">Docker</h3><a aria-label=\"Permalink: Docker\" class=\"anchor\" href=\"https://github.com/pgvector/pgvector#docker\" id=\"user-content-docker\" target=\"_blank\"><svg aria-hidden=\"true\" class=\"octicon octicon-link\" height=\"16\" version=\"1.1\" viewbox=\"0 0 16 16\" width=\"16\"><path d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"></path></svg></a></div>\n<p dir=\"auto\">Get the <a href=\"https://hub.docker.com/r/pgvector/pgvector\" rel=\"nofollow\" target=\"_blank\">Docker image</a> with:</p>\n<div class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"docker pull pgvector/pgvector:pg18-trixie\" dir=\"auto\"><pre>docker pull pgvector/pgvector:pg18-trixie</pre></div>\n<p dir=\"auto\">This adds pgvector to the <a href=\"https://hub.docker.com/_/postgres\" rel=\"nofollow\" target=\"_blank\">Postgres image</a> (replace <code>18</code> with your Postgres server version, and run it the same way).</p>\n<p dir=\"auto\">Supported tags are:</p>\n<ul dir=\"auto\">\n<li><code>pg18-trixie</code>, <code>0.8.1-pg18-trixie</code></li>\n<li><code>pg18-bookworm</code>, <code>0.8.1-pg18-bookworm</code>, <code>pg18</code>, <code>0.8.1-pg18</code></li>\n<li><code>pg17-trixie</code>, <code>0.8.1-pg17-trixie</code></li>\n<li><code>pg17-bookworm</code>, <code>0.8.1-pg17-bookworm</code>, <code>pg17</code>, <code>0.8.1-pg17</code></li>\n<li><code>pg16-trixie</code>, <code>0.8.1-pg16-trixie</code></li>\n<li><code>pg16-bookworm</code>, <code>0.8.1-pg16-bookworm</code>, <code>pg16</code>, <code>0.8.1-pg16</code></li>\n<li><code>pg15-trixie</code>, <code>0.8.1-pg15-trixie</code></li>\n<li><code>pg15-bookworm</code>, <code>0.8.1-pg15-bookworm</code>, <code>pg15</code>, <code>0.8.1-pg15</code></li>\n<li><code>pg14-trixie</code>, <code>0.8.1-pg14-trixie</code></li>\n<li><code>pg14-bookworm</code>, <code>0.8.1-pg14-bookworm</code>, <code>pg14</code>, <code>0.8.1-pg14</code></li>\n<li><code>pg13-trixie</code>, <code>0.8.1-pg13-trixie</code></li>\n<li><code>pg13-bookworm</code>, <code>0.8.1-pg13-bookworm</code>, <code>pg13</code>, <code>0.8.1-pg13</code></li>\n</ul>\n<p dir=\"auto\">You can also build the image manually:</p>\n<div class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"git clone --branch v0.8.1 https://github.com/pgvector/pgvector.git\ncd pgvector\ndocker build --pull --build-arg PG_MAJOR=18 -t myuser/pgvector .\" dir=\"auto\"><pre>git clone --branch v0.8.1 https://github.com/pgvector/pgvector.git\n<span class=\"pl-c1\">cd</span> pgvector\ndocker build --pull --build-arg PG_MAJOR=18 -t myuser/pgvector <span class=\"pl-c1\">.</span></pre></div>\n<p dir=\"auto\">If you increase <code>maintenance_work_mem</code>, make sure <code>--shm-size</code> is at least that size to avoid an error with parallel HNSW index builds.</p>\n<div class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"docker run --shm-size=1g ...\" dir=\"auto\"><pre>docker run --shm-size=1g ...</pre></div>\n<div class=\"markdown-heading\" dir=\"auto\"><h3 class=\"heading-element\" dir=\"auto\" tabindex=\"-1\">Homebrew</h3><a aria-label=\"Permalink: Homebrew\" class=\"anchor\" href=\"https://github.com/pgvector/pgvector#homebrew\" id=\"user-content-homebrew\" target=\"_blank\"><svg aria-hidden=\"true\" class=\"octicon octicon-link\" height=\"16\" version=\"1.1\" viewbox=\"0 0 16 16\" width=\"16\"><path d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"></path></svg></a></div>\n<p dir=\"auto\">With Homebrew Postgres, you can use:</p>\n<div class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"brew install pgvector\" dir=\"auto\"><pre>brew install pgvector</pre></div>\n<p dir=\"auto\">Note: This only adds it to the <code>postgresql@18</code> and <code>postgresql@17</code> formulas</p>\n<div class=\"markdown-heading\" dir=\"auto\"><h3 class=\"heading-element\" dir=\"auto\" tabindex=\"-1\">PGXN</h3><a aria-label=\"Permalink: PGXN\" class=\"anchor\" href=\"https://github.com/pgvector/pgvector#pgxn\" id=\"user-content-pgxn\" target=\"_blank\"><svg aria-hidden=\"true\" class=\"octicon octicon-link\" height=\"16\" version=\"1.1\" viewbox=\"0 0 16 16\" width=\"16\"><path d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"></path></svg></a></div>\n<p dir=\"auto\">Install from the <a href=\"https://pgxn.org/dist/vector\" rel=\"nofollow\" target=\"_blank\">PostgreSQL Extension Network</a> with:</p>\n<div class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"pgxn install vector\" dir=\"auto\"><pre>pgxn install vector</pre></div>\n<div class=\"markdown-heading\" dir=\"auto\"><h3 class=\"heading-element\" dir=\"auto\" tabindex=\"-1\">APT</h3><a aria-label=\"Permalink: APT\" class=\"anchor\" href=\"https://github.com/pgvector/pgvector#apt\" id=\"user-content-apt\" target=\"_blank\"><svg aria-hidden=\"true\" class=\"octicon octicon-link\" height=\"16\" version=\"1.1\" viewbox=\"0 0 16 16\" width=\"16\"><path d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"></path></svg></a></div>\n<p dir=\"auto\">Debian and Ubuntu packages are available from the <a href=\"https://wiki.postgresql.org/wiki/Apt\" rel=\"nofollow\" target=\"_blank\">PostgreSQL APT Repository</a>. Follow the <a href=\"https://wiki.postgresql.org/wiki/Apt#Quickstart\" rel=\"nofollow\" target=\"_blank\">setup instructions</a> and run:</p>\n<div class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"sudo apt install postgresql-18-pgvector\" dir=\"auto\"><pre>sudo apt install postgresql-18-pgvector</pre></div>\n<p dir=\"auto\">Note: Replace <code>18</code> with your Postgres server version</p>\n<div class=\"markdown-heading\" dir=\"auto\"><h3 class=\"heading-element\" dir=\"auto\" tabindex=\"-1\">Yum</h3><a aria-label=\"Permalink: Yum\" class=\"anchor\" href=\"https://github.com/pgvector/pgvector#yum\" id=\"user-content-yum\" target=\"_blank\"><svg aria-hidden=\"true\" class=\"octicon octicon-link\" height=\"16\" version=\"1.1\" viewbox=\"0 0 16 16\" width=\"16\"><path d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"></path></svg></a></div>\n<p dir=\"auto\">RPM packages are available from the <a href=\"https://yum.postgresql.org/\" rel=\"nofollow\" target=\"_blank\">PostgreSQL Yum Repository</a>. Follow the <a href=\"https://www.postgresql.org/download/linux/redhat/\" rel=\"nofollow\" target=\"_blank\">setup instructions</a> for your distribution and run:</p>\n<div class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"sudo yum install pgvector_18\n# or\nsudo dnf install pgvector_18\" dir=\"auto\"><pre>sudo yum install pgvector_18\n<span class=\"pl-c\"><span class=\"pl-c\">#</span> or</span>\nsudo dnf install pgvector_18</pre></div>\n<p dir=\"auto\">Note: Replace <code>18</code> with your Postgres server version</p>\n<div class=\"markdown-heading\" dir=\"auto\"><h3 class=\"heading-element\" dir=\"auto\" tabindex=\"-1\">pkg</h3><a aria-label=\"Permalink: pkg\" class=\"anchor\" href=\"https://github.com/pgvector/pgvector#pkg\" id=\"user-content-pkg\" target=\"_blank\"><svg aria-hidden=\"true\" class=\"octicon octicon-link\" height=\"16\" version=\"1.1\" viewbox=\"0 0 16 16\" width=\"16\"><path d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"></path></svg></a></div>\n<p dir=\"auto\">Install the FreeBSD package with:</p>\n<div class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"pkg install postgresql17-pgvector\" dir=\"auto\"><pre>pkg install postgresql17-pgvector</pre></div>\n<p dir=\"auto\">or the port with:</p>\n<div class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"cd /usr/ports/databases/pgvector\nmake install\" dir=\"auto\"><pre><span class=\"pl-c1\">cd</span> /usr/ports/databases/pgvector\nmake install</pre></div>\n<div class=\"markdown-heading\" dir=\"auto\"><h3 class=\"heading-element\" dir=\"auto\" tabindex=\"-1\">APK</h3><a aria-label=\"Permalink: APK\" class=\"anchor\" href=\"https://github.com/pgvector/pgvector#apk\" id=\"user-content-apk\" target=\"_blank\"><svg aria-hidden=\"true\" class=\"octicon octicon-link\" height=\"16\" version=\"1.1\" viewbox=\"0 0 16 16\" width=\"16\"><path d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"></path></svg></a></div>\n<p dir=\"auto\">Install the Alpine package with:</p>\n<div class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"apk add postgresql-pgvector\" dir=\"auto\"><pre>apk add postgresql-pgvector</pre></div>\n<div class=\"markdown-heading\" dir=\"auto\"><h3 class=\"heading-element\" dir=\"auto\" tabindex=\"-1\">conda-forge</h3><a aria-label=\"Permalink: conda-forge\" class=\"anchor\" href=\"https://github.com/pgvector/pgvector#conda-forge\" id=\"user-content-conda-forge\" target=\"_blank\"><svg aria-hidden=\"true\" class=\"octicon octicon-link\" height=\"16\" version=\"1.1\" viewbox=\"0 0 16 16\" width=\"16\"><path d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"></path></svg></a></div>\n<p dir=\"auto\">With Conda Postgres, install from <a href=\"https://anaconda.org/conda-forge/pgvector\" rel=\"nofollow\" target=\"_blank\">conda-forge</a> with:</p>\n<div class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"conda install -c conda-forge pgvector\" dir=\"auto\"><pre>conda install -c conda-forge pgvector</pre></div>\n<p dir=\"auto\">This method is <a href=\"https://github.com/conda-forge/pgvector-feedstock\" target=\"_blank\">community-maintained</a> by <a href=\"https://github.com/mmcauliffe\" target=\"_blank\">@mmcauliffe</a></p>\n<div class=\"markdown-heading\" dir=\"auto\"><h3 class=\"heading-element\" dir=\"auto\" tabindex=\"-1\">Postgres.app</h3><a aria-label=\"Permalink: Postgres.app\" class=\"anchor\" href=\"https://github.com/pgvector/pgvector#postgresapp\" id=\"user-content-postgresapp\" target=\"_blank\"><svg aria-hidden=\"true\" class=\"octicon octicon-link\" height=\"16\" version=\"1.1\" viewbox=\"0 0 16 16\" width=\"16\"><path d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"></path></svg></a></div>\n<p dir=\"auto\">Download the <a href=\"https://postgresapp.com/downloads.html\" rel=\"nofollow\" target=\"_blank\">latest release</a> with Postgres 15+.</p>\n<div class=\"markdown-heading\" dir=\"auto\"><h2 class=\"heading-element\" dir=\"auto\" tabindex=\"-1\">Hosted Postgres</h2><a aria-label=\"Permalink: Hosted Postgres\" class=\"anchor\" href=\"https://github.com/pgvector/pgvector#hosted-postgres\" id=\"user-content-hosted-postgres\" target=\"_blank\"><svg aria-hidden=\"true\" class=\"octicon octicon-link\" height=\"16\" version=\"1.1\" viewbox=\"0 0 16 16\" width=\"16\"><path d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"></path></svg></a></div>\n<p dir=\"auto\">pgvector is available on <a data-hovercard-type=\"issue\" data-hovercard-url=\"/pgvector/pgvector/issues/54/hovercard\" href=\"https://github.com/pgvector/pgvector/issues/54\" target=\"_blank\">these providers</a>.</p>\n<div class=\"markdown-heading\" dir=\"auto\"><h2 class=\"heading-element\" dir=\"auto\" tabindex=\"-1\">Upgrading</h2><a aria-label=\"Permalink: Upgrading\" class=\"anchor\" href=\"https://github.com/pgvector/pgvector#upgrading\" id=\"user-content-upgrading\" target=\"_blank\"><svg aria-hidden=\"true\" class=\"octicon octicon-link\" height=\"16\" version=\"1.1\" viewbox=\"0 0 16 16\" width=\"16\"><path d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"></path></svg></a></div>\n<p dir=\"auto\"><a href=\"https://github.com/pgvector/pgvector#installation\" target=\"_blank\">Install</a> the latest version (use the same method as the original installation). Then in each database you want to upgrade, run:</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"ALTER EXTENSION vector UPDATE;\" dir=\"auto\"><pre>ALTER EXTENSION vector <span class=\"pl-k\">UPDATE</span>;</pre></div>\n<p dir=\"auto\">You can check the version in the current database with:</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"SELECT extversion FROM pg_extension WHERE extname = 'vector';\" dir=\"auto\"><pre><span class=\"pl-k\">SELECT</span> extversion <span class=\"pl-k\">FROM</span> pg_extension <span class=\"pl-k\">WHERE</span> extname <span class=\"pl-k\">=</span> <span class=\"pl-s\"><span class=\"pl-pds\">'</span>vector<span class=\"pl-pds\">'</span></span>;</pre></div>\n<div class=\"markdown-heading\" dir=\"auto\"><h2 class=\"heading-element\" dir=\"auto\" tabindex=\"-1\">Thanks</h2><a aria-label=\"Permalink: Thanks\" class=\"anchor\" href=\"https://github.com/pgvector/pgvector#thanks\" id=\"user-content-thanks\" target=\"_blank\"><svg aria-hidden=\"true\" class=\"octicon octicon-link\" height=\"16\" version=\"1.1\" viewbox=\"0 0 16 16\" width=\"16\"><path d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"></path></svg></a></div>\n<p dir=\"auto\">Thanks to:</p>\n<ul dir=\"auto\">\n<li><a href=\"https://dl.acm.org/doi/pdf/10.1145/3318464.3386131\" rel=\"nofollow\" target=\"_blank\">PASE: PostgreSQL Ultra-High-Dimensional Approximate Nearest Neighbor Search Extension</a></li>\n<li><a href=\"https://github.com/facebookresearch/faiss\" target=\"_blank\">Faiss: A Library for Efficient Similarity Search and Clustering of Dense Vectors</a></li>\n<li><a href=\"https://cdn.aaai.org/ICML/2003/ICML03-022.pdf\" rel=\"nofollow\" target=\"_blank\">Using the Triangle Inequality to Accelerate k-means</a></li>\n<li><a href=\"https://theory.stanford.edu/~sergei/papers/kMeansPP-soda.pdf\" rel=\"nofollow\" target=\"_blank\">k-means++: The Advantage of Careful Seeding</a></li>\n<li><a href=\"https://www.cs.utexas.edu/users/inderjit/public_papers/concept_mlj.pdf\" rel=\"nofollow\" target=\"_blank\">Concept Decompositions for Large Sparse Text Data using Clustering</a></li>\n<li><a href=\"https://arxiv.org/ftp/arxiv/papers/1603/1603.09320.pdf\" rel=\"nofollow\" target=\"_blank\">Efficient and Robust Approximate Nearest Neighbor Search using Hierarchical Navigable Small World Graphs</a></li>\n</ul>\n<div class=\"markdown-heading\" dir=\"auto\"><h2 class=\"heading-element\" dir=\"auto\" tabindex=\"-1\">History</h2><a aria-label=\"Permalink: History\" class=\"anchor\" href=\"https://github.com/pgvector/pgvector#history\" id=\"user-content-history\" target=\"_blank\"><svg aria-hidden=\"true\" class=\"octicon octicon-link\" height=\"16\" version=\"1.1\" viewbox=\"0 0 16 16\" width=\"16\"><path d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"></path></svg></a></div>\n<p dir=\"auto\">View the <a href=\"https://github.com/pgvector/pgvector/blob/master/CHANGELOG.md\" target=\"_blank\">changelog</a></p>\n<div class=\"markdown-heading\" dir=\"auto\"><h2 class=\"heading-element\" dir=\"auto\" tabindex=\"-1\">Contributing</h2><a aria-label=\"Permalink: Contributing\" class=\"anchor\" href=\"https://github.com/pgvector/pgvector#contributing\" id=\"user-content-contributing\" target=\"_blank\"><svg aria-hidden=\"true\" class=\"octicon octicon-link\" height=\"16\" version=\"1.1\" viewbox=\"0 0 16 16\" width=\"16\"><path d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"></path></svg></a></div>\n<p dir=\"auto\">Everyone is encouraged to help improve this project. Here are a few ways you can help:</p>\n<ul dir=\"auto\">\n<li><a href=\"https://github.com/pgvector/pgvector/issues\" target=\"_blank\">Report bugs</a></li>\n<li>Fix bugs and <a href=\"https://github.com/pgvector/pgvector/pulls\" target=\"_blank\">submit pull requests</a></li>\n<li>Write, clarify, or fix documentation</li>\n<li>Suggest or add new features</li>\n</ul>\n<p dir=\"auto\">To get started with development:</p>\n<div class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"git clone https://github.com/pgvector/pgvector.git\ncd pgvector\nmake\nmake install\" dir=\"auto\"><pre>git clone https://github.com/pgvector/pgvector.git\n<span class=\"pl-c1\">cd</span> pgvector\nmake\nmake install</pre></div>\n<p dir=\"auto\">To run all tests:</p>\n<div class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"make installcheck        # regression tests\nmake prove_installcheck  # TAP tests\" dir=\"auto\"><pre>make installcheck        <span class=\"pl-c\"><span class=\"pl-c\">#</span> regression tests</span>\nmake prove_installcheck  <span class=\"pl-c\"><span class=\"pl-c\">#</span> TAP tests</span></pre></div>\n<p dir=\"auto\">To run single tests:</p>\n<div class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"make installcheck REGRESS=functions                            # regression test\nmake prove_installcheck PROVE_TESTS=test/t/001_ivfflat_wal.pl  # TAP test\" dir=\"auto\"><pre>make installcheck REGRESS=functions                            <span class=\"pl-c\"><span class=\"pl-c\">#</span> regression test</span>\nmake prove_installcheck PROVE_TESTS=test/t/001_ivfflat_wal.pl  <span class=\"pl-c\"><span class=\"pl-c\">#</span> TAP test</span></pre></div>\n<p dir=\"auto\">To enable assertions:</p>\n<div class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content='make clean &amp;&amp; PG_CFLAGS=\"-DUSE_ASSERT_CHECKING\" make &amp;&amp; make install' dir=\"auto\"><pre>make clean <span class=\"pl-k\">&amp;&amp;</span> PG_CFLAGS=<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>-DUSE_ASSERT_CHECKING<span class=\"pl-pds\">\"</span></span> make <span class=\"pl-k\">&amp;&amp;</span> make install</pre></div>\n<p dir=\"auto\">To enable benchmarking:</p>\n<div class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content='make clean &amp;&amp; PG_CFLAGS=\"-DIVFFLAT_BENCH\" make &amp;&amp; make install' dir=\"auto\"><pre>make clean <span class=\"pl-k\">&amp;&amp;</span> PG_CFLAGS=<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>-DIVFFLAT_BENCH<span class=\"pl-pds\">\"</span></span> make <span class=\"pl-k\">&amp;&amp;</span> make install</pre></div>\n<p dir=\"auto\">To show memory usage:</p>\n<div class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content='make clean &amp;&amp; PG_CFLAGS=\"-DHNSW_MEMORY -DIVFFLAT_MEMORY\" make &amp;&amp; make install' dir=\"auto\"><pre>make clean <span class=\"pl-k\">&amp;&amp;</span> PG_CFLAGS=<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>-DHNSW_MEMORY -DIVFFLAT_MEMORY<span class=\"pl-pds\">\"</span></span> make <span class=\"pl-k\">&amp;&amp;</span> make install</pre></div>\n<p dir=\"auto\">To get k-means metrics:</p>\n<div class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content='make clean &amp;&amp; PG_CFLAGS=\"-DIVFFLAT_KMEANS_DEBUG\" make &amp;&amp; make install' dir=\"auto\"><pre>make clean <span class=\"pl-k\">&amp;&amp;</span> PG_CFLAGS=<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>-DIVFFLAT_KMEANS_DEBUG<span class=\"pl-pds\">\"</span></span> make <span class=\"pl-k\">&amp;&amp;</span> make install</pre></div>\n<p dir=\"auto\">Resources for contributors</p>\n<ul dir=\"auto\">\n<li><a href=\"https://www.postgresql.org/docs/current/extend-pgxs.html\" rel=\"nofollow\" target=\"_blank\">Extension Building Infrastructure</a></li>\n<li><a href=\"https://www.postgresql.org/docs/current/indexam.html\" rel=\"nofollow\" target=\"_blank\">Index Access Method Interface Definition</a></li>\n<li><a href=\"https://www.postgresql.org/docs/current/generic-wal.html\" rel=\"nofollow\" target=\"_blank\">Generic WAL Records</a></li>\n</ul>\n</article>",
      "text": "pgvector\nOpen-source vector similarity search for Postgres\nStore your vectors with the rest of your data. Supports:\nexact and approximate nearest neighbor search\nsingle-precision, half-precision, binary, and sparse vectors\nL2 distance, inner product, cosine distance, L1 distance, Hamming distance, and Jaccard distance\nany\nlanguage\nwith a Postgres client\nPlus\nACID\ncompliance, point-in-time recovery, JOINs, and all of the other\ngreat features\nof Postgres\nInstallation\nLinux and Mac\nCompile and install the extension (supports Postgres 13+)\ncd\n/tmp\ngit clone --branch v0.8.1 https://github.com/pgvector/pgvector.git\ncd\npgvector\nmake\nmake install\n#\nmay need sudo\nSee the\ninstallation notes\nif you run into issues\nYou can also install it with\nDocker\n,\nHomebrew\n,\nPGXN\n,\nAPT\n,\nYum\n,\npkg\n,\nAPK\n, or\nconda-forge\n, and it comes preinstalled with\nPostgres.app\nand many\nhosted providers\n. There are also instructions for\nGitHub Actions\n.\nWindows\nEnsure\nC++ support in Visual Studio\nis installed and run\nx64 Native Tools Command Prompt for VS [version]\nas administrator. Then use\nnmake\nto build:\nset\n\"\nPGROOT\n=\nC:\\Program Files\\PostgreSQL\\18\n\"\ncd\n%TEMP%\ngit clone --branch v0.8.1 https://github.com/pgvector/pgvector.git\ncd\npgvector\nnmake /F Makefile.win\nnmake /F Makefile.win install\nSee the\ninstallation notes\nif you run into issues\nYou can also install it with\nDocker\nor\nconda-forge\n.\nGetting Started\nEnable the extension (do this once in each database where you want to use it)\nCREATE\nEXTENSION vector;\nCreate a vector column with 3 dimensions\nCREATE\nTABLE\nitems\n(id\nbigserial\nPRIMARY KEY\n, embedding vector(\n3\n));\nInsert vectors\nINSERT INTO\nitems (embedding)\nVALUES\n(\n'\n[1,2,3]\n'\n), (\n'\n[4,5,6]\n'\n);\nGet the nearest neighbors by L2 distance\nSELECT\n*\nFROM\nitems\nORDER BY\nembedding\n<\n-\n>\n'\n[3,1,2]\n'\nLIMIT\n5\n;\nAlso supports inner product (\n<#>\n), cosine distance (\n<=>\n), and L1 distance (\n<+>\n)\nNote:\n<#>\nreturns the negative inner product since Postgres only supports\nASC\norder index scans on operators\nStoring\nCreate a new table with a vector column\nCREATE\nTABLE\nitems\n(id\nbigserial\nPRIMARY KEY\n, embedding vector(\n3\n));\nOr add a vector column to an existing table\nALTER\nTABLE\nitems ADD COLUMN embedding vector(\n3\n);\nAlso supports\nhalf-precision\n,\nbinary\n, and\nsparse\nvectors\nInsert vectors\nINSERT INTO\nitems (embedding)\nVALUES\n(\n'\n[1,2,3]\n'\n), (\n'\n[4,5,6]\n'\n);\nOr load vectors in bulk using\nCOPY\n(\nexample\n)\nCOPY items (embedding)\nFROM\nSTDIN WITH (FORMAT BINARY);\nUpsert vectors\nINSERT INTO\nitems (id, embedding)\nVALUES\n(\n1\n,\n'\n[1,2,3]\n'\n), (\n2\n,\n'\n[4,5,6]\n'\n)\nON\nCONFLICT (id) DO\nUPDATE\nSET\nembedding\n=\nEXCLUDED\n.\nembedding\n;\nUpdate vectors\nUPDATE\nitems\nSET\nembedding\n=\n'\n[1,2,3]\n'\nWHERE\nid\n=\n1\n;\nDelete vectors\nDELETE\nFROM\nitems\nWHERE\nid\n=\n1\n;\nQuerying\nGet the nearest neighbors to a vector\nSELECT\n*\nFROM\nitems\nORDER BY\nembedding\n<\n-\n>\n'\n[3,1,2]\n'\nLIMIT\n5\n;\nSupported distance functions are:\n<->\n- L2 distance\n<#>\n- (negative) inner product\n<=>\n- cosine distance\n<+>\n- L1 distance\n<~>\n- Hamming distance (binary vectors)\n<%>\n- Jaccard distance (binary vectors)\nGet the nearest neighbors to a row\nSELECT\n*\nFROM\nitems\nWHERE\nid\n!=\n1\nORDER BY\nembedding\n<\n-\n>\n(\nSELECT\nembedding\nFROM\nitems\nWHERE\nid\n=\n1\n)\nLIMIT\n5\n;\nGet rows within a certain distance\nSELECT\n*\nFROM\nitems\nWHERE\nembedding\n<\n-\n>\n'\n[3,1,2]\n'\n<\n5\n;\nNote: Combine with\nORDER BY\nand\nLIMIT\nto use an index\nDistances\nGet the distance\nSELECT\nembedding\n<\n-\n>\n'\n[3,1,2]\n'\nAS\ndistance\nFROM\nitems;\nFor inner product, multiply by -1 (since\n<#>\nreturns the negative inner product)\nSELECT\n(embedding\n<\n#\n>\n'\n[3,1,2]'\n)\n*\n-\n1\nAS\ninner_product\nFROM\nitems;\nFor cosine similarity, use 1 - cosine distance\nSELECT\n1\n-\n(embedding\n<=>\n'\n[3,1,2]\n'\n)\nAS\ncosine_similarity\nFROM\nitems;\nAggregates\nAverage vectors\nSELECT\nAVG\n(embedding)\nFROM\nitems;\nAverage groups of vectors\nSELECT\ncategory_id,\nAVG\n(embedding)\nFROM\nitems\nGROUP BY\ncategory_id;\nIndexing\nBy default, pgvector performs exact nearest neighbor search, which provides perfect recall.\nYou can add an index to use approximate nearest neighbor search, which trades some recall for speed. Unlike typical indexes, you will see different results for queries after adding an approximate index.\nSupported index types are:\nHNSW\nIVFFlat\nHNSW\nAn HNSW index creates a multilayer graph. It has better query performance than IVFFlat (in terms of speed-recall tradeoff), but has slower build times and uses more memory. Also, an index can be created without any data in the table since there isn’t a training step like IVFFlat.\nAdd an index for each distance function you want to use.\nL2 distance\nCREATE\nINDEX\nON\nitems USING hnsw (embedding vector_l2_ops);\nNote: Use\nhalfvec_l2_ops\nfor\nhalfvec\nand\nsparsevec_l2_ops\nfor\nsparsevec\n(and similar with the other distance functions)\nInner product\nCREATE\nINDEX\nON\nitems USING hnsw (embedding vector_ip_ops);\nCosine distance\nCREATE\nINDEX\nON\nitems USING hnsw (embedding vector_cosine_ops);\nL1 distance\nCREATE\nINDEX\nON\nitems USING hnsw (embedding vector_l1_ops);\nHamming distance\nCREATE\nINDEX\nON\nitems USING hnsw (embedding bit_hamming_ops);\nJaccard distance\nCREATE\nINDEX\nON\nitems USING hnsw (embedding bit_jaccard_ops);\nSupported types are:\nvector\n- up to 2,000 dimensions\nhalfvec\n- up to 4,000 dimensions\nbit\n- up to 64,000 dimensions\nsparsevec\n- up to 1,000 non-zero elements\nIndex Options\nSpecify HNSW parameters\nm\n- the max number of connections per layer (16 by default)\nef_construction\n- the size of the dynamic candidate list for constructing the graph (64 by default)\nCREATE\nINDEX\nON\nitems USING hnsw (embedding vector_l2_ops) WITH (m\n=\n16\n, ef_construction\n=\n64\n);\nA higher value of\nef_construction\nprovides better recall at the cost of index build time / insert speed.\nQuery Options\nSpecify the size of the dynamic candidate list for search (40 by default)\nSET\nhnsw\n.\nef_search\n=\n100\n;\nA higher value provides better recall at the cost of speed.\nUse\nSET LOCAL\ninside a transaction to set it for a single query\nBEGIN\n;\nSET\nLOCAL\nhnsw\n.\nef_search\n=\n100\n;\nSELECT\n...\nCOMMIT\n;\nIndex Build Time\nIndexes build significantly faster when the graph fits into\nmaintenance_work_mem\nSET\nmaintenance_work_mem\n=\n'\n8GB\n'\n;\nA notice is shown when the graph no longer fits\nNOTICE:  hnsw graph no longer fits into maintenance_work_mem after 100000 tuples\nDETAIL:  Building will take significantly more time.\nHINT:  Increase maintenance_work_mem to speed up builds.\nNote: Do not set\nmaintenance_work_mem\nso high that it exhausts the memory on the server\nLike other index types, it’s faster to create an index after loading your initial data\nYou can also speed up index creation by increasing the number of parallel workers (2 by default)\nSET\nmax_parallel_maintenance_workers\n=\n7\n;\n--\nplus leader\nFor a large number of workers, you may need to increase\nmax_parallel_workers\n(8 by default)\nThe\nindex options\nalso have a significant impact on build time (use the defaults unless seeing low recall)\nIndexing Progress\nCheck\nindexing progress\nSELECT\nphase, round(\n100\n.\n0\n*\nblocks_done\n/\nnullif(blocks_total,\n0\n),\n1\n)\nAS\n\"\n%\n\"\nFROM\npg_stat_progress_create_index;\nThe phases for HNSW are:\ninitializing\nloading tuples\nIVFFlat\nAn IVFFlat index divides vectors into lists, and then searches a subset of those lists that are closest to the query vector. It has faster build times and uses less memory than HNSW, but has lower query performance (in terms of speed-recall tradeoff).\nThree keys to achieving good recall are:\nCreate the index\nafter\nthe table has some data\nChoose an appropriate number of lists - a good place to start is\nrows / 1000\nfor up to 1M rows and\nsqrt(rows)\nfor over 1M rows\nWhen querying, specify an appropriate number of\nprobes\n(higher is better for recall, lower is better for speed) - a good place to start is\nsqrt(lists)\nAdd an index for each distance function you want to use.\nL2 distance\nCREATE\nINDEX\nON\nitems USING ivfflat (embedding vector_l2_ops) WITH (lists\n=\n100\n);\nNote: Use\nhalfvec_l2_ops\nfor\nhalfvec\n(and similar with the other distance functions)\nInner product\nCREATE\nINDEX\nON\nitems USING ivfflat (embedding vector_ip_ops) WITH (lists\n=\n100\n);\nCosine distance\nCREATE\nINDEX\nON\nitems USING ivfflat (embedding vector_cosine_ops) WITH (lists\n=\n100\n);\nHamming distance\nCREATE\nINDEX\nON\nitems USING ivfflat (embedding bit_hamming_ops) WITH (lists\n=\n100\n);\nSupported types are:\nvector\n- up to 2,000 dimensions\nhalfvec\n- up to 4,000 dimensions\nbit\n- up to 64,000 dimensions\nQuery Options\nSpecify the number of probes (1 by default)\nSET\nivfflat\n.\nprobes\n=\n10\n;\nA higher value provides better recall at the cost of speed, and it can be set to the number of lists for exact nearest neighbor search (at which point the planner won’t use the index)\nUse\nSET LOCAL\ninside a transaction to set it for a single query\nBEGIN\n;\nSET\nLOCAL\nivfflat\n.\nprobes\n=\n10\n;\nSELECT\n...\nCOMMIT\n;\nIndex Build Time\nSpeed up index creation on large tables by increasing the number of parallel workers (2 by default)\nSET\nmax_parallel_maintenance_workers\n=\n7\n;\n--\nplus leader\nFor a large number of workers, you may also need to increase\nmax_parallel_workers\n(8 by default)\nIndexing Progress\nCheck\nindexing progress\nSELECT\nphase, round(\n100\n.\n0\n*\ntuples_done\n/\nnullif(tuples_total,\n0\n),\n1\n)\nAS\n\"\n%\n\"\nFROM\npg_stat_progress_create_index;\nThe phases for IVFFlat are:\ninitializing\nperforming k-means\nassigning tuples\nloading tuples\nNote:\n%\nis only populated during the\nloading tuples\nphase\nFiltering\nThere are a few ways to index nearest neighbor queries with a\nWHERE\nclause.\nSELECT\n*\nFROM\nitems\nWHERE\ncategory_id\n=\n123\nORDER BY\nembedding\n<\n-\n>\n'\n[3,1,2]\n'\nLIMIT\n5\n;\nA good place to start is creating an index on the filter column. This can provide fast, exact nearest neighbor search in many cases. Postgres has a number of\nindex types\nfor this: B-tree (default), hash, GiST, SP-GiST, GIN, and BRIN.\nCREATE\nINDEX\nON\nitems (category_id);\nFor multiple columns, consider a\nmulticolumn index\n.\nCREATE\nINDEX\nON\nitems (location_id, category_id);\nExact indexes work well for conditions that match a low percentage of rows. Otherwise,\napproximate indexes\ncan work better.\nCREATE\nINDEX\nON\nitems USING hnsw (embedding vector_l2_ops);\nWith approximate indexes, filtering is applied\nafter\nthe index is scanned. If a condition matches 10% of rows, with HNSW and the default\nhnsw.ef_search\nof 40, only 4 rows will match on average. For more rows, increase\nhnsw.ef_search\n.\nSET\nhnsw\n.\nef_search\n=\n200\n;\nStarting with 0.8.0, you can enable\niterative index scans\n, which will automatically scan more of the index when needed.\nSET\nhnsw\n.\niterative_scan\n=\nstrict_order;\nIf filtering by only a few distinct values, consider\npartial indexing\n.\nCREATE\nINDEX\nON\nitems USING hnsw (embedding vector_l2_ops)\nWHERE\n(category_id\n=\n123\n);\nIf filtering by many different values, consider\npartitioning\n.\nCREATE\nTABLE\nitems\n(embedding vector(\n3\n), category_id\nint\n) PARTITION BY LIST(category_id);\nIterative Index Scans\nWith approximate indexes, queries with filtering can return less results since filtering is applied\nafter\nthe index is scanned. Starting with 0.8.0, you can enable iterative index scans, which will automatically scan more of the index until enough results are found (or it reaches\nhnsw.max_scan_tuples\nor\nivfflat.max_probes\n).\nIterative scans can use strict or relaxed ordering.\nStrict ensures results are in the exact order by distance\nSET\nhnsw\n.\niterative_scan\n=\nstrict_order;\nRelaxed allows results to be slightly out of order by distance, but provides better recall\nSET\nhnsw\n.\niterative_scan\n=\nrelaxed_order;\n#\nor\nSET\nivfflat\n.\niterative_scan\n=\nrelaxed_order;\nWith relaxed ordering, you can use a\nmaterialized CTE\nto get strict ordering\nWITH relaxed_results\nAS\nMATERIALIZED (\nSELECT\nid, embedding\n<\n-\n>\n'\n[1,2,3]\n'\nAS\ndistance\nFROM\nitems\nWHERE\ncategory_id\n=\n123\nORDER BY\ndistance\nLIMIT\n5\n)\nSELECT\n*\nFROM\nrelaxed_results\nORDER BY\ndistance\n+\n0\n;\nNote:\n+ 0\nis needed for Postgres 17+\nFor queries that filter by distance, use a materialized CTE and place the distance filter outside of it for best performance (due to the\ncurrent behavior\nof the Postgres executor)\nWITH nearest_results\nAS\nMATERIALIZED (\nSELECT\nid, embedding\n<\n-\n>\n'\n[1,2,3]\n'\nAS\ndistance\nFROM\nitems\nORDER BY\ndistance\nLIMIT\n5\n)\nSELECT\n*\nFROM\nnearest_results\nWHERE\ndistance\n<\n5\nORDER BY\ndistance;\nNote: Place any other filters inside the CTE\nIterative Scan Options\nSince scanning a large portion of an approximate index is expensive, there are options to control when a scan ends.\nHNSW\nSpecify the max number of tuples to visit (20,000 by default)\nSET\nhnsw\n.\nmax_scan_tuples\n=\n20000\n;\nNote: This is approximate and does not affect the initial scan\nSpecify the max amount of memory to use, as a multiple of\nwork_mem\n(1 by default)\nSET\nhnsw\n.\nscan_mem_multiplier\n=\n2\n;\nNote: Try increasing this if increasing\nhnsw.max_scan_tuples\ndoes not improve recall\nIVFFlat\nSpecify the max number of probes\nSET\nivfflat\n.\nmax_probes\n=\n100\n;\nNote: If this is lower than\nivfflat.probes\n,\nivfflat.probes\nwill be used\nHalf-Precision Vectors\nUse the\nhalfvec\ntype to store half-precision vectors\nCREATE\nTABLE\nitems\n(id\nbigserial\nPRIMARY KEY\n, embedding halfvec(\n3\n));\nHalf-Precision Indexing\nIndex vectors at half precision for smaller indexes\nCREATE\nINDEX\nON\nitems USING hnsw ((embedding::halfvec(\n3\n)) halfvec_l2_ops);\nGet the nearest neighbors\nSELECT\n*\nFROM\nitems\nORDER BY\nembedding::halfvec(\n3\n)\n<\n-\n>\n'\n[1,2,3]\n'\nLIMIT\n5\n;\nBinary Vectors\nUse the\nbit\ntype to store binary vectors (\nexample\n)\nCREATE\nTABLE\nitems\n(id\nbigserial\nPRIMARY KEY\n, embedding\nbit\n(\n3\n));\nINSERT INTO\nitems (embedding)\nVALUES\n(\n'\n000\n'\n), (\n'\n111\n'\n);\nGet the nearest neighbors by Hamming distance\nSELECT\n*\nFROM\nitems\nORDER BY\nembedding\n<\n~\n>\n'\n101\n'\nLIMIT\n5\n;\nAlso supports Jaccard distance (\n<%>\n)\nBinary Quantization\nUse expression indexing for binary quantization\nCREATE\nINDEX\nON\nitems USING hnsw ((binary_quantize(embedding)::\nbit\n(\n3\n)) bit_hamming_ops);\nGet the nearest neighbors by Hamming distance\nSELECT\n*\nFROM\nitems\nORDER BY\nbinary_quantize(embedding)::\nbit\n(\n3\n)\n<\n~\n>\nbinary_quantize(\n'\n[1,-2,3]\n'\n)\nLIMIT\n5\n;\nRe-rank by the original vectors for better recall\nSELECT\n*\nFROM\n(\nSELECT\n*\nFROM\nitems\nORDER BY\nbinary_quantize(embedding)::\nbit\n(\n3\n)\n<\n~\n>\nbinary_quantize(\n'\n[1,-2,3]\n'\n)\nLIMIT\n20\n)\nORDER BY\nembedding\n<=>\n'\n[1,-2,3]\n'\nLIMIT\n5\n;\nSparse Vectors\nUse the\nsparsevec\ntype to store sparse vectors\nCREATE\nTABLE\nitems\n(id\nbigserial\nPRIMARY KEY\n, embedding sparsevec(\n5\n));\nInsert vectors\nINSERT INTO\nitems (embedding)\nVALUES\n(\n'\n{1:1,3:2,5:3}/5\n'\n), (\n'\n{1:4,3:5,5:6}/5\n'\n);\nThe format is\n{index1:value1,index2:value2}/dimensions\nand indices start at 1 like SQL arrays\nGet the nearest neighbors by L2 distance\nSELECT\n*\nFROM\nitems\nORDER BY\nembedding\n<\n-\n>\n'\n{1:3,3:1,5:2}/5\n'\nLIMIT\n5\n;\nHybrid Search\nUse together with Postgres\nfull-text search\nfor hybrid search.\nSELECT\nid, content\nFROM\nitems, plainto_tsquery(\n'\nhello search\n'\n) query\nWHERE\ntextsearch @@ query\nORDER BY\nts_rank_cd(textsearch, query)\nDESC\nLIMIT\n5\n;\nYou can use\nReciprocal Rank Fusion\nor a\ncross-encoder\nto combine results.\nIndexing Subvectors\nUse expression indexing to index subvectors\nCREATE\nINDEX\nON\nitems USING hnsw ((subvector(embedding,\n1\n,\n3\n)::vector(\n3\n)) vector_cosine_ops);\nGet the nearest neighbors by cosine distance\nSELECT\n*\nFROM\nitems\nORDER BY\nsubvector(embedding,\n1\n,\n3\n)::vector(\n3\n)\n<=>\nsubvector(\n'\n[1,2,3,4,5]\n'\n::vector,\n1\n,\n3\n)\nLIMIT\n5\n;\nRe-rank by the full vectors for better recall\nSELECT\n*\nFROM\n(\nSELECT\n*\nFROM\nitems\nORDER BY\nsubvector(embedding,\n1\n,\n3\n)::vector(\n3\n)\n<=>\nsubvector(\n'\n[1,2,3,4,5]\n'\n::vector,\n1\n,\n3\n)\nLIMIT\n20\n)\nORDER BY\nembedding\n<=>\n'\n[1,2,3,4,5]\n'\nLIMIT\n5\n;\nPerformance\nTuning\nUse a tool like\nPgTune\nto set initial values for Postgres server parameters. For instance,\nshared_buffers\nshould typically be 25% of the server’s memory. You can find the config file with:\nSHOW config_file;\nAnd check individual settings with:\nSHOW shared_buffers;\nBe sure to restart Postgres for changes to take effect.\nLoading\nUse\nCOPY\nfor bulk loading data (\nexample\n).\nCOPY items (embedding)\nFROM\nSTDIN WITH (FORMAT BINARY);\nAdd any indexes\nafter\nloading the initial data for best performance.\nIndexing\nSee index build time for\nHNSW\nand\nIVFFlat\n.\nIn production environments, create indexes concurrently to avoid blocking writes.\nCREATE\nINDEX\nCONCURRENTLY\n...\nQuerying\nUse\nEXPLAIN (ANALYZE, BUFFERS)\nto debug performance.\nEXPLAIN (ANALYZE, BUFFERS)\nSELECT\n*\nFROM\nitems\nORDER BY\nembedding\n<\n-\n>\n'\n[3,1,2]\n'\nLIMIT\n5\n;\nExact Search\nTo speed up queries without an index, increase\nmax_parallel_workers_per_gather\n.\nSET\nmax_parallel_workers_per_gather\n=\n4\n;\nIf vectors are normalized to length 1 (like\nOpenAI embeddings\n), use inner product for best performance.\nSELECT\n*\nFROM\nitems\nORDER BY\nembedding\n<\n#\n>\n'\n[3,1,2]'\nLIMIT\n5\n;\nApproximate Search\nTo speed up queries with an IVFFlat index, increase the number of inverted lists (at the expense of recall).\nCREATE\nINDEX\nON\nitems USING ivfflat (embedding vector_l2_ops) WITH (lists\n=\n1000\n);\nVacuuming\nVacuuming can take a while for HNSW indexes. Speed it up by reindexing first.\nREINDEX INDEX CONCURRENTLY index_name;\nVACUUM table_name;\nMonitoring\nMonitor performance with\npg_stat_statements\n(be sure to add it to\nshared_preload_libraries\n).\nCREATE EXTENSION pg_stat_statements;\nGet the most time-consuming queries with:\nSELECT\nquery, calls, ROUND((total_plan_time\n+\ntotal_exec_time)\n/\ncalls)\nAS\navg_time_ms,\n    ROUND((total_plan_time\n+\ntotal_exec_time)\n/\n60000\n)\nAS\ntotal_time_min\nFROM\npg_stat_statements\nORDER BY\ntotal_plan_time\n+\ntotal_exec_time\nDESC\nLIMIT\n20\n;\nMonitor recall by comparing results from approximate search with exact search.\nBEGIN\n;\nSET\nLOCAL enable_indexscan\n=\noff;\n--\nuse exact search\nSELECT\n...\nCOMMIT\n;\nScaling\nScale pgvector the same way you scale Postgres.\nScale vertically by increasing memory, CPU, and storage on a single instance. Use existing tools to\ntune parameters\nand\nmonitor performance\n.\nScale horizontally with\nreplicas\n, or use\nCitus\nor another approach for sharding (\nexample\n).\nLanguages\nUse pgvector from any language with a Postgres client. You can even generate and store vectors in one language and query them in another.\nLanguage\nLibraries / Examples\nAda\npgvector-ada\nAlgol\npgvector-algol\nC\npgvector-c\nC++\npgvector-cpp\nC#, F#, Visual Basic\npgvector-dotnet\nCOBOL\npgvector-cobol\nCrystal\npgvector-crystal\nD\npgvector-d\nDart\npgvector-dart\nElixir\npgvector-elixir\nErlang\npgvector-erlang\nFortran\npgvector-fortran\nGleam\npgvector-gleam\nGo\npgvector-go\nHaskell\npgvector-haskell\nJava, Kotlin, Groovy, Scala\npgvector-java\nJavaScript, TypeScript\npgvector-node\nJulia\nPgvector.jl\nLisp\npgvector-lisp\nLua\npgvector-lua\nNim\npgvector-nim\nOCaml\npgvector-ocaml\nPascal\npgvector-pascal\nPerl\npgvector-perl\nPHP\npgvector-php\nProlog\npgvector-prolog\nPython\npgvector-python\nR\npgvector-r\nRacket\npgvector-racket\nRaku\npgvector-raku\nRuby\npgvector-ruby\n,\nNeighbor\nRust\npgvector-rust\nSwift\npgvector-swift\nTcl\npgvector-tcl\nZig\npgvector-zig\nFrequently Asked Questions\nHow many vectors can be stored in a single table?\nA non-partitioned table has a limit of 32 TB by default in Postgres. A partitioned table can have thousands of partitions of that size.\nIs replication supported?\nYes, pgvector uses the write-ahead log (WAL), which allows for replication and point-in-time recovery.\nWhat if I want to index vectors with more than 2,000 dimensions?\nYou can use\nhalf-precision vectors\nor\nhalf-precision indexing\nto index up to 4,000 dimensions or\nbinary quantization\nto index up to 64,000 dimensions. Other options are\nindexing subvectors\n(for models that support it) or\ndimensionality reduction\n.\nCan I store vectors with different dimensions in the same column?\nYou can use\nvector\nas the type (instead of\nvector(n)\n).\nCREATE\nTABLE\nembeddings\n(model_id\nbigint\n, item_id\nbigint\n, embedding vector,\nPRIMARY KEY\n(model_id, item_id));\nHowever, you can only create indexes on rows with the same number of dimensions (using\nexpression\nand\npartial\nindexing):\nCREATE\nINDEX\nON\nembeddings USING hnsw ((embedding::vector(\n3\n)) vector_l2_ops)\nWHERE\n(model_id\n=\n123\n);\nand query with:\nSELECT\n*\nFROM\nembeddings\nWHERE\nmodel_id\n=\n123\nORDER BY\nembedding::vector(\n3\n)\n<\n-\n>\n'\n[3,1,2]\n'\nLIMIT\n5\n;\nCan I store vectors with more precision?\nYou can use the\ndouble precision[]\nor\nnumeric[]\ntype to store vectors with more precision.\nCREATE\nTABLE\nitems\n(id\nbigserial\nPRIMARY KEY\n, embedding\ndouble precision\n[]);\n--\nuse {} instead of [] for Postgres arrays\nINSERT INTO\nitems (embedding)\nVALUES\n(\n'\n{1,2,3}\n'\n), (\n'\n{4,5,6}\n'\n);\nOptionally, add a\ncheck constraint\nto ensure data can be converted to the\nvector\ntype and has the expected dimensions.\nALTER\nTABLE\nitems ADD\nCHECK\n(vector_dims(embedding::vector)\n=\n3\n);\nUse\nexpression indexing\nto index (at a lower precision):\nCREATE\nINDEX\nON\nitems USING hnsw ((embedding::vector(\n3\n)) vector_l2_ops);\nand query with:\nSELECT\n*\nFROM\nitems\nORDER BY\nembedding::vector(\n3\n)\n<\n-\n>\n'\n[3,1,2]\n'\nLIMIT\n5\n;\nDo indexes need to fit into memory?\nNo, but like other index types, you’ll likely see better performance if they do. You can get the size of an index with:\nSELECT\npg_size_pretty(pg_relation_size(\n'\nindex_name\n'\n));\nTroubleshooting\nWhy isn’t a query using an index?\nThe query needs to have an\nORDER BY\nand\nLIMIT\n, and the\nORDER BY\nmust be the result of a distance operator (not an expression) in ascending order.\n--\nindex\nORDER BY\nembedding\n<=>\n'\n[3,1,2]\n'\nLIMIT\n5\n;\n--\nno index\nORDER BY\n1\n-\n(embedding\n<=>\n'\n[3,1,2]\n'\n)\nDESC\nLIMIT\n5\n;\nYou can encourage the planner to use an index for a query with:\nBEGIN\n;\nSET\nLOCAL enable_seqscan\n=\noff;\nSELECT\n...\nCOMMIT\n;\nAlso, if the table is small, a table scan may be faster.\nWhy isn’t a query using a parallel table scan?\nThe planner doesn’t consider\nout-of-line storage\nin cost estimates, which can make a serial scan look cheaper. You can reduce the cost of a parallel scan for a query with:\nBEGIN\n;\nSET\nLOCAL min_parallel_table_scan_size\n=\n1\n;\nSET\nLOCAL parallel_setup_cost\n=\n1\n;\nSELECT\n...\nCOMMIT\n;\nor choose to store vectors inline:\nALTER\nTABLE\nitems ALTER COLUMN embedding\nSET\nSTORAGE PLAIN;\nWhy are there less results for a query after adding an HNSW index?\nResults are limited by the size of the dynamic candidate list (\nhnsw.ef_search\n), which is 40 by default. There may be even less results due to dead tuples or filtering conditions in the query. Enabling\niterative index scans\ncan help address this.\nAlso, note that\nNULL\nvectors are not indexed (as well as zero vectors for cosine distance).\nWhy are there less results for a query after adding an IVFFlat index?\nThe index was likely created with too little data for the number of lists. Drop the index until the table has more data.\nDROP\nINDEX\nindex_name;\nResults can also be limited by the number of probes (\nivfflat.probes\n). Enabling\niterative index scans\ncan address this.\nAlso, note that\nNULL\nvectors are not indexed (as well as zero vectors for cosine distance).\nReference\nVector\nHalfvec\nBit\nSparsevec\nVector Type\nEach vector takes\n4 * dimensions + 8\nbytes of storage. Each element is a single-precision floating-point number (like the\nreal\ntype in Postgres), and all elements must be finite (no\nNaN\n,\nInfinity\nor\n-Infinity\n). Vectors can have up to 16,000 dimensions.\nVector Operators\nOperator\nDescription\nAdded\n+\nelement-wise addition\n-\nelement-wise subtraction\n*\nelement-wise multiplication\n0.5.0\n||\nconcatenate\n0.7.0\n<->\nEuclidean distance\n<#>\nnegative inner product\n<=>\ncosine distance\n<+>\ntaxicab distance\n0.7.0\nVector Functions\nFunction\nDescription\nAdded\nbinary_quantize(vector) → bit\nbinary quantize\n0.7.0\ncosine_distance(vector, vector) → double precision\ncosine distance\ninner_product(vector, vector) → double precision\ninner product\nl1_distance(vector, vector) → double precision\ntaxicab distance\n0.5.0\nl2_distance(vector, vector) → double precision\nEuclidean distance\nl2_normalize(vector) → vector\nNormalize with Euclidean norm\n0.7.0\nsubvector(vector, integer, integer) → vector\nsubvector\n0.7.0\nvector_dims(vector) → integer\nnumber of dimensions\nvector_norm(vector) → double precision\nEuclidean norm\nVector Aggregate Functions\nFunction\nDescription\nAdded\navg(vector) → vector\naverage\nsum(vector) → vector\nsum\n0.5.0\nHalfvec Type\nEach half vector takes\n2 * dimensions + 8\nbytes of storage. Each element is a half-precision floating-point number, and all elements must be finite (no\nNaN\n,\nInfinity\nor\n-Infinity\n). Half vectors can have up to 16,000 dimensions.\nHalfvec Operators\nOperator\nDescription\nAdded\n+\nelement-wise addition\n0.7.0\n-\nelement-wise subtraction\n0.7.0\n*\nelement-wise multiplication\n0.7.0\n||\nconcatenate\n0.7.0\n<->\nEuclidean distance\n0.7.0\n<#>\nnegative inner product\n0.7.0\n<=>\ncosine distance\n0.7.0\n<+>\ntaxicab distance\n0.7.0\nHalfvec Functions\nFunction\nDescription\nAdded\nbinary_quantize(halfvec) → bit\nbinary quantize\n0.7.0\ncosine_distance(halfvec, halfvec) → double precision\ncosine distance\n0.7.0\ninner_product(halfvec, halfvec) → double precision\ninner product\n0.7.0\nl1_distance(halfvec, halfvec) → double precision\ntaxicab distance\n0.7.0\nl2_distance(halfvec, halfvec) → double precision\nEuclidean distance\n0.7.0\nl2_norm(halfvec) → double precision\nEuclidean norm\n0.7.0\nl2_normalize(halfvec) → halfvec\nNormalize with Euclidean norm\n0.7.0\nsubvector(halfvec, integer, integer) → halfvec\nsubvector\n0.7.0\nvector_dims(halfvec) → integer\nnumber of dimensions\n0.7.0\nHalfvec Aggregate Functions\nFunction\nDescription\nAdded\navg(halfvec) → halfvec\naverage\n0.7.0\nsum(halfvec) → halfvec\nsum\n0.7.0\nBit Type\nEach bit vector takes\ndimensions / 8 + 8\nbytes of storage. See the\nPostgres docs\nfor more info.\nBit Operators\nOperator\nDescription\nAdded\n<~>\nHamming distance\n0.7.0\n<%>\nJaccard distance\n0.7.0\nBit Functions\nFunction\nDescription\nAdded\nhamming_distance(bit, bit) → double precision\nHamming distance\n0.7.0\njaccard_distance(bit, bit) → double precision\nJaccard distance\n0.7.0\nSparsevec Type\nEach sparse vector takes\n8 * non-zero elements + 16\nbytes of storage. Each element is a single-precision floating-point number, and all elements must be finite (no\nNaN\n,\nInfinity\nor\n-Infinity\n). Sparse vectors can have up to 16,000 non-zero elements.\nSparsevec Operators\nOperator\nDescription\nAdded\n<->\nEuclidean distance\n0.7.0\n<#>\nnegative inner product\n0.7.0\n<=>\ncosine distance\n0.7.0\n<+>\ntaxicab distance\n0.7.0\nSparsevec Functions\nFunction\nDescription\nAdded\ncosine_distance(sparsevec, sparsevec) → double precision\ncosine distance\n0.7.0\ninner_product(sparsevec, sparsevec) → double precision\ninner product\n0.7.0\nl1_distance(sparsevec, sparsevec) → double precision\ntaxicab distance\n0.7.0\nl2_distance(sparsevec, sparsevec) → double precision\nEuclidean distance\n0.7.0\nl2_norm(sparsevec) → double precision\nEuclidean norm\n0.7.0\nl2_normalize(sparsevec) → sparsevec\nNormalize with Euclidean norm\n0.7.0\nInstallation Notes - Linux and Mac\nPostgres Location\nIf your machine has multiple Postgres installations, specify the path to\npg_config\nwith:\nexport\nPG_CONFIG=/Library/PostgreSQL/18/bin/pg_config\nThen re-run the installation instructions (run\nmake clean\nbefore\nmake\nif needed). If\nsudo\nis needed for\nmake install\n, use:\nsudo --preserve-env=PG_CONFIG make install\nA few common paths on Mac are:\nEDB installer -\n/Library/PostgreSQL/18/bin/pg_config\nHomebrew (arm64) -\n/opt/homebrew/opt/postgresql@18/bin/pg_config\nHomebrew (x86-64) -\n/usr/local/opt/postgresql@18/bin/pg_config\nNote: Replace\n18\nwith your Postgres server version\nMissing Header\nIf compilation fails with\nfatal error: postgres.h: No such file or directory\n, make sure Postgres development files are installed on the server.\nFor Ubuntu and Debian, use:\nsudo apt install postgresql-server-dev-18\nNote: Replace\n18\nwith your Postgres server version\nMissing SDK\nIf compilation fails and the output includes\nwarning: no such sysroot directory\non Mac, your Postgres installation points to a path that no longer exists.\npg_config --cppflags\nReinstall Postgres to fix this.\nPortability\nBy default, pgvector compiles with\n-march=native\non some platforms for best performance. However, this can lead to\nIllegal instruction\nerrors if trying to run the compiled extension on a different machine.\nTo compile for portability, use:\nmake OPTFLAGS=\n\"\n\"\nInstallation Notes - Windows\nMissing Header\nIf compilation fails with\nCannot open include file: 'postgres.h': No such file or directory\n, make sure\nPGROOT\nis correct.\nMismatched Architecture\nIf compilation fails with\nerror C2196: case value '4' already used\n, make sure you’re using the\nx64 Native Tools Command Prompt\n. Then run\nnmake /F Makefile.win clean\nand re-run the installation instructions.\nMissing Symbol\nIf linking fails with\nunresolved external symbol float_to_shortest_decimal_bufn\nwith Postgres 17.0-17.2, upgrade to Postgres 17.3+.\nPermissions\nIf installation fails with\nAccess is denied\n, re-run the installation instructions as an administrator.\nAdditional Installation Methods\nDocker\nGet the\nDocker image\nwith:\ndocker pull pgvector/pgvector:pg18-trixie\nThis adds pgvector to the\nPostgres image\n(replace\n18\nwith your Postgres server version, and run it the same way).\nSupported tags are:\npg18-trixie\n,\n0.8.1-pg18-trixie\npg18-bookworm\n,\n0.8.1-pg18-bookworm\n,\npg18\n,\n0.8.1-pg18\npg17-trixie\n,\n0.8.1-pg17-trixie\npg17-bookworm\n,\n0.8.1-pg17-bookworm\n,\npg17\n,\n0.8.1-pg17\npg16-trixie\n,\n0.8.1-pg16-trixie\npg16-bookworm\n,\n0.8.1-pg16-bookworm\n,\npg16\n,\n0.8.1-pg16\npg15-trixie\n,\n0.8.1-pg15-trixie\npg15-bookworm\n,\n0.8.1-pg15-bookworm\n,\npg15\n,\n0.8.1-pg15\npg14-trixie\n,\n0.8.1-pg14-trixie\npg14-bookworm\n,\n0.8.1-pg14-bookworm\n,\npg14\n,\n0.8.1-pg14\npg13-trixie\n,\n0.8.1-pg13-trixie\npg13-bookworm\n,\n0.8.1-pg13-bookworm\n,\npg13\n,\n0.8.1-pg13\nYou can also build the image manually:\ngit clone --branch v0.8.1 https://github.com/pgvector/pgvector.git\ncd\npgvector\ndocker build --pull --build-arg PG_MAJOR=18 -t myuser/pgvector\n.\nIf you increase\nmaintenance_work_mem\n, make sure\n--shm-size\nis at least that size to avoid an error with parallel HNSW index builds.\ndocker run --shm-size=1g ...\nHomebrew\nWith Homebrew Postgres, you can use:\nbrew install pgvector\nNote: This only adds it to the\npostgresql@18\nand\npostgresql@17\nformulas\nPGXN\nInstall from the\nPostgreSQL Extension Network\nwith:\npgxn install vector\nAPT\nDebian and Ubuntu packages are available from the\nPostgreSQL APT Repository\n. Follow the\nsetup instructions\nand run:\nsudo apt install postgresql-18-pgvector\nNote: Replace\n18\nwith your Postgres server version\nYum\nRPM packages are available from the\nPostgreSQL Yum Repository\n. Follow the\nsetup instructions\nfor your distribution and run:\nsudo yum install pgvector_18\n#\nor\nsudo dnf install pgvector_18\nNote: Replace\n18\nwith your Postgres server version\npkg\nInstall the FreeBSD package with:\npkg install postgresql17-pgvector\nor the port with:\ncd\n/usr/ports/databases/pgvector\nmake install\nAPK\nInstall the Alpine package with:\napk add postgresql-pgvector\nconda-forge\nWith Conda Postgres, install from\nconda-forge\nwith:\nconda install -c conda-forge pgvector\nThis method is\ncommunity-maintained\nby\n@mmcauliffe\nPostgres.app\nDownload the\nlatest release\nwith Postgres 15+.\nHosted Postgres\npgvector is available on\nthese providers\n.\nUpgrading\nInstall\nthe latest version (use the same method as the original installation). Then in each database you want to upgrade, run:\nALTER EXTENSION vector\nUPDATE\n;\nYou can check the version in the current database with:\nSELECT\nextversion\nFROM\npg_extension\nWHERE\nextname\n=\n'\nvector\n'\n;\nThanks\nThanks to:\nPASE: PostgreSQL Ultra-High-Dimensional Approximate Nearest Neighbor Search Extension\nFaiss: A Library for Efficient Similarity Search and Clustering of Dense Vectors\nUsing the Triangle Inequality to Accelerate k-means\nk-means++: The Advantage of Careful Seeding\nConcept Decompositions for Large Sparse Text Data using Clustering\nEfficient and Robust Approximate Nearest Neighbor Search using Hierarchical Navigable Small World Graphs\nHistory\nView the\nchangelog\nContributing\nEveryone is encouraged to help improve this project. Here are a few ways you can help:\nReport bugs\nFix bugs and\nsubmit pull requests\nWrite, clarify, or fix documentation\nSuggest or add new features\nTo get started with development:\ngit clone https://github.com/pgvector/pgvector.git\ncd\npgvector\nmake\nmake install\nTo run all tests:\nmake installcheck\n#\nregression tests\nmake prove_installcheck\n#\nTAP tests\nTo run single tests:\nmake installcheck REGRESS=functions\n#\nregression test\nmake prove_installcheck PROVE_TESTS=test/t/001_ivfflat_wal.pl\n#\nTAP test\nTo enable assertions:\nmake clean\n&&\nPG_CFLAGS=\n\"\n-DUSE_ASSERT_CHECKING\n\"\nmake\n&&\nmake install\nTo enable benchmarking:\nmake clean\n&&\nPG_CFLAGS=\n\"\n-DIVFFLAT_BENCH\n\"\nmake\n&&\nmake install\nTo show memory usage:\nmake clean\n&&\nPG_CFLAGS=\n\"\n-DHNSW_MEMORY -DIVFFLAT_MEMORY\n\"\nmake\n&&\nmake install\nTo get k-means metrics:\nmake clean\n&&\nPG_CFLAGS=\n\"\n-DIVFFLAT_KMEANS_DEBUG\n\"\nmake\n&&\nmake install\nResources for contributors\nExtension Building Infrastructure\nIndex Access Method Interface Definition\nGeneric WAL Records",
      "code_blocks": [
        {
          "lang": "",
          "code": "cd /tmp\ngit clone --branch v0.8.1 https://github.com/pgvector/pgvector.git\ncd pgvector\nmake\nmake install # may need sudo"
        },
        {
          "lang": "",
          "code": "set \"PGROOT=C:\\Program Files\\PostgreSQL\\18\"\ncd %TEMP%\ngit clone --branch v0.8.1 https://github.com/pgvector/pgvector.git\ncd pgvector\nnmake /F Makefile.win\nnmake /F Makefile.win install"
        },
        {
          "lang": "",
          "code": "CREATE EXTENSION vector;"
        },
        {
          "lang": "",
          "code": "CREATE TABLE items (id bigserial PRIMARY KEY, embedding vector(3));"
        },
        {
          "lang": "",
          "code": "INSERT INTO items (embedding) VALUES ('[1,2,3]'), ('[4,5,6]');"
        },
        {
          "lang": "",
          "code": "SELECT * FROM items ORDER BY embedding <-> '[3,1,2]' LIMIT 5;"
        },
        {
          "lang": "",
          "code": "CREATE TABLE items (id bigserial PRIMARY KEY, embedding vector(3));"
        },
        {
          "lang": "",
          "code": "ALTER TABLE items ADD COLUMN embedding vector(3);"
        },
        {
          "lang": "",
          "code": "INSERT INTO items (embedding) VALUES ('[1,2,3]'), ('[4,5,6]');"
        },
        {
          "lang": "",
          "code": "COPY items (embedding) FROM STDIN WITH (FORMAT BINARY);"
        },
        {
          "lang": "",
          "code": "INSERT INTO items (id, embedding) VALUES (1, '[1,2,3]'), (2, '[4,5,6]')\n    ON CONFLICT (id) DO UPDATE SET embedding = EXCLUDED.embedding;"
        },
        {
          "lang": "",
          "code": "UPDATE items SET embedding = '[1,2,3]' WHERE id = 1;"
        },
        {
          "lang": "",
          "code": "DELETE FROM items WHERE id = 1;"
        },
        {
          "lang": "",
          "code": "SELECT * FROM items ORDER BY embedding <-> '[3,1,2]' LIMIT 5;"
        },
        {
          "lang": "",
          "code": "SELECT * FROM items WHERE id != 1 ORDER BY embedding <-> (SELECT embedding FROM items WHERE id = 1) LIMIT 5;"
        },
        {
          "lang": "",
          "code": "SELECT * FROM items WHERE embedding <-> '[3,1,2]' < 5;"
        },
        {
          "lang": "",
          "code": "SELECT embedding <-> '[3,1,2]' AS distance FROM items;"
        },
        {
          "lang": "",
          "code": "SELECT (embedding <#> '[3,1,2]') * -1 AS inner_product FROM items;"
        },
        {
          "lang": "",
          "code": "SELECT 1 - (embedding <=> '[3,1,2]') AS cosine_similarity FROM items;"
        },
        {
          "lang": "",
          "code": "SELECT AVG(embedding) FROM items;"
        },
        {
          "lang": "",
          "code": "SELECT category_id, AVG(embedding) FROM items GROUP BY category_id;"
        },
        {
          "lang": "",
          "code": "CREATE INDEX ON items USING hnsw (embedding vector_l2_ops);"
        },
        {
          "lang": "",
          "code": "CREATE INDEX ON items USING hnsw (embedding vector_ip_ops);"
        },
        {
          "lang": "",
          "code": "CREATE INDEX ON items USING hnsw (embedding vector_cosine_ops);"
        },
        {
          "lang": "",
          "code": "CREATE INDEX ON items USING hnsw (embedding vector_l1_ops);"
        },
        {
          "lang": "",
          "code": "CREATE INDEX ON items USING hnsw (embedding bit_hamming_ops);"
        },
        {
          "lang": "",
          "code": "CREATE INDEX ON items USING hnsw (embedding bit_jaccard_ops);"
        },
        {
          "lang": "",
          "code": "CREATE INDEX ON items USING hnsw (embedding vector_l2_ops) WITH (m = 16, ef_construction = 64);"
        },
        {
          "lang": "",
          "code": "SET hnsw.ef_search = 100;"
        },
        {
          "lang": "",
          "code": "BEGIN;\nSET LOCAL hnsw.ef_search = 100;\nSELECT ...\nCOMMIT;"
        },
        {
          "lang": "",
          "code": "SET maintenance_work_mem = '8GB';"
        },
        {
          "lang": "",
          "code": "NOTICE:  hnsw graph no longer fits into maintenance_work_mem after 100000 tuples\nDETAIL:  Building will take significantly more time.\nHINT:  Increase maintenance_work_mem to speed up builds.\n"
        },
        {
          "lang": "",
          "code": "SET max_parallel_maintenance_workers = 7; -- plus leader"
        },
        {
          "lang": "",
          "code": "SELECT phase, round(100.0 * blocks_done / nullif(blocks_total, 0), 1) AS \"%\" FROM pg_stat_progress_create_index;"
        },
        {
          "lang": "",
          "code": "CREATE INDEX ON items USING ivfflat (embedding vector_l2_ops) WITH (lists = 100);"
        },
        {
          "lang": "",
          "code": "CREATE INDEX ON items USING ivfflat (embedding vector_ip_ops) WITH (lists = 100);"
        },
        {
          "lang": "",
          "code": "CREATE INDEX ON items USING ivfflat (embedding vector_cosine_ops) WITH (lists = 100);"
        },
        {
          "lang": "",
          "code": "CREATE INDEX ON items USING ivfflat (embedding bit_hamming_ops) WITH (lists = 100);"
        },
        {
          "lang": "",
          "code": "SET ivfflat.probes = 10;"
        },
        {
          "lang": "",
          "code": "BEGIN;\nSET LOCAL ivfflat.probes = 10;\nSELECT ...\nCOMMIT;"
        },
        {
          "lang": "",
          "code": "SET max_parallel_maintenance_workers = 7; -- plus leader"
        },
        {
          "lang": "",
          "code": "SELECT phase, round(100.0 * tuples_done / nullif(tuples_total, 0), 1) AS \"%\" FROM pg_stat_progress_create_index;"
        },
        {
          "lang": "",
          "code": "SELECT * FROM items WHERE category_id = 123 ORDER BY embedding <-> '[3,1,2]' LIMIT 5;"
        },
        {
          "lang": "",
          "code": "CREATE INDEX ON items (category_id);"
        },
        {
          "lang": "",
          "code": "CREATE INDEX ON items (location_id, category_id);"
        },
        {
          "lang": "",
          "code": "CREATE INDEX ON items USING hnsw (embedding vector_l2_ops);"
        },
        {
          "lang": "",
          "code": "SET hnsw.ef_search = 200;"
        },
        {
          "lang": "",
          "code": "SET hnsw.iterative_scan = strict_order;"
        },
        {
          "lang": "",
          "code": "CREATE INDEX ON items USING hnsw (embedding vector_l2_ops) WHERE (category_id = 123);"
        },
        {
          "lang": "",
          "code": "CREATE TABLE items (embedding vector(3), category_id int) PARTITION BY LIST(category_id);"
        },
        {
          "lang": "",
          "code": "SET hnsw.iterative_scan = strict_order;"
        },
        {
          "lang": "",
          "code": "SET hnsw.iterative_scan = relaxed_order;\n# or\nSET ivfflat.iterative_scan = relaxed_order;"
        },
        {
          "lang": "",
          "code": "WITH relaxed_results AS MATERIALIZED (\n    SELECT id, embedding <-> '[1,2,3]' AS distance FROM items WHERE category_id = 123 ORDER BY distance LIMIT 5\n) SELECT * FROM relaxed_results ORDER BY distance + 0;"
        },
        {
          "lang": "",
          "code": "WITH nearest_results AS MATERIALIZED (\n    SELECT id, embedding <-> '[1,2,3]' AS distance FROM items ORDER BY distance LIMIT 5\n) SELECT * FROM nearest_results WHERE distance < 5 ORDER BY distance;"
        },
        {
          "lang": "",
          "code": "SET hnsw.max_scan_tuples = 20000;"
        },
        {
          "lang": "",
          "code": "SET hnsw.scan_mem_multiplier = 2;"
        },
        {
          "lang": "",
          "code": "SET ivfflat.max_probes = 100;"
        },
        {
          "lang": "",
          "code": "CREATE TABLE items (id bigserial PRIMARY KEY, embedding halfvec(3));"
        },
        {
          "lang": "",
          "code": "CREATE INDEX ON items USING hnsw ((embedding::halfvec(3)) halfvec_l2_ops);"
        },
        {
          "lang": "",
          "code": "SELECT * FROM items ORDER BY embedding::halfvec(3) <-> '[1,2,3]' LIMIT 5;"
        },
        {
          "lang": "",
          "code": "CREATE TABLE items (id bigserial PRIMARY KEY, embedding bit(3));\nINSERT INTO items (embedding) VALUES ('000'), ('111');"
        },
        {
          "lang": "",
          "code": "SELECT * FROM items ORDER BY embedding <~> '101' LIMIT 5;"
        },
        {
          "lang": "",
          "code": "CREATE INDEX ON items USING hnsw ((binary_quantize(embedding)::bit(3)) bit_hamming_ops);"
        },
        {
          "lang": "",
          "code": "SELECT * FROM items ORDER BY binary_quantize(embedding)::bit(3) <~> binary_quantize('[1,-2,3]') LIMIT 5;"
        },
        {
          "lang": "",
          "code": "SELECT * FROM (\n    SELECT * FROM items ORDER BY binary_quantize(embedding)::bit(3) <~> binary_quantize('[1,-2,3]') LIMIT 20\n) ORDER BY embedding <=> '[1,-2,3]' LIMIT 5;"
        },
        {
          "lang": "",
          "code": "CREATE TABLE items (id bigserial PRIMARY KEY, embedding sparsevec(5));"
        },
        {
          "lang": "",
          "code": "INSERT INTO items (embedding) VALUES ('{1:1,3:2,5:3}/5'), ('{1:4,3:5,5:6}/5');"
        },
        {
          "lang": "",
          "code": "SELECT * FROM items ORDER BY embedding <-> '{1:3,3:1,5:2}/5' LIMIT 5;"
        },
        {
          "lang": "",
          "code": "SELECT id, content FROM items, plainto_tsquery('hello search') query\n    WHERE textsearch @@ query ORDER BY ts_rank_cd(textsearch, query) DESC LIMIT 5;"
        },
        {
          "lang": "",
          "code": "CREATE INDEX ON items USING hnsw ((subvector(embedding, 1, 3)::vector(3)) vector_cosine_ops);"
        },
        {
          "lang": "",
          "code": "SELECT * FROM items ORDER BY subvector(embedding, 1, 3)::vector(3) <=> subvector('[1,2,3,4,5]'::vector, 1, 3) LIMIT 5;"
        },
        {
          "lang": "",
          "code": "SELECT * FROM (\n    SELECT * FROM items ORDER BY subvector(embedding, 1, 3)::vector(3) <=> subvector('[1,2,3,4,5]'::vector, 1, 3) LIMIT 20\n) ORDER BY embedding <=> '[1,2,3,4,5]' LIMIT 5;"
        },
        {
          "lang": "",
          "code": "SHOW config_file;"
        },
        {
          "lang": "",
          "code": "SHOW shared_buffers;"
        },
        {
          "lang": "",
          "code": "COPY items (embedding) FROM STDIN WITH (FORMAT BINARY);"
        },
        {
          "lang": "",
          "code": "CREATE INDEX CONCURRENTLY ..."
        },
        {
          "lang": "",
          "code": "EXPLAIN (ANALYZE, BUFFERS) SELECT * FROM items ORDER BY embedding <-> '[3,1,2]' LIMIT 5;"
        },
        {
          "lang": "",
          "code": "SET max_parallel_workers_per_gather = 4;"
        },
        {
          "lang": "",
          "code": "SELECT * FROM items ORDER BY embedding <#> '[3,1,2]' LIMIT 5;"
        },
        {
          "lang": "",
          "code": "CREATE INDEX ON items USING ivfflat (embedding vector_l2_ops) WITH (lists = 1000);"
        },
        {
          "lang": "",
          "code": "REINDEX INDEX CONCURRENTLY index_name;\nVACUUM table_name;"
        },
        {
          "lang": "",
          "code": "CREATE EXTENSION pg_stat_statements;"
        },
        {
          "lang": "",
          "code": "SELECT query, calls, ROUND((total_plan_time + total_exec_time) / calls) AS avg_time_ms,\n    ROUND((total_plan_time + total_exec_time) / 60000) AS total_time_min\n    FROM pg_stat_statements ORDER BY total_plan_time + total_exec_time DESC LIMIT 20;"
        },
        {
          "lang": "",
          "code": "BEGIN;\nSET LOCAL enable_indexscan = off; -- use exact search\nSELECT ...\nCOMMIT;"
        },
        {
          "lang": "",
          "code": "CREATE TABLE embeddings (model_id bigint, item_id bigint, embedding vector, PRIMARY KEY (model_id, item_id));"
        },
        {
          "lang": "",
          "code": "CREATE INDEX ON embeddings USING hnsw ((embedding::vector(3)) vector_l2_ops) WHERE (model_id = 123);"
        },
        {
          "lang": "",
          "code": "SELECT * FROM embeddings WHERE model_id = 123 ORDER BY embedding::vector(3) <-> '[3,1,2]' LIMIT 5;"
        },
        {
          "lang": "",
          "code": "CREATE TABLE items (id bigserial PRIMARY KEY, embedding double precision[]);\n\n-- use {} instead of [] for Postgres arrays\nINSERT INTO items (embedding) VALUES ('{1,2,3}'), ('{4,5,6}');"
        },
        {
          "lang": "",
          "code": "ALTER TABLE items ADD CHECK (vector_dims(embedding::vector) = 3);"
        },
        {
          "lang": "",
          "code": "CREATE INDEX ON items USING hnsw ((embedding::vector(3)) vector_l2_ops);"
        },
        {
          "lang": "",
          "code": "SELECT * FROM items ORDER BY embedding::vector(3) <-> '[3,1,2]' LIMIT 5;"
        },
        {
          "lang": "",
          "code": "SELECT pg_size_pretty(pg_relation_size('index_name'));"
        },
        {
          "lang": "",
          "code": "-- index\nORDER BY embedding <=> '[3,1,2]' LIMIT 5;\n\n-- no index\nORDER BY 1 - (embedding <=> '[3,1,2]') DESC LIMIT 5;"
        },
        {
          "lang": "",
          "code": "BEGIN;\nSET LOCAL enable_seqscan = off;\nSELECT ...\nCOMMIT;"
        },
        {
          "lang": "",
          "code": "BEGIN;\nSET LOCAL min_parallel_table_scan_size = 1;\nSET LOCAL parallel_setup_cost = 1;\nSELECT ...\nCOMMIT;"
        },
        {
          "lang": "",
          "code": "ALTER TABLE items ALTER COLUMN embedding SET STORAGE PLAIN;"
        },
        {
          "lang": "",
          "code": "DROP INDEX index_name;"
        },
        {
          "lang": "",
          "code": "export PG_CONFIG=/Library/PostgreSQL/18/bin/pg_config"
        },
        {
          "lang": "",
          "code": "sudo --preserve-env=PG_CONFIG make install"
        },
        {
          "lang": "",
          "code": "sudo apt install postgresql-server-dev-18"
        },
        {
          "lang": "",
          "code": "pg_config --cppflags"
        },
        {
          "lang": "",
          "code": "make OPTFLAGS=\"\""
        },
        {
          "lang": "",
          "code": "docker pull pgvector/pgvector:pg18-trixie"
        },
        {
          "lang": "",
          "code": "git clone --branch v0.8.1 https://github.com/pgvector/pgvector.git\ncd pgvector\ndocker build --pull --build-arg PG_MAJOR=18 -t myuser/pgvector ."
        },
        {
          "lang": "",
          "code": "docker run --shm-size=1g ..."
        },
        {
          "lang": "",
          "code": "brew install pgvector"
        },
        {
          "lang": "",
          "code": "pgxn install vector"
        },
        {
          "lang": "",
          "code": "sudo apt install postgresql-18-pgvector"
        },
        {
          "lang": "",
          "code": "sudo yum install pgvector_18\n# or\nsudo dnf install pgvector_18"
        },
        {
          "lang": "",
          "code": "pkg install postgresql17-pgvector"
        },
        {
          "lang": "",
          "code": "cd /usr/ports/databases/pgvector\nmake install"
        },
        {
          "lang": "",
          "code": "apk add postgresql-pgvector"
        },
        {
          "lang": "",
          "code": "conda install -c conda-forge pgvector"
        },
        {
          "lang": "",
          "code": "ALTER EXTENSION vector UPDATE;"
        },
        {
          "lang": "",
          "code": "SELECT extversion FROM pg_extension WHERE extname = 'vector';"
        },
        {
          "lang": "",
          "code": "git clone https://github.com/pgvector/pgvector.git\ncd pgvector\nmake\nmake install"
        },
        {
          "lang": "",
          "code": "make installcheck        # regression tests\nmake prove_installcheck  # TAP tests"
        },
        {
          "lang": "",
          "code": "make installcheck REGRESS=functions                            # regression test\nmake prove_installcheck PROVE_TESTS=test/t/001_ivfflat_wal.pl  # TAP test"
        },
        {
          "lang": "",
          "code": "make clean && PG_CFLAGS=\"-DUSE_ASSERT_CHECKING\" make && make install"
        },
        {
          "lang": "",
          "code": "make clean && PG_CFLAGS=\"-DIVFFLAT_BENCH\" make && make install"
        },
        {
          "lang": "",
          "code": "make clean && PG_CFLAGS=\"-DHNSW_MEMORY -DIVFFLAT_MEMORY\" make && make install"
        },
        {
          "lang": "",
          "code": "make clean && PG_CFLAGS=\"-DIVFFLAT_KMEANS_DEBUG\" make && make install"
        }
      ],
      "headings": [
        {
          "level": 1,
          "text": "pgvector"
        },
        {
          "level": 2,
          "text": "Installation"
        },
        {
          "level": 3,
          "text": "Linux and Mac"
        },
        {
          "level": 3,
          "text": "Windows"
        },
        {
          "level": 2,
          "text": "Getting Started"
        },
        {
          "level": 2,
          "text": "Storing"
        },
        {
          "level": 2,
          "text": "Querying"
        },
        {
          "level": 4,
          "text": "Distances"
        },
        {
          "level": 4,
          "text": "Aggregates"
        },
        {
          "level": 2,
          "text": "Indexing"
        },
        {
          "level": 2,
          "text": "HNSW"
        },
        {
          "level": 3,
          "text": "Index Options"
        },
        {
          "level": 3,
          "text": "Query Options"
        },
        {
          "level": 3,
          "text": "Index Build Time"
        },
        {
          "level": 3,
          "text": "Indexing Progress"
        },
        {
          "level": 2,
          "text": "IVFFlat"
        },
        {
          "level": 3,
          "text": "Query Options"
        },
        {
          "level": 3,
          "text": "Index Build Time"
        },
        {
          "level": 3,
          "text": "Indexing Progress"
        },
        {
          "level": 2,
          "text": "Filtering"
        },
        {
          "level": 2,
          "text": "Iterative Index Scans"
        },
        {
          "level": 3,
          "text": "Iterative Scan Options"
        },
        {
          "level": 4,
          "text": "HNSW"
        },
        {
          "level": 4,
          "text": "IVFFlat"
        },
        {
          "level": 2,
          "text": "Half-Precision Vectors"
        },
        {
          "level": 2,
          "text": "Half-Precision Indexing"
        },
        {
          "level": 2,
          "text": "Binary Vectors"
        },
        {
          "level": 2,
          "text": "Binary Quantization"
        },
        {
          "level": 2,
          "text": "Sparse Vectors"
        },
        {
          "level": 2,
          "text": "Hybrid Search"
        },
        {
          "level": 2,
          "text": "Indexing Subvectors"
        },
        {
          "level": 2,
          "text": "Performance"
        },
        {
          "level": 3,
          "text": "Tuning"
        },
        {
          "level": 3,
          "text": "Loading"
        },
        {
          "level": 3,
          "text": "Indexing"
        },
        {
          "level": 3,
          "text": "Querying"
        },
        {
          "level": 4,
          "text": "Exact Search"
        },
        {
          "level": 4,
          "text": "Approximate Search"
        },
        {
          "level": 3,
          "text": "Vacuuming"
        },
        {
          "level": 2,
          "text": "Monitoring"
        },
        {
          "level": 2,
          "text": "Scaling"
        },
        {
          "level": 2,
          "text": "Languages"
        },
        {
          "level": 2,
          "text": "Frequently Asked Questions"
        },
        {
          "level": 4,
          "text": "How many vectors can be stored in a single table?"
        },
        {
          "level": 4,
          "text": "Is replication supported?"
        },
        {
          "level": 4,
          "text": "What if I want to index vectors with more than 2,000 dimensions?"
        },
        {
          "level": 4,
          "text": "Can I store vectors with different dimensions in the same column?"
        },
        {
          "level": 4,
          "text": "Can I store vectors with more precision?"
        },
        {
          "level": 4,
          "text": "Do indexes need to fit into memory?"
        },
        {
          "level": 2,
          "text": "Troubleshooting"
        },
        {
          "level": 4,
          "text": "Why isn’t a query using an index?"
        },
        {
          "level": 4,
          "text": "Why isn’t a query using a parallel table scan?"
        },
        {
          "level": 4,
          "text": "Why are there less results for a query after adding an HNSW index?"
        },
        {
          "level": 4,
          "text": "Why are there less results for a query after adding an IVFFlat index?"
        },
        {
          "level": 2,
          "text": "Reference"
        },
        {
          "level": 3,
          "text": "Vector Type"
        },
        {
          "level": 3,
          "text": "Vector Operators"
        },
        {
          "level": 3,
          "text": "Vector Functions"
        },
        {
          "level": 3,
          "text": "Vector Aggregate Functions"
        },
        {
          "level": 3,
          "text": "Halfvec Type"
        },
        {
          "level": 3,
          "text": "Halfvec Operators"
        },
        {
          "level": 3,
          "text": "Halfvec Functions"
        },
        {
          "level": 3,
          "text": "Halfvec Aggregate Functions"
        },
        {
          "level": 3,
          "text": "Bit Type"
        },
        {
          "level": 3,
          "text": "Bit Operators"
        },
        {
          "level": 3,
          "text": "Bit Functions"
        },
        {
          "level": 3,
          "text": "Sparsevec Type"
        },
        {
          "level": 3,
          "text": "Sparsevec Operators"
        },
        {
          "level": 3,
          "text": "Sparsevec Functions"
        },
        {
          "level": 2,
          "text": "Installation Notes - Linux and Mac"
        },
        {
          "level": 3,
          "text": "Postgres Location"
        },
        {
          "level": 3,
          "text": "Missing Header"
        },
        {
          "level": 3,
          "text": "Missing SDK"
        },
        {
          "level": 3,
          "text": "Portability"
        },
        {
          "level": 2,
          "text": "Installation Notes - Windows"
        },
        {
          "level": 3,
          "text": "Missing Header"
        },
        {
          "level": 3,
          "text": "Mismatched Architecture"
        },
        {
          "level": 3,
          "text": "Missing Symbol"
        },
        {
          "level": 3,
          "text": "Permissions"
        },
        {
          "level": 2,
          "text": "Additional Installation Methods"
        },
        {
          "level": 3,
          "text": "Docker"
        },
        {
          "level": 3,
          "text": "Homebrew"
        },
        {
          "level": 3,
          "text": "PGXN"
        },
        {
          "level": 3,
          "text": "APT"
        },
        {
          "level": 3,
          "text": "Yum"
        },
        {
          "level": 3,
          "text": "pkg"
        },
        {
          "level": 3,
          "text": "APK"
        },
        {
          "level": 3,
          "text": "conda-forge"
        },
        {
          "level": 3,
          "text": "Postgres.app"
        },
        {
          "level": 2,
          "text": "Hosted Postgres"
        },
        {
          "level": 2,
          "text": "Upgrading"
        },
        {
          "level": 2,
          "text": "Thanks"
        },
        {
          "level": 2,
          "text": "History"
        },
        {
          "level": 2,
          "text": "Contributing"
        }
      ]
    }
  ]
}